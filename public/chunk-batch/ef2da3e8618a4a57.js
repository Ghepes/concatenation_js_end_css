(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[686979],{

/***/ 514743:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(157643);__web_req__(7487);self._ebd5e19490e9b70e7436d6c497657170 = self._ebd5e19490e9b70e7436d6c497657170 || {};(function(__c) {var z=__c.z;var H=__c.H;var qa=__c.qa;var m=__c.m;
var sQn=function(a){if(a!=null&&typeof a==="object"){var b=a.stamp;if(typeof b==="string"&&b==="external_payment_guest_message")return rQn.deserialize(a).m}},tQn=function(a){let b;return(new Promise((c,d)=>{a.NGg=d;b=a.Zzj(e=>{e=sQn(e.data);e!=null&&(a.NGg=void 0,e.type==="INITIALIZED"?c():d(Error(`Unexpected external payment guest message of type: ${e.type}.`+"An INITIALIZED message is expected.")))})})).finally(()=>b())},uQn=function(a){a=a.oHj;const b={};if(a===null||a===void 0?0:a.sxa)b.toolbar=
"yes",b.menubar="yes";if(a===null||a===void 0?0:a.dimensions)b.width=a.dimensions.width.toString(),b.height=a.dimensions.height.toString();if(a===null||a===void 0?0:a.position)b.left=a.position.left.toString(),b.top=a.position.top.toString();return Object.keys(b).map(c=>`${c}=${b[c]}`).join(",")},vQn=async function(a,b,c){for(;;){var d;await __c.eb(500);if(a.sDa.get(b)!=null)break;else c.isClosed()&&((d=a.NGg)===null||d===void 0||d.call(a,Error("Payment window has been closed before initialization")))}},
wQn=function(a,b,c){const d=m(a.sDa.get(b),`Could not find browsing context with id '${b}'`);qa(d.status===1,"Unexpected window status");d.window.close();switch(c.type){case "INITIALIZED":case "PROCESS_PAYMENT":throw c=Error(`Unexpected external payment guest message of type: ${c.type}.`+"A SUCCESS or ERROR message is expected."),a.sDa.set(b,{status:4,error:c.message,window:void 0,Pta:!0}),c;case "SUCCESS":a.sDa.set(b,{status:2,window:void 0});break;case "ERROR":a.sDa.set(b,{status:4,error:c.error,
window:void 0,Pta:c.Pta});break;case "CANCEL":a.sDa.set(b,{status:5,error:"Error",window:void 0});break;case "SUCCESS_V2":a.sDa.set(b,{status:3,window:void 0,Ute:c.Ute});break;default:throw new __c.t(c);}};var xQn=H(()=>({type:z("A?",2,"PROCESS_PAYMENT"),url:__c.L(1)}));var yQn=H(()=>({type:z("A?",1,"INITIALIZED")}));var zQn=H(()=>({type:z("A?",3,"SUCCESS")}));var AQn=H(()=>({type:z("A?",4,"ERROR"),error:__c.M(1),Pta:__c.ic(2)}));var BQn=H(()=>({type:z("A?",5,"CANCEL")}));var CQn=H(()=>({type:z("A?",6,"SUCCESS_V2"),Ute:__c.L(1)}));var DQn=__c.Ta(()=>({type:[1,yQn,2,xQn,3,zQn,4,AQn,5,BQn,6,CQn]}),()=>({}));var rQn=H(()=>({Eql:__c.L("stamp",1,"external_payment_guest_message"),m:__c.C("m",2,DQn)}));var EQn=class{static serialize(a){a=new rQn({m:a});qa(a.Eql==="external_payment_guest_message","External payment guest messenger stamp is out of sync.(Expected stamp value: external_payment_guest_message, "+`Received stamp value: ${a.Eql})`);a=rQn.serialize(a);qa(a.hasOwnProperty("stamp"),"External payment guest messenger stamp is out of sync.(Expected stamp property: stamp)");return a}};var FQn,GQn;FQn=(a,b)=>c=>{if(c.key===a&&c.newValue){try{const e=JSON.parse(c.newValue);var d=sQn(e)}catch(e){return}d!=null&&b(new MessageEvent("message",{data:d}))}};GQn=class{get(a){return this.sDa.get(a)}set(a,b){const c=this.sDa.get(a);(c===null||c===void 0?void 0:c.status)===1&&c.KBi.forEach(d=>d());this.sDa.set(a,b)}keys(){return this.sDa.keys()}values(){return this.sDa.values()}constructor(){this.sDa=new Map}};
__c.HQn=class{static create({Pae:a,uCc:b}){let c,d;const e=__c.He();if(window.BroadcastChannel){const f=new BroadcastChannel("psv2-epc");c=g=>{f.addEventListener("message",g);return()=>f.removeEventListener("message",g)}}else e&&(d=f=>{const g=FQn("psv2-epc",f);window.addEventListener("storage",g);return()=>window.removeEventListener("storage",g)});return new __c.HQn(b,(f,g)=>{const h=window.open(f,void 0,g);return h!=null?{postMessage:k=>h.postMessage(k,a),close:()=>h.close(),isClosed:()=>h.closed}:
null},f=>{window.addEventListener("message",f);return()=>window.removeEventListener("message",f)},f=>{const g=[];c&&g.push(c(f));d&&g.push(d(f));return()=>g.forEach(h=>h())},new __c.Lj("context:"))}async $af(a){const b=this.M5m.next();if(Array.from(this.sDa.values()).find(g=>g.status===1)!=null){var c=[...this.sDa.keys()].join(", ");throw Error("Only one browsing context may be open at one time."+` Attempted to open a new context while contexts '${c}' were already open.`);}c=tQn(this);const d=uQn(a);
let e=this.openWindow(this.uCc,d);e==null&&d&&(e=this.openWindow(this.uCc));const f=new __c.pQn({k$:b});if(e==null){a=Error("Payment window has been blocked");if(this.NGg)return this.NGg(a),c.then(()=>f);throw a;}vQn(this,b,e);await c;this.sDa.set(b,{status:1,window:e,KBi:new Set,g0f:a.g0f});return f}async zsf(a){const b=m(this.sDa.get(a.k$),`Could not find browsing context with id '${a.k$}'`);qa(b.status===1,`Unexpected browsing context status: ${b.status}. External payment must be `+"processed in a browsing context with status: 1.");
var c=this.Zzj(d=>{d=sQn(d.data);d!=null&&wQn(this,a.k$,d)});b.KBi.add(c);(c=this.Vzj?this.Vzj(d=>{d=sQn(d.data);d!=null&&wQn(this,a.k$,d)}):void 0)&&b.KBi.add(c);c=EQn.serialize(new xQn({url:a.p8j}));b.window.postMessage(c);return new __c.qQn}async Feg(a){const b=m(this.sDa.get(a.k$),`Could not find browsing context with id '${a.k$}'`);switch(b.status){case 1:return b.window.isClosed()?(await this.xbc(new __c.fQn({k$:a.k$})),new __c.hQn):new __c.jQn;case 2:return new __c.kQn;case 4:return new __c.iQn({error:b.error,
Pta:b.Pta});case 5:return new __c.hQn;case 3:throw Error("Unexpected external payment window status SUCCESS_V2 when calling getExternalPaymentStatus. Expected getExternalPaymentStatusV2 to be called instead.");default:throw new __c.t(b);}}async xbc(a){const b=m(this.sDa.get(a.k$),`Could not find browsing context with id '${a.k$}'`);qa(b.status===1,`Unexpected browsing context status: ${b.status}. External payment can only be `+"cancelled when the browsing context is in status: 1.");b.window.close();
this.sDa.set(a.k$,{status:5,error:void 0,window:void 0});return new __c.gQn}async Ywd(a){const b=m(this.sDa.get(a.k$),`Could not find browsing context with id '${a.k$}'`);switch(b.status){case 1:const c=b.window.isClosed();return c&&!b.g0f?(await this.xbc(new __c.fQn({k$:a.k$})),new __c.lQn):new __c.nQn({Exk:c});case 2:throw Error("Unexpected external payment window status SUCCESS when calling getExternalPaymentStatusV2. Expected getExternalPaymentStatus to be called instead.");case 3:return new __c.oQn({Ute:b.Ute});
case 4:return new __c.mQn({error:b.error,Pta:b.Pta});case 5:return new __c.lQn;default:throw new __c.t(b);}}constructor(a,b,c,d,e){this.uCc=a;this.openWindow=b;this.Zzj=c;this.Vzj=d;this.M5m=e;this.sDa=new GQn}};__c.Tia={};__c.Tia.i1g=__c.HQn;__c.Tia.hhq="psv2-epc";__c.Tia.WFr=FQn;
}).call(self, self._ebd5e19490e9b70e7436d6c497657170);}

}])
//# sourceMappingURL=sourcemaps/ef2da3e8618a4a57.js.map