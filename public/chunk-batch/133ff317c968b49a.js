(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[98973],{

/***/ 905716:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;self._5f74ec40302898c5a55451c9fbd04240 = self._5f74ec40302898c5a55451c9fbd04240 || {};(function(__c) {/*

 Copyright The Closure Library Authors.
 Copyright The Closure Compiler Authors.
 SPDX-License-Identifier: Apache-2.0
*/
var ba,ca,fa,k,ha,ia,la,ka,ma,ra,oa,xa,wa,ua,ta,Da,Fa,Ga,Ha,Ia,Ka,La,Ma,Oa,v,Pa,y,z,A,B,Qa,Ra,C,D,E,Sa,bb,$a,Wa,Xa,Ya,Za,ab,cb,u,Va,Ta,Ua,eb,db,J,fb,K,gb,hb,jb,lb,nb,pb,rb,tb,ub,wb,yb,Ab,Cb,Eb,Db,Gb,Fb,Jb,Kb,Lb,Mb,Pb,Rb,Sb,M,Vb,Xb,Zb,ac,cc,bc,gc,hc,ic,jc,kc,lc,nc,oc,pc,mc,rc,sc,tc,wc,vc,uc,Ac,Cc,Ec,Fc,Gc,Ic,Dc,Jc,Pc,Rc,Tc,Vc,bd,dd,Uc,ed,Yc,Zc,Qc,Nc,Sc,id,$c,ad,kd,cd,ld,md,nd,Oc,Lc,Kc,Mc,Q,sd,td,ud,vd,wd,xd,Ad,Bd,Cd,Dd,Ed,Gd,Hd,Id,Jd,Kd,Md,Nd,ce,ee,ge,he,ie,je,ke,le,oe,ne,pe,qe,te,ue,ve,we,xe,ye,ze,
Ae,Be,De,He,Ie,Ke,Me,Re,Ze,$e,af,bf,Ue,df,ef,ff,gf,hf,jf,lf,pf,sf,tf,rf,yf,Df,Ff,xf,Hf,Kf,Lf,Mf,Of,Pf,Nf,Rf,Sf,Tf,Gf,nf,mf,uf,qf,Wf,Yf,Zf,$f,ag,dg,eg,hg,jg,lg,mg,ng,pg,qg,ug,tg,xg,Bg,Fg,Lg,Pg,Dg,Tg,Ug,Wg,Yg,$g,bh,eh,gh,jh,mh,oh,rh,th,vh,yh,Ng,Xg,Ah,Bh,Ch,Dh,Eh,Fh,Gh,Hh,Jh,Kh,Lh,Mh,Nh,Oh,Ih,Qh,Rh,Th,Uh,Sh,Vh,Wh,R,Zh,ai,bi,di,fi,hi,ii,ji,ki,li,mi,ni,pi,ri,oi,si,ti,ui,wi,xi,zi,Ai,Ci,Gi,Ii,Ki,Li,Mi,Ni,Pi,Qi,Ri,Si,Oi,$i,aj,bj,cj,dj,ej,mj,nj,pj,rj,sj,qj,uj,vj,wj,xj,zj,Bj,Dj,Ij,Jj,Lj,Kj,Mj,Nj,Qj,Rj,Tj,Uj,
Vj,Wj,Xj,Zj,bk,ck,jk,pk,qk,rk,tk,uk,vk,wk,yk,zk,Ak,Bk,Ek,Fk,Qk,Wk,Ck,Xk,$k,cl,al,bl,kl,jl,hl,nl,pl,ql,rl,wl,xl,zl,Al,Bl,Cl,Dl,El,Fl,Il,Jl,Kl,Ll,Ml,Pl,Ql,Rl,Tl,Xl,bm,$l,dm,fm,gm,hm,im,jm,km,lm,mm,nm,om,pm,sm,rm,vm,xm,ym,Am,Bm,Cm,Dm,Em,Fm,Gm,Im,Km,Lm,Mm,Nm,Pm,Qm,Rm,Tm,Um,Vm,Wm,Xm,Ym,fn,gn,hn,$m,un,zn,yn,xn,Fn,wn,vn,Gn,Mn,Nn,In,Qn,Rn,Sn,Xn,Yn,Zn,co,eo,ao,$n,bo,go,ho,io,no,oo,yo,Bo,Ao,Co,Do,Eo,Go,Jo,Lo,Oo,No,Po,Qo,Ro,So,To,Uo,Wo,Yo,Xo,$o,bp,ap,cp,ep,fp,hp,rp,gp,sp,up,vp,Jp,Kp,Lp,Op,Qp,Rp,Sp,Tp,Wp,Xp,
Yp,Zp,$p,aq,dq,cq,eq,fq,hq,gq,iq,jq,qq,sq,xq,vq,zq,Aq,Bq,Cq,Fq,Hq,Kq,Lq,Dq,Mq,Jq,Nq,wq,Gq,lq,uq,Tq,dr,Wq,Xq,Yq,er,gr,ea,da;ba=function(a){return function(){return __c.aa[a].apply(this,arguments)}};ca=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var c=a[b];if(c&&c.Math==Math)return c}throw Error("Cannot find global object");};
fa=function(a,b){if(b)a:{var c=da;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in c))break a;c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&b!=null&&ea(c,a,{configurable:!0,writable:!0,value:b})}};k=function(a,b,...c){if(!a)throw Error(b==null?"invalid argument":ha(b,...c));};ha=function(a,...b){let c=0;return a.replace(/\{}/g,()=>c<b.length?b[c++]:"{}")};ia=function(a,b,...c){if(!a)throw Error(b==null?"invalid state":ha(b,...c));};
la=function(a,b){if(a!==b)throw Error(ha("{} != {}",ka(a),ka(b)));};ka=function(a){if(a==null||typeof a==="symbol")return String(a);try{return JSON.stringify(a)}catch(b){return String(a)}};ma=function(a,b,...c){if(a==null)throw Error(b==null?"argument is null":ha(b,...c));return a};ra=function(a,b,c){const d=c&&c.Lj;c=c&&c.Qm;if(!(a in na)){const e=self.bootstrap;if(!e)throw Error("Could not find bootstrap");na[a]={...e[a]};c||delete e[a]}return oa(a,b,d&&a in pa?pa[a]:void 0)};
oa=function(a,b,c){if(a in sa&&c==null&&sa[a]!=null)return sa[a];c!=null&&c.size>0&&c.forEach((d,e)=>{a:{var f=na[a];e=e.split(".");let g=e.shift();for(;e.length;){if(ta(g,f)){d=void 0;break a}g in f||(f[g]=String(Number(e[0]))===e[0]?[]:{});f=f[g];g=e.shift()}ta(g,f)||(f[g]=ua(d,f[g]));d=void 0}return d});b=b(va.required(a,na));sa[a]=c==null?b:void 0;return b};
xa=function(){var a=window.location.search;const b={};["base","page","ui"].forEach(c=>{const d=wa(a,`bootstrap.${c}.`);d.size>0&&(b[c]=d)});return b};wa=function(a,b){const c=new Map;(new URLSearchParams(a)).forEach((d,e)=>{e.startsWith(b)&&c.set(decodeURIComponent(e.replace(b,"").replace(/\+/g," ")),decodeURIComponent(d.replace(/\+/g," ")))});return c};
ua=function(a,b){b=typeof b;switch(b){case "undefined":if(a==="")return!0;b=ya.exec(a);return b!=null?b[1]:Aa.has(a)?Aa.get(a):a.trim()!==""&&Number.isFinite(Number(a))?Number(a):Ba.has(a)?Ba.get(a):a;case "boolean":return k(Aa.has(a),"boolean value expected: {}",a),Aa.get(a);case "number":return k(a.trim()!==""&&Number.isFinite(Number(a)),"finite numeral expected: {}",a),Number(a);case "object":return k(Ba.has(a),"object value expected: {}",a),Ba.get(a);case "string":return b=ya.exec(a),b!=null?
b[1]:a;case "function":case "bigint":case "symbol":throw Error(`unexpected hint type: ${b}`);default:throw new m(b);}};ta=function(a,b){return Object.getPrototypeOf(b)===b[a]||!b.hasOwnProperty(a)&&a in Object.getPrototypeOf(b)?!0:!1};Da=function(a){return new Ca(a)};Fa=function(a){return new Ea(a)};Ga=function(a){return a!=null&&a.then!=null};
Ha=function(a){({vl:b}={vl:!1});var b;let c=!1,d;return(...e)=>{k(e.length===0);if(d==null||b&&(!d.ok||c))try{c=!1,d=p(a()),Ga(d.value)&&d.value.then(null,()=>c=!0)}catch(f){d=q(f)}if(d.ok)return d.value;throw d.error;}};Ia=function(a){const b=new WeakMap;return(c,...d)=>{k(d.length===0);b.has(c)||b.set(c,a(c));return b.get(c)}};Ka=function(a){const b=a.di;return{tag:a.tag,da:1,M:b==="A?"?void 0:b,yd:a.yd,value:a.value,ve:a.ve,K:"string"}};
La=function(a,b,c,d){return{tag:c,da:2,M:b,default:d!=null?d:a.defaultValue,defaultValue:a.defaultValue,K:a.K}};Ma=function(a,b,c){return{tag:c,da:3,M:b,defaultValue:a.defaultValue,K:a.K}};Oa=function(a){return(b,c,d)=>{const {tag:e,M:f,ra:g}=u(b,c,d);return{da:5,tag:e,M:f,obj:g,Vg:Na.K,K:a==="object"?"object":a==="enum"?"string":a.K}}};v=function(a,b){const {tag:c,M:d,ra:e}=u(a,b);return Ka({tag:c,di:"A?",yd:d,value:e,ve:!1})};
Pa=function(a,b){const {tag:c,M:d,ra:e}=u(a,b);return Ka({tag:c,di:"A?",yd:d,value:e,ve:!0})};y=function(a,b){const {tag:c,M:d,ra:e}=u(a,b);return{tag:c,da:2,M:d,obj:e,K:"object"}};z=function(a,b){const {tag:c,M:d,ra:e}=u(a,b);return{tag:c,da:3,M:d,obj:e,K:"object"}};A=function(a,b){const {tag:c,M:d,ra:e}=u(a,b);return{tag:c,da:4,M:d,obj:e,K:"object"}};B=function(a,b){const {tag:c,M:d,ra:e,ui:f}=u(a,b);return{tag:c,da:2,M:d,obj:e,default:f,K:"string"}};
Qa=function(a,b){const {tag:c,M:d,ra:e}=u(a,b);return{tag:c,da:3,M:d,obj:e,K:"string"}};Ra=function(a){const {tag:b,M:c,ra:d}=u(2,a);return{tag:b,da:4,M:c,obj:d,K:"string"}};
C=function(a){var b={};const c=Ha(()=>{const e=a();var f=Object.keys(e);const g={},h={};for(const l of f)switch(f=e[l],f.da){case 1:h[f.tag]={...f,name:l};break;case 2:case 3:case 4:case 5:g[f.tag]={...f,name:l};break;default:throw new m(f);}return{kind:1,fields:e,Ce:Sa(e,b.ze),Nk:g,Uj:h}});class d{static ue(e={}){return new d(e)}static C(e){return d.Sd(e,[])}static $e(e,f,g){f=f.config;return f.K==="Uint8Array"?Ta(e):f.obj?f.obj.Sd(e,g):e}static F(e){return d.Pc(e,[])}static xe(e,f,g){f=f.config;
return f.K==="Uint8Array"?Ua(e):f.obj?f.obj.Pc(e,g):e}static Pc(e,f){var {Ce:g}=c(),h=Object.create(d.prototype);for(const F of g){g=F.config;const H=F.name;var l=F.ia,n=F.Ia,r=l,t=e[r];t==null&&n!=null&&e[n]!=null&&(r=n,t=e[r]);switch(g.da){case 3:if(t==null){h[H]=void 0;break}else if(!Va(t,g.K))throw Wa({ia:l,Ia:n},t,g.K,f);f.push(r);h[H]=d.xe(t,F,f);f.pop();break;case 2:if(t==null&&g.defaultValue!=null){h[H]=g.defaultValue;break}else if(t==null||!Va(t,g.K))throw Xa({ia:l,Ia:n},t,g.K,f);f.push(r);
h[H]=d.xe(t,F,f);f.pop();break;case 1:var w=F.Te;r=F.Kg;if(t==null&&g.ve){h[H]=g.value;break}if(t===w){h[H]=g.value;break}if(r!=null&&t===r){h[H]=g.value;break}e=w;h=r;throw new TypeError(`Expected value ${h?`either "${e}" OR "${h}"`:`"${e}"`} for key ${Ya({ia:l,Ia:n})} found: ${JSON.stringify(t)} ${Za(f)}`);case 4:if(t==null){h[H]=[];break}else if(!Array.isArray(t))throw $a({ia:l,Ia:n},t,g.K,f);w=Array(t.length);for(var x=0;x<t.length;++x){if(!Va(t[x],g.K))throw Xa({ia:l,Ia:n},t[x],g.K,[...f,r],
x);f.push(`${r}[${x}]`);w[x]=d.xe(t[x],F,f);f.pop()}h[H]=w;break;case 5:if(t==null){h[H]=new Map;break}else if(typeof t!=="object")throw new TypeError(`Expected Map for key ${Ya({ia:l,Ia:n})}, found: ${ab(t)} ${Za(f)}`);l=g.Vg==="number";t=Object.entries(t);n=Array(t.length);for(w=0;w<t.length;++w){const [I,O]=t[w];if(l){if(x=Number(I),isNaN(x))throw new TypeError(`Expected number map key, found: NaN ${Za([...f,r])}`);}else x=I;if(!Va(O,g.K))throw new TypeError(`Expected ${g.K} map value for map key "${x}", found: ${ab(O)} ${Za([...f,
r])}`);f.push(`${r}["${x}"]`);const N=d.xe(O,F,f);f.pop();n[w]=[x,N]}h[H]=new Map(n);break;default:throw new m(g);}}return h}constructor(e={}){var {Ce:f}=c();for(const g of f){f=g.config;const h=g.name,l=e[h];switch(f.da){case 1:this[h]=f.value;break;case 2:this[h]=l==null?f.default:l;break;case 3:this[h]=l;break;case 4:this[h]=l==null?[]:l;break;case 5:this[h]=l==null?new Map:l;break;default:throw new m(f);}}}}d.init=c;d.Sd=b.Tb?(e,f)=>{throw new TypeError(`Unproducible oneof case ${Za(f)}`);}:(e,
f)=>{if(e==null||typeof e!=="object")throw new TypeError(`Expected type object, found: ${ab(e)} ${Za(f)}`);var {Ce:g}=c();const h={};for(const t of g){g=t.config;var l=t.ia,n=e[t.name];const w=l;switch(g.da){case 1:if(n!==g.value)throw new TypeError(`Expected value ${JSON.stringify(g.value)} for key "${l}", found: ${JSON.stringify(n)} ${Za(f)}`);h[w]=t.Te;break;case 2:if(g.defaultValue!=null&&n===g.defaultValue)break;f.push(w);var r=d.$e(n,t,f);f.pop();if(!Va(r,g.K))throw Xa({ia:l},n,g.K,f);h[w]=
r;break;case 3:if(n==null)break;f.push(w);r=d.$e(n,t,f);f.pop();if(!Va(r,g.K))throw Wa({ia:l},n,g.K,f);h[w]=r;break;case 4:if(n==null)break;else{if(!Array.isArray(n))throw $a({ia:l},n,g.K,f);if(n.length===0)break}r=Array(n.length);for(let x=0;x<n.length;++x){f.push(`${w}[${x}]`);const F=d.$e(n[x],t,f);f.pop();if(!Va(F,g.K))throw Xa({ia:l},F,g.K,[...f,w],x);r[x]=F}h[w]=r;break;case 5:if(!(n instanceof Map))throw new TypeError(`Expected Map for key "${l}", found: ${ab(n)} ${Za(f)}`);if(n.size===0)break;
l={};for(const [x,F]of n){if(typeof x!==g.Vg)throw new TypeError(`Expected ${g.Vg} map key, found: ${ab(x)} ${Za([...f,w])}`);f.push(`${w}["${x}"]`);n=d.$e(F,t,f);f.pop();if(!Va(n,g.K))throw new TypeError(`Expected ${g.K} map value for map key "${x}", found: ${ab(n)} ${Za([...f,w])}`);l[x]=n}h[w]=l;break;default:throw new m(g);}}return h};return d};
D=function(a,b,c={}){const d=Ha(()=>{var g=a();const h=Object.keys(g)[0];let l;const n=new Map,r=new Map,t=new Map;for(var w=0;w<g[h].length;w+=2){var x=g[h][w];const I=g[h][w+1],O=I.init().fields[h];if(!O)throw new TypeError("Missing discriminator.");if(O.da!==1)throw new TypeError(`Discriminator must be FieldLabel.CONSTANT, was ${O.da}.}`);var F=bb("A?",O.M,c.ze);const {ab:N,Qb:ja}=bb(cb(x-1),O.yd,c.ze);t.set(x,{Ln:I,value:O.value});n.set(O.value,I);r.set(N,I);ja&&r.set(ja,I);if(l&&l.ia!==F.ab)throw new TypeError(`oneOf JSON keys are not consistent. ${l.ia} ${F.ab}`);
if(l&&l.Ia!==F.Qb)throw new TypeError(`oneOf secondary JSON keys are not consistent. ${l.Ia} ${F.Qb}`);x=O.tag;l={ia:F.ab,Ia:F.Qb}}if(l==null||x==null)throw new TypeError("OneOf has no cases.");g=b();F=Object.keys(g);w={};for(var H of F)w[g[H].tag]={...g[H],name:H};H=c.Kf!=null?c.Kf():void 0;return{kind:2,Ce:Sa(g,c.ze),kk:h,Ql:n,wo:x,jk:l,hn:r,Zj:H,fields:g,Nk:w,Uj:{},rq:t}}),e=(g,h)=>{const {kk:l,Ql:n}=d(),r=g[l],t=n.get(r);if(!t)throw new TypeError(`Unknown oneof deserialized case: ${JSON.stringify(r)} ${Za(h)}`);
return t.Sd(g,h)},f=(g,h)=>{const {hn:l,jk:n,Zj:r}=d();var t=n.Ia;let w=g[n.ia];w==null&&t&&(w=g[t]);if(w==null&&r)return r.Pc(g,h);t=l.get(w);if(!t)throw new TypeError(`Unknown oneof serialized case: ${JSON.stringify(w)} ${Za(h)}`);return t.Pc(g,h)};return{init:d,C:g=>e(g,[]),Sd:e,F:g=>f(g,[]),Pc:f}};
E=function(a,b=0){var c={};const d=Ha(()=>{const g=a(),h=[],l=new Map,n=new Map,r=new Map,t=new Map,w=new Set;let x=0,F=1;for(;x<g.length;){const I=F++,O=g[x];var H=cb(O-b);x+=1;let N;const ja=g[x];typeof ja==="string"&&(N=ja,x+=1);const {ab:qa,Qb:za}=bb(H,N,c.ze);H=g[x];typeof H==="object"&&H.Tb&&(w.add(I),x+=1);h.push(I);l.set(qa,I);za&&l.set(za,I);n.set(I,qa);r.set(I,O);t.set(O,I)}return{values:h,rj:n,Lq:r,$p:t,jn:l,Tb:w.size?w:void 0}}),e=(g,h,l)=>{const {Tb:n}=d();if(n&&n.has(g))throw new TypeError(`Unproducible enum value: ${JSON.stringify(g)} ${l?
Za(l):""}`);h=h.get(g);if(h==null)throw new TypeError(`The proto enum serializer failed to serialize value ${JSON.stringify(g)} into JSON.
It does not recognize value ${JSON.stringify(g)} as a valid member of the TypeScript enum.
${l?Za(l):""}`);return h},f=(g,h)=>{const l=d().jn.get(g);if(l==null)throw new TypeError(`The proto enum deserializer failed to deserialize JSON ${JSON.stringify(g)} into an enum value.
It does not recognize JSON ${JSON.stringify(g)} as a valid JSON value encoding of the enum.
${Za(h)}`);return l};return{values:()=>d().values,Xp:()=>{const {values:g,Tb:h}=d();return h==null?g:g.filter(l=>!h.has(l))},C:g=>e(g,d().rj,[]),Sd:(g,h)=>e(g,d().rj,h),F:g=>f(g,[]),Pc:f}};Sa=function(a,b){return Object.entries(a).map(([c,d])=>{let e=cb(d.tag-1);if(d.da===1){const {ab:l,Qb:n}=bb(e,d.yd,b);e="A?";var f={Te:l,Kg:n}}const {ab:g,Qb:h}=bb(e,d.M,b);return{config:d,name:c,ia:g,Ia:h,Te:f===null||f===void 0?void 0:f.Te,Kg:f===null||f===void 0?void 0:f.Kg}})};
bb=function(a,b,c){if(!b){if(c!==void 0)throw Error("Dual Deserialization config templated but JSON full key/value wasn't");return{ab:a}}if(c===void 0)return{ab:b};if(c===0)return{ab:a,Qb:b};if(c===1)return{ab:b,Qb:a};throw Error("function should have been exhaustive, but wasn't");};$a=function(a,b,c,d){return new TypeError(`Expected repeated ${c} value for key ${Ya(a)}, found: ${ab(b)} ${Za(d)}`)};Wa=function(a,b,c,d){return new TypeError(`Expected optional ${c} value for key ${Ya(a)}, found: ${ab(b)} ${Za(d)}`)};
Xa=function(a,b,c,d,e){return new TypeError(`Expected ${c} value${e!==void 0?` at index ${e}`:""} for key ${Ya(a)}, found: ${ab(b)} ${Za(d)}`)};Ya=function(a){const b=a.ia;return(a=a.Ia)?`either "${b}" OR "${a}"`:`"${b}"`};Za=function(a){return`(path: .${a.join(".")})`};ab=function(a){return a===null?"null":Array.isArray(a)?"array":typeof a};
cb=function(a){if(a<64)return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(a);const b=[];for(;a>0;)b.push("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".charAt(a%64)),a=Math.floor(a/64);return b.reverse().join("")};u=function(a,b,c){return typeof a==="string"?{M:a,tag:b,ra:c,ui:void 0}:{tag:a,ra:b,ui:c}};Va=function(a,b){return typeof a===b||b==="Uint8Array"&&typeof a==="string"};Ta=function(a){a=Array.from(a,b=>String.fromCodePoint(b)).join("");return btoa(a)};
Ua=function(a){return Uint8Array.from(atob(a),b=>b.codePointAt(0))};eb=function(a,b,c){var d=[];if(!a)throw new G({code:b,message:db(c,...d)});};db=function(a,...b){let c=0;return a.replace(/\{}/g,()=>c<b.length?b[c++]:"{}")};J=function(a,b,c){var d=[];if(!a)throw new G({code:b,message:db(c,...d)});};fb=function(a,b){var c=[];if(a!==b)throw new G({code:"internal_error",message:db("Mismatched text state",...c)});};K=function(a,b,c,...d){if(a==null)throw new G({code:b,message:db(c,...d)});return a};
gb=function(a,b,c,d,e){a.handle(b,async f=>{if(f===void 0)throw new G({code:"internal_error",message:`${b}: request cannot be undefined.`});f=c.F(f);f=await d(f);if(e)return e.C(f)})};hb=async function(a,b,c,d,e){a=await a.request(b,c.C(d));if(!a.ok){if(a.error instanceof G)throw a.error;throw new G({code:"internal_error",message:`Something went wrong during request ${b}`});}if(e){if(a.value===void 0)throw new G({code:"internal_error",message:`Expected a response from ${b}, but got nothing`});return e.F(a.value)}};
jb=async function(a,b){b=ib.C(b);await a.l.request("NATIVE_FETCH_ANALYTICS_V1_TRACK_NATIVE_FETCH_CALL_START",b)};lb=async function(a,b){b=kb.C(b);await a.l.request("NATIVE_FETCH_ANALYTICS_V1_TRACK_NATIVE_FETCH_CALL",b)};nb=async function(a,b){b=mb.C(b);await a.l.request("NATIVE_FETCH_ANALYTICS_V1_TRACK_NATIVE_FETCH_CALL_ATTEMPT",b)};pb=async function(a){const b=ob.C({type:1});await a.l.request("NATIVE_EVENTS_ANALYTICS_V1_TRACK_NATIVE_POINTER_EVENT",b)};
rb=async function(a){const b=qb.C({type:1});await a.l.request("NATIVE_EVENTS_ANALYTICS_V1_TRACK_NATIVE_KEYBOARD_EVENT",b)};tb=async function(a,b){b=sb.C(b);await a.l.request("TRACK_DEVELOPER_SERVER_PROCESSING_REQUEST_V1",b)};ub=async function(a){a=await a.l.request("UI_CONTEXT_V1_SUBSCRIBE_TO_UI_CONTEXT_CHANGE");if(!a.ok)throw a.error;};wb=async function(a,b){b=vb.C(b);a=await a.l.request("REGISTER_UNSTABLE_API_USAGE_V1",b);if(!a.ok)throw a.error;};
yb=async function(a,b){b=xb.C(b);a=await a.l.request("REGISTER_DEPRECATED_API_USAGE_V1",b);if(!a.ok)throw a.error;};Ab=function(a,b){gb(a,"UI_CONTEXT_V1_SEND_UI_CONTEXT_CHANGE",zb,c=>b.Ng(c))};Cb=function(a){a.df=setTimeout(()=>{a.Mi(new Bb)},500)};Eb=function(a){const b=Db(a);let c=0;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,function(d){d=Number(d);return(d^b[c++]&15>>d/4).toString(16)})};
Db=function(a){if(!a&&typeof window!=="undefined"&&typeof window.crypto!=="undefined"&&typeof window.crypto.getRandomValues==="function")return window.crypto.getRandomValues(new Uint8Array(31));const b=a!==null&&a!==void 0?a:Math.random;return Array.from({length:31},()=>Math.floor(b()*255))};
Gb=async function(a,b){const c=b.requestId,d=b.path;b=b.payload;const e=a.Vc.get(d);if(e){a.Fd.hd.send({type:"ack",requestId:c});var f=setInterval(()=>a.Fd.hd.send({type:"ack",requestId:c}),9E3);try{var g=await e(b);clearInterval(f);a.Fd.hd.send({type:"response",requestId:c,payload:g})}catch(l){clearInterval(f);g="internal_error";b="Something went wrong on our end, if this issue persists please contact us.";if(l instanceof G){var h=l;l.code==="internal_error"?a.j.G(l,{L:"Internal error in comms handler",
tags:new Map([["type","request"],["path",d]])}):(g=l.code,b=l.rawMessage)}else a.Km?a.j.G(l,{L:"Unexpected error type thrown from comms handler",tags:new Map([["type","request"],["path",d]])}):a.ik.error(l);g=Fb(a.Fd,c,g,b);g.ok||a.j.md(g.error,{L:"unable to send error response",tags:new Map([["type","request"],["path",d]])})}if(h!=null)for(const l of a.Gk)try{l(h)}catch(n){a.j.ad(n,{L:"Error executing errorObserver"})}}else h=Fb(a.Fd,c,"internal_error",`No request handler configured for path: "${d}".`),
h.ok||a.j.md(h.error,{L:"unable to send error response",tags:new Map([["type","request"],["path",d]])})};Fb=function(a,b,c,d){return a.hd.send({type:"error",requestId:b,code:c,message:d})};
Jb=async function(a){({parent:c,addEventListener:f,removeEventListener:b}=window);var b,c;let d=new Hb(1E3);const e=({ports:g,data:h})=>{var l=h?h.source?h.source!=="parent"?q("invalid source"):p():q("'source' is missing in MessageEvent data object"):q("missing 'data' field in MessageEvent");if(l.ok)g.length!==1?a.error("invalid number of ports received from the parent"):([g]=g,d.resolve(g));else switch(l.error){case "invalid source":a.info(l.error,{L:"failed to verify message",extra:new Map([["data.source",
h===null||h===void 0?void 0:h.source]])});break;case "missing 'data' field in MessageEvent":case "'source' is missing in MessageEvent data object":break;default:throw new m(l.error);}};f("message",e);var f=async()=>{let g;var h={source:"iframe"};c.postMessage(h,"*");let l=1;for(;l<=4;)try{g=await d.promise();break}catch(n){d=new Hb(l*1E3),c.postMessage(h,"*"),l++}if(g==null)throw new G({code:"internal_error",message:"Iframe connection timed out after 4 retries"});return g};try{const g=await f();return p(new Ib(g,
a.Nc("comms")))}catch(g){return q(g)}finally{b("message",e)}};Kb=function({src:a,async:b=!1,qk:c}){return new Promise((d,e)=>{const f=document.createElement("script");f.src=a;f.onload=()=>d();f.onerror=g=>{g instanceof ErrorEvent&&g.error?e(g.error):e(Error(g.toString()))};f.async=b;c&&f.setAttribute("crossorigin","anonymous");document.body.append(f)})};
Lb=function({window:a,sc:b}){const c=b.Mh;if(c){var d=["config",c];b.appId==="AAFbV22Umog"&&d.push({cookie_domain:"app-aafbv22umog.canva-apps.com",cookie_flags:"secure;samesite=none"});var e;a.dataLayer=(e=a.dataLayer)!==null&&e!==void 0?e:[];a.dataLayer.push(["js",new Date],d);Kb({src:`https://www.googletagmanager.com/gtag/js?id=${c}`})}};Mb=function(a){return{messages:Object.fromEntries(a.map(({key:b,message:c})=>[b,c]))}};
Pb=function({fl:a,fg:b,$f:c}){if(c===null||c===void 0?0:c.locale){var d=c.locale;var e=d.code;a:switch(d.direction){case 2:d="rtl";break a;case 1:d="ltr";break a;default:throw new L({code:"bad_request",message:"Unknown direction"});}e={code:e,direction:d}}else if(b){e=b.Fl;a:switch(d=b.Gl,d){case 1:d="ltr";break a;case 2:d="rtl";break a;default:throw new m(d);}e={code:e,direction:d}}else e=Nb;b={locale:e,Hl:(c===null||c===void 0?0:c.vk)?Ob:(b===null||b===void 0?0:b.fi)?Mb(b.fi):Ob};a.documentElement.lang=
b.locale.code;a.documentElement.dir=b.locale.direction;return b};Rb=function(a){var b;return(b=a[Qb])!==null&&b!==void 0?b:void 0};Sb=function(a){Reflect.ownKeys(a).forEach(()=>{})};M=function(a){return function(b,c){K(b,"internal_error","Function passed to `featureTag` decorator is null.");Object.defineProperty(b,Qb,{value:a});c.addInitializer(function(){const d=this[b.name].bind(this);Object.defineProperty(d,Qb,{value:a});this[b.name]=d})}};
Vb=async function(a,b){b=Tb.C(b);a=await a.l.request("CONTENT_V1_WHEN_MEDIA_UPLOADED",b);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"CONTENT_V1_WHEN_MEDIA_UPLOADED: Response cannot be empty"});return Ub.F(a.value)};Xb=async function(a){const b=Wb.C({});a=await a.l.request("CONTENT_V1_CLOSE_COLOR_SELECTOR",b);if(!a.ok)throw a.error;};
Zb=function(a,b){a.handle("CONTENT_V1_COLOR_SELECTION_EVENT",async c=>{if(c===void 0)throw new G({code:"internal_error",message:"CONTENT_V1_COLOR_SELECTION_EVENT: Request cannot be undefined"});c=Yb.F(c);return b.Zf(c)})};
ac=function({type:a,result:b,ld:c,Ec:d}){const e=b.type;switch(e){case "DONE":switch(a){case "IMAGE":return{ref:b.ref,whenUploaded:c({type:"image",ref:b.ref,qc:b.qc})};case "VIDEO":return{ref:b.ref,whenUploaded:c({type:"video",ref:b.ref,qc:b.qc})};case "AUDIO":return{ref:b.ref,whenUploaded:c({type:"audio",ref:b.ref,qc:b.qc})};default:throw new L({code:"internal_error",message:`Unexpected upload type '${a}'.`});}case "FAILED":throw $b(b.tc,a.toLowerCase(),d);default:throw new L({code:"internal_error",
message:`Unexpected result type '${e}'.`});}};cc=function(a){a!==void 0&&(Array.isArray(a)?a.forEach(b=>{bc(b)}):bc(a))};bc=function(a){if(!P(a)||!dc.test(a))throw new G({code:"bad_request",message:`Invalid font reference ${a}`});};gc=function(a,b,c,d){a={content:new ec(a,b,c,d)};return{v1:{content:new fc(a.content)},asset:{v2:a}}};hc=function(a){return Object.entries(a).reduce((b,[c,d])=>{typeof d!=="undefined"&&(b[c]=JSON.stringify(d));return b},{})};
ic=function(a){const b={};for(const [c,d]of a)b[c]=JSON.parse(d);return b};jc=function(a){return a.type==="text"||a.type==="richtext"?a.top!=null||a.left!=null||a.width!=null:a.top!=null||a.left!=null||a.width!=null||a.height!=null};kc=function(a,b){return Object.keys(a).length===Object.keys(b).length&&Object.keys(a).every(c=>b.hasOwnProperty(c)&&a[c]===b[c])};lc=function(a,b){for(;b>=0;){if(a.attributes.hasOwnProperty(b))return a.attributes[b];b--}return{}};
nc=function(a,b,c){const d=lc(a,Math.max(0,b-1));b>0&&kc(c,d!==null&&d!==void 0?d:{})?mc(a,{index:b,length:1}):(!c.listLevel&&c.listMarker&&c.listMarker!=="none"&&(c.listLevel=0,c.listMarker="none"),a.attributes[b]={...c})};oc=function(a,b,c){const d=lc(a,b);nc(a,b,{...d,...c})};pc=function(a,b,c){nc(a,b,{...a.attributes[b],...c})};mc=function(a,b){for(let c=b.index;c<b.index+b.length;c++)delete a.attributes[c]};
rc=function(a,b){const c=a.attributes[b];c!=null&&qc.forEach(d=>{c.hasOwnProperty(d)&&(delete c[d],Object.keys(c).length===0&&mc(a,{index:b,length:1}))})};sc=function(a,b){const c=Math.min(Math.max(0,b.index),a.D.length);return{index:c,length:Math.min(b.length,a.D.length-c)}};
tc=function(a,b,c,d,e){({index:b}=sc(a,{index:b,length:0}));a.D=a.D.slice(0,b).concat(c).concat(a.D.slice(b));const f=lc(a,b),g={...(e!==null&&e!==void 0?e:lc(a,Math.max(0,b-1))),...d};d=a.attributes.slice(b);var h=d.findIndex(l=>l!=null&&!kc(l,g!==null&&g!==void 0?g:{}));h=h===-1?d.length:h;d.splice(0,h);a.attributes=a.attributes.slice(0,b).concat(Array(c.length+h)).concat(d);e==null?oc(a,b,g):nc(a,b,g);e=b+c.length;f!=null&&e<a.D.length&&pc(a,e,f);return{bounds:{index:b,length:c.length}}};
wc=function(a,b){if(b.length!==0){var c=sc(a,b),d=c.index,e=Math.max(d+c.length-1,0),f=Math.max(d-1,0);c=Math.min(e+1,a.D.length);var g=lc(a,e),h=lc(a,f);f=lc(a,c);var l=uc(h),n=vc(g);e=e<a.D.length-1&&kc(g,f)?{...l,...n}:void 0;g=a.attributes.slice(c);f=g.findIndex(r=>r!=null&&!kc(h,r));g=f===-1?g.length:f;a.attributes.splice(d,b.length);mc(a,{index:d,length:g});e!=null&&pc(a,d,e);a.attributes[0]!=null&&Object.keys(a.attributes[0]).length===0&&mc(a,{index:0,length:1});a.D.slice(d,c).includes("\n")&&
(b=a.D.slice(c).indexOf("\n"),a.attributes.slice(d,b===-1?a.attributes.length:d+b).forEach((r,t)=>{rc(a,d+t);pc(a,d+t,l)}));a.D=a.D.slice(0,d).concat(a.D.slice(c))}};vc=function(a){const b={...a};Object.keys(b).forEach(c=>{xc.has(c)&&delete b[c]});return b};uc=function(a){const b={...a};Object.keys(b).forEach(c=>{xc.has(c)||delete b[c]});return b};Ac=function(a){a=a.split(".");if(a.length>1){const b=a.pop();if(!b||!yc.test(b))return!1}return a.every(b=>zc.test(b))};
Cc=function(a){Q(a!=null,"embed url must exist","invalid_element_state");Q(Bc.test(a),"invalid embed url","invalid_element_state")};
Ec=function(a){Q(a!=null,"Shape viewBox must exist.","invalid_element_state");Q(Dc(a.top,-32768,32767),"viewBox top should be between [-32768, 32767]","invalid_element_state");Q(Dc(a.left,-32768,32767),"viewBox left should be between [-32768, 32767]","invalid_element_state");Q(Dc(a.width,0,32767,{Uf:!0}),"viewBox width should be between (0, 32767]","invalid_element_state");Q(Dc(a.height,0,32767,{Uf:!0}),"viewBox height should be between (0, 32767]","invalid_element_state")};
Fc=function(a){Q(a.text.length<=250,"Alt text can not exceed 250 characters.","invalid_element_state")};Gc=function(a){if(!Number.isFinite(a))throw new G({code:"bad_request",message:`Number ${a} should be finite.`});return a>=-.001&&a<=.001?0:parseFloat(a.toPrecision(6))};Ic=function(a){Q(Hc.test(a),`Invalid color: ${a}. Color should be a valid 6 digit hex color code.`,"invalid_element_state");return a.toLowerCase()};
Dc=function(a,b,c,d){return Number.isFinite(a)?(d===null||d===void 0?0:d.Uf)&&(d===null||d===void 0?0:d.Hk)?a>b&&a<c:(d===null||d===void 0?0:d.Uf)?a>b&&a<=c:(d===null||d===void 0?0:d.Hk)?a>=b&&a<c:a>=b&&a<=c:!1};Jc=function(a){Q(Dc(a,0,100),"Path stroke weight must be between 0 and 100.","invalid_element_state")};
Pc=function(a){const b=a.type;switch(b){case "append":return Q(a.type==="append","Operation is not an append operation","invalid_element_state"),{type:"append",Sb:Kc(a.Sb)};case "format":return Q(a.type==="format","Operation is not a format operation","invalid_element_state"),{type:"format",bounds:Lc(a.bounds),formatting:Mc(a.formatting)};case "formatParagraph":return Q(a.type==="formatParagraph","Operation is not a format operation","invalid_element_state"),{type:"formatParagraph",bounds:Lc(a.bounds),
formatting:Nc(a.formatting)};case "replace":return Oc(a);default:throw new L({code:"bad_request",message:`Invalid element type: ${b}`});}};
Rc=function(a){Q(a.range!=null,"Richtext range cannot be null","invalid_element_state");Q(typeof a.range.readTextRegions==="function","Richtext range must implement readTextRegions","invalid_element_state");const b=a.range.readTextRegions().map(d=>({text:Qc(d.text),formatting:d.formatting&&Nc(d.formatting)})),c=b.map(d=>d.text).join().trim().length>0;Q(c,"Richtext range must contain at least one non-whitespace character.","invalid_element_state");return{...a,range:{readTextRegions(){return b}}}};
Tc=function(a){const b=a.children;Q(b!=null,"TextElement children must exist.","invalid_element_state");Q(Array.isArray(b)&&b.every(c=>typeof c==="string"),"TextElement children must be an array of string.","invalid_element_state");Q(b.length===1,"TextElement children must have length of 1.","invalid_element_state");Q(b[0].length!==0,"TextElement children cannot be an empty string.","invalid_element_state");return{...a,...Sc(a)}};
Vc=function(a,b){Q(b.children.length>1,"There should be at least 2 elements in a group element's children.","invalid_element_state");return{...b,children:b.children.map(c=>Uc(a,c))}};
bd=function(a,b){Q(b!=null,"element must exist","invalid_element_state");b={...b,...("top"in b&&{top:void 0}),...("left"in b&&{left:void 0}),...("width"in b&&{width:void 0}),...("height"in b&&{height:void 0}),...("rotation"in b&&{rotation:void 0})};var c=b.type;switch(c){case "image":var d=b.dataUrl;c=b.ref;var e=b.altText;Q(d!=null||c!=null,"Image must have either media ref or dataUrl.","invalid_element_state");Q(!(d!=null&&c!=null),"Image elements cannot have both media ref and dataUrl.","invalid_element_state");
if(d!=null){Q(Wc.test(d),"invalid image dataUrl","invalid_element_state");var f=d.substring(d.indexOf(":")+1,d.indexOf(";"));switch(f){case "image/png":case "image/jpeg":case "image/heic":case "image/tiff":case "image/webp":break;case "image/svg+xml":if(Xc.test(d))d=atob(d.replace(Xc,""));else throw new G({code:"bad_request",message:`Failed to load svg from image url: ${d}.`});d=d.toLowerCase();d=d.includes("<script")||d.includes("<metadata")||d.includes("<style");Q(!d,"The following SVG tags <script>, <metadata> and <style> are not supported.",
"invalid_element_state");break;default:throw new G({code:"bad_request",message:`Invalid and/or unsupported image url mime type: '${f}'.`});}}c!=null&&Yc(a,c);e!=null&&Fc(e);return b;case "video":return Q(b.ref!=null,"Video must have a video reference.","invalid_element_state"),Zc(a,b.ref),b.altText!=null&&Fc(b.altText),b;case "embed":return Cc(b.url),b;case "richtext":return Rc(b);case "text":return Tc(b);case "shape":b={...b};c=b.paths;Ec(b.viewBox);Q(c!=null,"Shape paths must exist.","invalid_element_state");
Q(c.length>0&&c.length<=30,"There should be at least 1 path and a maximum of 30 paths.","invalid_element_state");e=new Set;d=0;for(f=0;f<c.length;f++){var g=c[f],h=g.fill;const n=g.stroke;var l=g.d;Q(h!=null,"Path fill must exist.","invalid_element_state");h.dropTarget===void 0&&console.warn("Fill dropTarget should not be undefined. Please provide an explicit value.");const r=$c(a,h);g.fill={...r,dropTarget:h.dropTarget};n&&(n.color=Ic(n.color),Jc(n.weight),Q(n.strokeAlign==="inset","Path stroke alignment should be inset.",
"invalid_element_state"));Q(l!=null&&l.length>0,"Path must exist and cannot be empty.","invalid_element_state");h=l[0].toLowerCase()==="m";Q(h,"Path should begin with a move command.","invalid_element_state");h=l.match(/[mM]/g);Q(!(h&&h.length>1),"Path should not have multiple move command.","invalid_element_state");h=l.match(/[qQtT]/g);Q(!(h&&h.length>0),"Quadratic bezier curve is not supported in path.","invalid_element_state");l=l.match(/\.[^\d]/g);Q(!(l&&l.length>0),"Path contains invalid number.",
"invalid_element_state");e.add(r.color);d+=g.d.length}Q(e.size<=6,"There should be a maximum of 6 distinct fill colors.","invalid_element_state");Q(d<=16384,"There should be a maximum of 16384 bytes for all paths.","invalid_element_state");return b;case "group":return Vc(a,b);case "table":a={type:"table",rows:[]};for(c=0;c<b.rows.length;c++){e=[];for(d=0;d<b.rows[c].cells.length;d++){g=b.rows[c].cells[d];a:{if(g&&(Q(g.type==="string"||g.type==="empty",'Cell content type must be "string" or "empty".',
"invalid_element_state"),g.type==="string")){Q(typeof g.value==="string","Cell content must be a string.","invalid_element_state");f=g.value.length===0?{type:"empty"}:{type:"string",value:g.value};break a}f={type:"empty"}}f={...f,attributes:(g===null||g===void 0?0:g.attributes)?{...Sc(g.attributes),backgroundColor:g.attributes.backgroundColor&&Ic(g.attributes.backgroundColor)}:void 0,rowSpan:(g===null||g===void 0?void 0:g.rowSpan)!==void 0?ad(g.rowSpan):void 0,colSpan:(g===null||g===void 0?void 0:
g.colSpan)!==void 0?ad(g.colSpan):void 0};e.push(f)}a.rows.push({cells:e})}return a;default:throw new L({code:"bad_request",message:`Invalid element type: ${c}`});}};
dd=function(a){Q(!(a.width==="auto"&&a.height==="auto"),'Height and width cannot both be set to "auto".',"invalid_element_placement");var b={...(a.top!=null&&{top:Gc(a.top)})},c={...(a.left!=null&&{left:Gc(a.left)})},d={...(a.width!=null&&{width:cd(a.width)})},e={...(a.height!=null&&{height:cd(a.height)})},f;if(f=a.rotation!=null)a=Gc(a.rotation)%360,f={rotation:a>=180?a-360:a<-180?a+360:a};b={...b,...c,...d,...e,...f};b.top!=null&&Q(Dc(b.top,-32768,32767),"top should be between [-32768, 32767]",
"invalid_element_placement");b.left!=null&&Q(Dc(b.left,-32768,32767),"left should be between [-32768, 32767]","invalid_element_placement");b.width!=null&&typeof b.width==="number"&&Q(Dc(b.width,0,32767),"width should be between (0, 32767]","invalid_element_placement");b.height!=null&&typeof b.height==="number"&&Q(Dc(b.height,0,32767),"height should be between (0, 32767]","invalid_element_placement");b.rotation!=null&&Q(Dc(b.rotation,-180,180),"rotation must be between -180deg to 180deg","invalid_element_placement");
return b};
Uc=function(a,b){Q(!(b.type==="text"&&b.width==="auto"),"Text element width cannot be set to 'auto'","invalid_element_placement");const c={top:b.top,left:b.left,width:b.width,height:"height"in b?b.height:void 0,rotation:b.rotation};a={...bd(a,b),...dd(c)};b.type==="text"||b.type==="richtext"?Q(b.top!=null&&b.left!=null,"Top and left properties must be defined for TextElement with box.","invalid_element_placement"):Q(b.top!=null&&b.left!=null&&b.width!=null&&b.height!=null,"All box properties (top, left, width, height) must exist for elements with box.","invalid_element_placement");
return a};ed=function(a){const b=[];a.top==null&&b.push("top");a.left==null&&b.push("left");a.width==null&&b.push("width");a.height==null&&b.push("height");Q(b.length===0,`Missing placement properties: ${b.join(",")}.`,"invalid_element_placement");return dd(a)};Yc=function(a,b){Q(a.ag.test(b),"invalid image media reference","invalid_element_state");return b};Zc=function(a,b){Q(a.ah.test(b),"Invalid video reference","invalid_element_state");return b};
Qc=function(a,b=!1){Q(typeof a==="string"&&(b||a.length>0),`A string ${b?"":"with at least 1 character "}is required`,"invalid_element_state");return a};
Nc=function(a){a={...a,...(a.fontSize?{fontSize:Gc(a.fontSize)}:{}),...(a.listLevel?{listLevel:Gc(a.listLevel)}:{})};a.listLevel!=null&&Q(Dc(a.listLevel,0,8),"Text listLevel should be between [0, 8]","invalid_element_state");const b={...a};Object.keys(b).forEach(d=>{xc.has(d)&&delete b[d]});const c=Mc(b);a.fontRef&&Q(fd.test(a.fontRef),"Invalid font reference","invalid_element_state");a.fontSize&&Q(Dc(a.fontSize,1,1E3),"Text fontSize should be between [1, 1000]","invalid_element_state");a.textAlign&&
Q(["start","center","end","justify"].includes(a.textAlign),'Incorrect fontAlign value. Allowed values: "start" | "center" | "end" | "justify".',"invalid_element_state");a.listMarker&&Q(gd.includes(a.listMarker),`Incorrect listMarker value. Allowed values: ${hd}.`,"invalid_element_state");a.listLevel===0&&(a.listMarker=a.listMarker||"none",Q(["none"].includes(a.listMarker),'Incorrect listMarker value. When list level is 0, the only allowed value is "none".',"invalid_element_state"));return{...a,...c}};
Sc=function(a){a={...a,...(a.fontSize&&{fontSize:Gc(a.fontSize)}),...(a.color!=null&&{color:Ic(a.color)})};a.fontRef!=null&&Q(fd.test(a.fontRef),"Invalid font reference","invalid_element_state");a.fontSize!=null&&Q(Dc(a.fontSize,1,1E3),"Text fontSize should be between [1, 1000]","invalid_element_state");a.textAlign!=null&&Q(["start","center","end","justify"].includes(a.textAlign),'Incorrect textAlign value. Allowed values: "start" | "center" | "end" | "justify".',"invalid_element_state");a.fontWeight!=
null&&Q(id(a.fontWeight),`Incorrect fontWeight value. Allowed values: ${jd}.`,"invalid_element_state");a.fontStyle!=null&&Q(["normal","italic"].includes(a.fontStyle),'Incorrect fontStyle value. Allowed values: "normal" | "italic".',"invalid_element_state");a.decoration!=null&&Q(["none","underline"].includes(a.decoration),'Incorrect decoration. Allowed values: "none" | "underline".',"invalid_element_state");return a};
id=function(a){switch(a){case "normal":case "thin":case "extralight":case "light":case "medium":case "semibold":case "bold":case "ultrabold":case "heavy":return!0;default:return!1}};
$c=function(a,b){const c={};b.color!=null&&(c.color=Ic(b.color));if(b.asset!=null){switch(b.asset.type){case "image":Yc(a,b.asset.ref);break;case "video":Zc(a,b.asset.ref);break;default:throw new L({code:"internal_error",message:`Unexpected asset type: ${b.asset}.`});}b.asset.altText!=null&&Fc(b.asset.altText);c.asset=b.asset}return c};ad=function(a){if(!Number.isFinite(a)||!Number.isInteger(a)||a<=0)throw new G({code:"bad_request",message:`Number ${a} should be an integer greater than 0.`});return a};
kd=function(a){if(typeof a!=="string")throw new G({code:"bad_request",message:"Page title must be a string"});if(a.length>255)throw new G({code:"bad_request",message:"Page title must be no longer than 255 characters"});return a};cd=function(a){return a==="auto"?"auto":Gc(a)};ld=function(a){Q(typeof a==="boolean","invalid boolean","invalid_element_state");return a};
md=function(a){const b=hc(a);try{var c=(new TextEncoder).encode(JSON.stringify(b)).length}catch(d){c=0}if(c>5120)throw new G({code:"quota_exceeded",message:"Invalid app config data: Maximum limit of 5KB exceeded."});Object.keys(a).forEach(d=>{if(d.includes("$")||d.includes(".")||d.includes("\x00"))throw new G({code:"bad_request",message:"Invalid app config data: AppElementData keys can not include '$' or '.' or '\x00' sign."});});return b};
nd=function(a,b,c){switch(c){case "image":return c=b.ref,Q(typeof c==="string"&&a.ag.test(c),"Invalid content for image selection","invalid_element_state"),b;case "video":return c=b.ref,Q(typeof c==="string"&&a.ah.test(c),"Invalid content for video selection","invalid_element_state"),b;case "plaintext":return Q(typeof b.text==="string","Invalid content for plaintext selection","invalid_element_state"),b;case "richtext":return a.Y.Ad("preview","Richtext Selection"),Q(typeof b.bb==="string","Invalid content for plaintext selection",
"invalid_element_state"),{bb:b.bb,operations:b.operations.map(d=>Pc(d))};default:throw new L({code:"internal_error",message:`Invalid scope: ${c}`});}};Oc=function(a){Q(a.type==="replace","Operation is not an append operation","invalid_element_state");return{type:"replace",bounds:Lc(a.bounds),wb:a.wb.map(b=>Kc(b,!0))}};
Lc=function(a){Q(a.index>=0,"Bounds must start at position 0 or above","invalid_element_state");Q(a.length>=0,"Bounds must have a positive length","invalid_element_state");const [b,c]=[a.index,a.length].map(Math.round);return{index:b,length:c}};Kc=function(a,b=!1){return{text:Qc(a.text,b),formatting:a.formatting&&Mc(a.formatting)}};
Mc=function(a){Q(!od(a),`Block attributes cannot be used in richtext functions that use InlineFormatting. Provided: ${JSON.stringify(a,null,2)}`,"invalid_element_state");a={...a,...(a.color!=null&&{color:Ic(a.color)})};a.fontWeight&&Q(id(a.fontWeight),`Incorrect fontWeight value. Allowed values: ${jd}.`,"invalid_element_state");a.fontStyle&&Q(["normal","italic"].includes(a.fontStyle),'Incorrect fontStyle value. Allowed values: "normal" | "italic".',"invalid_element_state");a.decoration&&Q(["none",
"underline"].includes(a.decoration),'Incorrect decoration. Allowed values: "none" | "underline".',"invalid_element_state");a.strikethrough&&Q(["none","strikethrough"].includes(a.strikethrough),'Incorrect strikethrough. Allowed values: "none" | "strikethrough".',"invalid_element_state");if(a.link){Q(typeof a.link==="string","Incorrect link. Must be a string","invalid_element_state");a:{try{var b=a.link;if(!b.startsWith("#page-")){if(!pd.test(b))throw new G({code:"bad_request",message:"Invalid URL"});
try{var c=new URL(b)}catch(d){throw new G({code:"bad_request",message:"Invalid URL"});}if(!qd.test(c.protocol)){if(c.pathname.includes("[")||c.pathname.includes("]"))throw new G({code:"bad_request",message:"URL may not contain [ or ]"});if(!(c.hash.split("#").length<=2))throw new G({code:"bad_request",message:"Invalid URL hash"});if(!Ac(c.hostname))throw new G({code:"bad_request",message:"Invalid URL domain"});}}}catch(d){b=!1;break a}b=!0}Q(b,"Invalid link url","invalid_element_state")}return a};
Q=function(a,b,c){if(!a)switch(c){case "invalid_element_placement":throw new G({code:"bad_request",message:`Invalid element placement: ${b}`});case "invalid_element_state":throw new G({code:"bad_request",message:`Invalid element state: ${b}`});default:throw new L({code:"internal_error",message:`Unexpected error type: ${c}.`});}};sd=function(a){k(a instanceof rd);return a};td=function(a,b,c){a=sd(a);b=a.V(b);c=a.connect(b,c);return{mutable:b,Rc:c}};
ud=function(a,b){k(Object.getPrototypeOf(a)===Object.prototype);const c={};for(const d in a)c[d]=b(a[d],d);return c};vd=function(...a){const b=new Set;for(const c of a)for(const d in c)k(!b.has(d),'duplicate key: "{}"',d),b.add(d)};wd=function(a,b){return a.Kb(c=>({[b]:c}))};xd=function(a,b){return a.Kb(c=>({[b]:c}))};Ad=function(a){J(a[yd]==null&&!(a instanceof zd),"bad_request","Cannot pass existing elements to element builder.")};
Bd=function(a){const {top:b,left:c,width:d,height:e,rotation:f,transparency:g,...h}=a;a=ed({top:b,left:c,width:d,height:e,rotation:f});J(a.width!=="auto","bad_request","auto width not supported");J(a.height!=="auto","bad_request","auto height not supported");const l=g||0;Q(Dc(l,0,1),"transparency should be between [0, 1]","invalid_element_state");return{...h,top:K(a.top,"bad_request","top is required"),left:K(a.left,"bad_request","left is required"),width:K(a.width,"bad_request","width is required"),
height:K(a.height,"bad_request","height is required"),rotation:a.rotation||0,transparency:l}};Cd=function(a,b){Ad(b);switch(b.type){case "image":return{type:"image",imageRef:Yc(a.O,b.imageRef),flipX:ld(b.flipX||!1),flipY:ld(b.flipY||!1)};case "video":return{type:"video",videoRef:Zc(a.O,b.videoRef),flipX:ld(b.flipX||!1),flipY:ld(b.flipY||!1)};default:throw new L({code:"bad_request",message:"Unknown media type"});}};
Dd=function(a){switch(a.type){case "solid":return{type:"solid",color:Ic(a.color)};default:throw new L({code:"bad_request",message:"Unsupported color type provided "});}};Ed=function(a){return a.filter(()=>!0)};Gd=function(a){return new Fd(a)};Hd=function(a){return a!=null};Id=function(a,b){return{type:3,delta:a,shift:b}};Jd=function(a,{N:b,ta:c}){const d=a.H.length,e=a.Ue||(a.Ue=new Map);a=a.Bg||(a.Bg=new Map);k(!e.has(b));k(!a.has(c));e.set(b,d);a.set(c,d)};Kd=function(a,b){return ma(a.Sh.get(b))};
Md=function(a,b){const c=a.Kb(f=>(new Ld).I(Kd(a,d)).update(f).build()),{mutable:d,Rc:e}=td(a.type,b,c);return{id:String(a.Rl++),value:d,to:e,from:c,toString:()=>`${d}`}};Nd=function(a,b,c){a.ka((new Ld).I(b).insert(c).build());return a.oa[b].value};ce=function(){({tj:b=Od,vj:a=Pd}={tj:Qd,vj:Rd});var a,b;return new Sd(c=>new Td(c),c=>new Ud(c,a),c=>new Vd(c),c=>new Wd(sd(c)),c=>new Xd(c),c=>new Yd(c),c=>new Zd(sd(c),b),(c,d,e)=>new $d(c,d,e),(c,d)=>new ae(c,d),c=>(new be({},{},{})).Wa(c))};ee=function(a){return new de(a)};
ge=function(a,b){return new fe(a,b)};
he=function(a,b,c){const d={values:{type:c.literal("unsupported")}},e=c.number(0,1),f=c.fa(e);var g=c.number(-180,180);g=c.fa(g);var h=c.regexp(/^#[0-9a-f]{6}$/),l=c.fa(h);h=c.pi(h);h=c.fa(h);l=c.N({values:{type:c.literal("solid")},attributes:{color:l}});var n=c.zc({solid:l,unsupported:c.N(d)},r=>r.type,r=>r.type);l=c.value(r=>typeof r==="number"?(Jc(r),!0):!1);l=c.N({J:{colorContainer:c.box(n)},attributes:{weight:c.fa(l)}});a=c.N({values:{type:c.literal("image"),imageRef:c.value(a)},attributes:{flipX:c.Yb,
flipY:c.Yb}});b=c.N({values:{type:c.literal("video"),videoRef:c.value(b)},attributes:{flipX:c.Yb,flipY:c.Yb}});b=c.zc({video:b,image:a},r=>r.type,r=>r.type);b=c.box(c.optional(b));a=c.box(c.optional(n));n=c.N({attributes:{isMediaEditable:c.Yb},J:{mediaContainer:b,colorContainer:a}});c=c.N({J:{mediaContainer:b,colorContainer:a}});return{zb:d,Cp:e,Ul:f,$j:g,Kp:h,Zn:b,Yn:a,stroke:l,fill:c,qm:n}};
ie=function(a){var b=a.value(e=>typeof e==="string");b=a.N({J:{fill:a.qm,stroke:a.optional(a.stroke)},attributes:{d:a.fa(b)}});const c=a.list(b);var d=a.Gi({top:a.Qf,left:a.Qf,height:a.Id,width:a.Id},e=>{Ec(e);return!0});d=a.fa(d);a={values:{type:a.literal("shape")},J:{paths:c}};return{eh:d,path:b,yi:c,Oj:a}};
je=function(a){var b=a.N({attributes:{locked:a.Yb,top:a.Gh,left:a.Gh,width:a.ki,height:a.ki,rotation:a.$j,transparency:a.Ul}});const c=b.Wa({values:{type:a.literal("rect")},J:{fill:a.fill,stroke:a.stroke}}),{eh:d,Oj:e,path:f,yi:g}=ie(a),h=b.Wa(e).Wa({attributes:{viewBox:d}});var l=a.value(N=>typeof N==="string"?(Cc(N),!0):!1);l=b.Wa({values:{type:a.literal("embed"),url:l}});const n=b.Wa({values:{type:a.literal("text")},J:{text:a.richtext}}),r=b.Wa(a.zb);var t={rect:c,shape:h,embed:l,text:n,unsupported:r};
const w=a.zc(t,N=>N.type,N=>N.type),x=a.list(w);b=b.Wa({values:{type:a.literal("group")},J:{contents:x}});t=a.zc({...t,group:b},N=>N.type,N=>N.type);const F=a.list(t),H=a.N({attributes:{locked:a.Yb}}).Wa({values:{type:a.literal("absolute")},J:{background:a.optional(a.fill),elements:F},attributes:{dimensions:a.gm(a.dimensions)}}),I=a.N(a.zb),O=a.zc({absolute:H,zb:I},N=>N.type,N=>N.type);a=a.list(O);return{path:f,yi:g,eh:d,kp:w,lp:x,bq:c,mq:h,mp:b,Bo:l,tq:n,yq:r,element:t,Ao:F,fp:H,zq:I,page:O,km:a}};
ke=function(a){const b=a.value(c=>typeof c!=="number"?!1:c===-1||a.Id.Fa(c));return{dimensions:a.Gi({width:b,height:b},c=>c.width===-1===(c.height===-1))}};le=function(a){const b=a.N({values:{type:a.literal("absolute")}}),c=a.N(a.zb),d=a.zc({absolute:b,zb:c},e=>e.type,e=>e.type);a=a.list(d);return{gp:b,Aq:c,pageMetadata:d,Sp:a}};
oe=function(a,b,c){const d=ce();a=he(a,b,d);b=ke(d);c=new me(c);b=je({...d,...a,...b,richtext:c});const e=ne({...d,...b}),f=le({...d,...a});return{richtext:c,...d,...a,...b,...e,...f}};ne=function(a){const b=a.N({values:{positioning:a.literal("absolute")},J:{pages:a.km}}),c=a.N({values:{positioning:a.literal("unsupported")}});a=a.zc({absolute:b,unsupported:c},d=>d.positioning,d=>d.positioning);return{ep:b,xq:c,yo:a}};
pe=function(a){let b=0,c=0;const d=Ed(a),e=[];a.forEach((f,g)=>{if(f=g-c)b&&(e.push(b),b=0),e.push(-f);b++;c=g+1});return[d,e]};qe=function(a,b){const c=[];let d=0;for(const e of b)e<0?d+=-e:e>0&&(a.slice(0,e).forEach(f=>c[d++]=f),a=a.slice(e));a.length&&a.forEach(e=>c[d++]=e);return c};
te=function(a,b,c,d,e,f,g,h,l){var n=se;const r=[];for(const t of l.H)switch(t.type){case 0:r.push(new a(t));break;case 1:r.push(new b(t));break;case 2:r.push(new c({state:t.state!=null?g(t.state):void 0,shift:t.shift&&new n(t.shift)}));break;case 3:l=t.shift&&new n(t.shift);const w=t.delta;if(w==null){r.push(new d({shift:l}));break}switch(w.type){case 0:r.push(new d({delta:w.delta!=null?h(w.delta):void 0,shift:l}));break;case 1:r.push(new e({oldState:w.oldState!=null?g(w.oldState):void 0,newState:w.newState!=
null?g(w.newState):void 0,shift:l}));break;default:throw new m(w);}break;default:throw new m(t);}return new f({H:r})};
ue=function(a,b,c){const d=new Ld;for(const e of c.H)switch(e.type){case "RETAIN":d.I(e.length);break;case "EXPAND":d.expand(e.length);break;case "INSERT":d.insert(e.state!=null?a(e.state):void 0,e.shift);break;case "UPDATE":d.update(e.delta!=null?b(e.delta):void 0,e.shift);break;case "CHANGE":d.Cb(e.oldState!=null?a(e.oldState):void 0,e.newState!=null?a(e.newState):void 0,e.shift);break;default:throw new m(e);}return d.build()};ve=function(a){return a!=null?a:void 0};
we=function(a){switch(a){case "normal":case "italic":case void 0:return a;default:throw new G({code:"bad_request",message:`Invalid font style: ${a}`});}};xe=function(a){switch(a){case "start":case "center":case "end":case "justify":case void 0:return a;default:throw new G({code:"bad_request",message:`Invalid text align: ${a}`});}};ye=function(a){switch(a){case "strikethrough":case "none":case void 0:return a;default:throw new G({code:"bad_request",message:`Invalid strikethrough: ${a}`});}};
ze=function(a){switch(a){case "none":case "disc":case "circle":case "square":case "decimal":case "lower-alpha":case "lower-roman":case "checked":case "unchecked":case void 0:return a;default:throw new G({code:"bad_request",message:`Invalid list marker: ${a}`});}};
Ae=function(a){switch(a){case "normal":case "thin":case "extralight":case "light":case "medium":case "semibold":case "bold":case "ultrabold":case "heavy":case void 0:return a;default:throw new G({code:"bad_request",message:`Invalid font weight: ${a}`});}};Be=function(a){switch(a){case "none":case "underline":case void 0:return a;default:throw new G({code:"bad_request",message:`Invalid font decoration: ${a}`});}};
De=function(a){if(jc(a))return a.type==="text"||a.type==="richtext"?new Ce({top:a.top,left:a.left,width:typeof a.width==="undefined"?void 0:String(a.width),rotation:a.rotation}):new Ce({top:a.top,left:a.left,width:String(a.width),height:String(a.height),rotation:a.rotation})};He=function(a){var b;return new Ee({elements:(b=a.elements)===null||b===void 0?void 0:b.map(Fe),background:a.background&&Ge(a.background),title:a.title})};
Ie=function(a){let b;Array.isArray(a.$a)&&(b=a.$a.map(Fe));return{ib:new Map(Object.entries(a.ib)),appData:a.appData,$a:b,placement:a.placement&&new Ce({top:a.placement.top,left:a.placement.left,width:String(a.placement.width),height:String(a.placement.height),rotation:a.placement.rotation})}};Ke=function(a){return new Je({...Ie(a),elementId:a.Qj})};Me=function(a){return new Le(a)};
Re=function(a){switch(a.type){case "append":return new Ne({chunks:[{D:a.Sb.text,formatting:a.Sb.formatting?Me(a.Sb.formatting):void 0}]});case "replace":return new Oe({bounds:a.bounds,chunks:a.wb.map(b=>({D:b.text,formatting:b.formatting?Me(b.formatting):void 0}))});case "format":return new Pe({bounds:a.bounds,formatting:Me(a.formatting)});case "formatParagraph":return new Qe({bounds:a.bounds,formatting:Me(a.formatting)});default:throw new L({code:"bad_request",message:"Unknown operation type"});
}};Ze=function(a,b){a=a.map(c=>{if(!c)return new Se;switch(b){case "richtext":return new Te({operations:c.operations.map(Re),bb:c.bb,regions:(c.regions||[]).map(Ue)});case "image":return new Ve({ref:c.ref});case "plaintext":return new We({text:c.text});case "video":return new Xe({ref:c.ref});default:throw new L({code:"internal_error",message:`Unknown selection scope: '${b}'.`});}});return new Ye({values:a})};
$e=function(a){const b={...a,fontRef:ve(a.fontRef),fontWeight:Ae(a.fontWeight),fontStyle:we(a.fontStyle),decoration:Be(a.decoration),textAlign:xe(a.textAlign),strikethrough:ye(a.strikethrough),listMarker:ze(a.listMarker)};Object.keys(b).forEach(c=>{b[c]==null&&delete b[c]});return b};
af=function(a){switch(a.content){case "RICHTEXT":return{type:"richtext",id:a.Pi,ranges:a.ranges.map(b=>({tombstone:b.tombstone||!1,chunks:b.chunks.map(c=>({text:c.D,formatting:c.formatting&&$e(c.formatting)}))}))};case "FILL":return{type:"fill",id:a.Pi,fills:a.fills.map(b=>{a:switch(b.fill.type){case "image":b={id:b.id,type:"image",ref:b.fill.ref,deleted:b.tombstone||!1,altText:b.fill.altText};break a;case "video":b={id:b.id,type:"video",ref:b.fill.ref,deleted:b.tombstone||!1,altText:b.fill.altText};
break a;default:throw new G({code:"internal_error",message:`Invalid ProtoFillContent type: ${b.fill.type}`});}return b})};default:throw new L({code:"bad_request",message:"Invalid content type"});}};
bf=function(a){switch(a.type){case "FORMAT":return{type:"format",formatting:$e(a.formatting),bounds:a.bounds};case "FORMAT_PARAGRAPH":return{type:"formatParagraph",formatting:$e(a.formatting),bounds:a.bounds};case "APPEND":return{type:"append",Sb:{text:a.chunks[0].D,formatting:a.chunks[0].formatting&&$e(a.chunks[0].formatting)}};case "REPLACE":return{type:"replace",bounds:a.bounds,wb:a.chunks.map(b=>({text:b.D,formatting:b.formatting&&$e(b.formatting)}))};default:throw new L({code:"bad_request",message:"Invalid operation type"});
}};Ue=function(a){return new cf({D:a.text,formatting:a.formatting&&Me(a.formatting)})};df=function(a){return{text:a.D,formatting:a.formatting&&$e(a.formatting)}};
ef=function(a){return a.values.map(b=>{switch(b.scope){case "TOMBSTONE":break;case "PLAINTEXT":return{text:b.text};case "RICHTEXT":return{bb:b.bb,operations:b.operations.map(bf),regions:b.regions.map(df)};case "IMAGE":return{ref:b.ref};case "VIDEO":return{ref:b.ref};default:throw new G({code:"internal_error",message:`Invalid ProtoSelectionValue: ${JSON.stringify(b)}`});}})};
ff=function(a){switch(a){case "plaintext":return 1;case "image":return 2;case "video":return 4;case "richtext":return 3;default:throw new G({code:"internal_error",message:`Invalid scope: ${a}`});}};gf=function(a){switch(a){case 1:return"plaintext";case 2:return"image";case 4:return"video";case 3:return"richtext";default:throw new G({code:"internal_error",message:`Invalid scope: ${a}`});}};hf=function(a){return{id:a.Xe.id,scope:gf(a.scope),count:a.count}};
jf=function(a){if(a.canOpen)return{id:a.id,canOpen:!0};const b=K(a.reason,"internal_error","Unable to overlay reason must exist.");return{id:a.id,canOpen:!1,reason:b}};lf=function({target:a,Ef:b}){return new kf({Ef:b,target:a})};
pf=function(a,b){if(b!=null)switch(b.type){case "UPDATE":if(b.delta==null)break;if(b.delta.type==="COLOR")return b.delta.color==null?void 0:{type:0,delta:{key:"solid",value:{color:{type:1,oldState:mf(b.delta.color.oldState).color,newState:mf(b.delta.color.newState).color}}}};if(b.delta.type==="GRADIENT")break;throw new L({code:"internal_error",message:"Unknown delta type"});case "REPLACE":return{type:1,oldState:nf(a.la,b.oldState),newState:nf(a.la,b.newState)}}};
sf=function(a,b){var c;if(b!=null){if(b.type==="REPLACE")return{type:1,oldState:qf(a.la,b.oldState),newState:qf(a.la,b.newState)};if(b.type==="UPDATE")switch((c=b.delta)===null||c===void 0?void 0:c.type){case void 0:return;case "IMAGE":return{type:0,delta:{key:"image",value:{flipX:b.delta.flipX&&rf(b.delta.flipX),flipY:b.delta.flipY&&rf(b.delta.flipY)}}};case "VIDEO":return{type:0,delta:{key:"video",value:{flipX:b.delta.flipX&&rf(b.delta.flipX),flipY:b.delta.flipY&&rf(b.delta.flipY)}}};default:throw new L({code:"internal_error",
message:"Unknown delta type"});}throw new L({code:"internal_error",message:"Unknown media delta"});}};tf=function(a,b){return{colorContainer:pf(a,b.colorContainer),mediaContainer:sf(a,b.mediaContainer)}};rf=function(a){return{type:1,oldState:a.oldState,newState:a.newState}};
yf=function(a){var b;if(a!=null){if(a.type===1)return{type:"REPLACE",oldState:uf(a.oldState),newState:uf(a.newState)};if(a.type===0)switch((b=a.delta)===null||b===void 0?void 0:b.key){case void 0:break;case "solid":return new vf({delta:new wf({color:xf(a.delta.value.color)})});case "unsupported":throw new G({code:"bad_request",message:"App cannot change gradients"});default:throw new L({code:"internal_error",message:"Unknown delta type"});}}};
Df=function(a,b){var c;if(b!=null){if(b.type===1)return new zf({oldState:a.la.Ze(b.oldState),newState:a.la.Ze(b.newState)});if(b.type===0)switch((c=b.delta)===null||c===void 0?void 0:c.key){case void 0:return;case "image":return new Af({delta:new Bf({flipX:xf(b.delta.value.flipX),flipY:xf(b.delta.value.flipY)})});case "video":return new Af({delta:new Cf({flipX:xf(b.delta.value.flipX),flipY:xf(b.delta.value.flipY)})});default:throw new L({code:"internal_error",message:"Unknown delta subtype"});}throw new L({code:"internal_error",
message:"Unknown delta type"});}};Ff=function(a,b){return new Ef({colorContainer:yf(b.colorContainer),mediaContainer:Df(a,b.mediaContainer)})};xf=function(a){if(a){if(a.type===0)throw new G({code:"internal_error",message:"Value boxes cannot update"});return{oldState:a.oldState,newState:a.newState}}};
Hf=function(a,b){switch(b.type){case "REPLACE":J(b.oldState==null===(b.newState==null),"internal_error","old state and new state cannot have different emptiness");if(b.oldState==null||b.newState==null)return{};var c=Gf(a.la,b.oldState);a=Gf(a.la,b.newState);return{weight:{type:1,oldState:c.weight,newState:a.weight},colorContainer:{type:1,oldState:c.colorContainer,newState:a.colorContainer}};case "UPDATE":var d;const f=((c=b.delta)===null||c===void 0?void 0:c.weight)&&rf(b.delta.weight);if(((d=b.delta)===
null||d===void 0?void 0:d.colorContainer)==null)return{weight:f};if(b.delta.colorContainer.type==="REPLACE")return{weight:f,colorContainer:{type:1,newState:K(nf(a.la,b.delta.colorContainer.newState),"internal_error","Stroke states must be defined"),oldState:K(nf(a.la,b.delta.colorContainer.oldState),"internal_error","Stroke states must be defined")}};if(b.delta.colorContainer.type==="UPDATE"){var e;return((e=b.delta.colorContainer.delta)===null||e===void 0?void 0:e.type)==="COLOR"&&b.delta.colorContainer.delta.color?
{weight:f,colorContainer:{type:0,delta:{key:"solid",value:{color:{type:1,newState:K(mf(b.delta.colorContainer.delta.color.newState).color,"internal_error","Stroke states must be defined"),oldState:K(mf(b.delta.colorContainer.delta.color.oldState).color,"internal_error","Stroke states must be defined")}}}}}:{weight:f}}throw new L({code:"internal_error",message:"Invalid stroke delta"});default:throw new L({code:"internal_error",message:"unknown stroke delta"});}};
Kf=function(a){if(a){var b=xf(a.weight);a=yf(a.colorContainer);return new If({delta:new Jf({weight:b,colorContainer:a})})}};
Lf=function(a,b){switch(b.type){case "REPLACE":return{type:3,jb:a.Nf(b.chunks[0]),bounds:b.bounds};case "APPEND":return{type:2,jb:a.Nf(b.chunks[0])};case "FORMAT":return{type:0,bounds:b.bounds,formatting:Nc($e(b.formatting))};case "FORMAT_PARAGRAPH":return{type:1,bounds:b.bounds,formatting:Nc($e(b.formatting))};default:throw new L({code:"internal_error",message:"Unknown richtext operation"});}};
Mf=function(a,b,c){return c.length?{type:0,state:{regions:c.map(a.Nf)}}:{type:1,operations:b.map(d=>({op:Lf(a,d)}))}};Of=function(a){switch(a.type){case 3:return{type:"REPLACE",chunks:[Nf(a.jb)],bounds:a.bounds};case 2:return{type:"APPEND",chunks:[Nf(a.jb)]};case 0:return{type:"FORMAT",bounds:a.bounds,formatting:Me(a.formatting)};case 1:return{type:"FORMAT_PARAGRAPH",bounds:a.bounds,formatting:Me(a.formatting)};default:throw new L({code:"internal_error",message:"Unknown richtext operation"});}};
Pf=function(a){const b={operations:[],chunks:[]};switch(a.type){case 0:b.chunks=a.state.regions.map(c=>({D:c.text,formatting:c.formatting&&Me(c.formatting)}));break;case 1:a.operations.forEach(({op:c})=>{b.operations.push(Of(c))});break;default:throw new L({code:"internal_error",message:"Unknown delta type"});}return b};Nf=function(a){return{D:a.text,formatting:a.formatting&&Me(a.formatting)}};Rf=function(a){return a.width===Qf.width&&a.height===Qf.height};
Sf=function(a){Object.keys(a).forEach(b=>{a[b]===void 0&&delete a[b]});return a};Tf=function(a,b){a.deleted||(a.D="",a.attributes=[],b.forEach(({text:c,formatting:d})=>{a.attributes[a.D.length]=d!==null&&d!==void 0?d:{};a.D+=c}))};Gf=function(a,b){return{weight:b.weight,colorContainer:nf(a,b.colorContainer)}};nf=function(a,b){if(b!=null){if(b.type==="COLOR")return mf(b.color);if(b.type==="GRADIENT")return a.bk();throw new L({code:"internal_error",message:"Unknown color fill type"});}};
mf=function(a){return{type:"solid",color:a}};uf=function(a){if(a!=null)switch(a.type){case "solid":return new Uf({color:a.color});case "unsupported":return new Vf;default:throw new L({code:"internal_error",message:"Unknown color fill type"});}};qf=function(a,b){if(b!=null){if(b.type==="IMAGE")return a.ck(b);if(b.type==="VIDEO")return a.gk(b,b.flipX,b.flipY);throw new L({code:"internal_error",message:"Unknown media fill type"});}};
Wf=function(a,b){return{mediaContainer:qf(a,b.mediaContainer),colorContainer:nf(a,b.colorContainer)}};Yf=function(a){return new Xf({weight:a.weight,colorContainer:uf(a.colorContainer)})};Zf=function(a){return{top:a.top,left:a.left,width:a.width,height:a.height,locked:a.locked,rotation:a.rotation,transparency:a.transparency}};$f=function(a){return{top:a.top,left:a.left,width:a.width,height:a.height,locked:a.locked,rotation:a.rotation,transparency:a.transparency}};
ag=function(a,b){K(b.stroke,"internal_error","Expected host to backfill rect stroke");return{type:"rect",...Zf(b),fill:Wf(a,b.fill),stroke:Gf(a,b.stroke)}};dg=function(a,b){var c={...$f(b)},d=b.fill;a=new bg({colorContainer:uf(d.colorContainer),mediaContainer:a.Ze(d.mediaContainer)});return new cg({...c,fill:a,stroke:b.stroke&&Yf(b.stroke)})};eg=function(a,b){return{type:"shape",...Zf(b),viewBox:b.viewBox,paths:qe(b.paths,b.zi).map(c=>a.Dh(c))}};
hg=function(a,b){const [c,d]=pe(b.paths);return new fg({...$f(b),viewBox:new gg(b.viewBox),paths:c.map(e=>a.Vi(e)),zi:d})};jg=function(a,b){a=new ig("",a.O,b.wb.map(c=>({text:c.D,formatting:c.formatting&&$e(c.formatting)})));return{type:"text",...Zf(b),text:{regions:a.readTextRegions()}}};lg=function(a){return new kg({...$f(a),wb:a.text.regions.map(b=>({D:b.text,formatting:b.formatting&&Me(b.formatting)})).filter(Hd)})};mg=function(a,b){return{...a.zb(),...Zf(b)}};
ng=function(a,b){return{type:"group",...Zf(b),contents:qe(b.contents,b.ph).map(c=>{J(c.type!=="GROUP","internal_error","deserializeGroupElement() does not supported nested groups");return a.we(c)})}};pg=function(a,b){const [c,d]=pe(b.contents);return new og({...$f(b),contents:c.map(e=>a.Ye(e)),ph:d})};
qg=function(a,b,c){const d=(c=b.dimensions?Rf(b.dimensions)?void 0:b.dimensions:Rf(c)?void 0:c)&&Wf(a,b.background);return{type:"absolute",locked:b.locked,dimensions:c,background:d,elements:qe(b.elements,b.nk).map(e=>a.Bh(e))}};
ug=function({lm:a,Pf:b,O:c,Rj:d}){const e=oe(c.xl,c.Bl,c),f=new rg(c),g=new sg(f,c);a=f.dk(a,b);const {mutable:h,Rc:l}=td(e.page,a,{next:n=>{n=g.cn(n);d.next(n)},error:n=>d.error(n)});return{mutable:h,apply:n=>{n=g.ek(n);l.next(n)},snapshot:()=>{const n=e.page.snapshot(h);switch(n.type){case "absolute":const r=tg(n.elements);return{...n,elements:r};case "unsupported":return n;default:throw new L({code:"internal_error",message:"Unknown page type"});}}}};
tg=function(a){return Ed(a).map(b=>{switch(b.type){case "unsupported":case "embed":case "text":case "rect":return b;case "shape":return{...b,type:"shape",paths:Ed(b.paths)};case "group":return{...b,contents:tg(b.contents)};default:throw new L({code:"internal_error",message:"Unknown element type"});}})};
xg=function(a,b,c,d,e){a=ug({lm:a,Pf:b,O:c,Rj:{next:g=>f.buffer(g),error:g=>{if(g instanceof G)throw g;throw new G({code:"internal_error",message:typeof g==="string"?g:"unknown error"});}}});const f=new vg(a,new wg(c),d,e);return f};Bg=function(){const a=yg(this,zg);Ag(this,zg,[]);return a};Fg=function(){Ag(this,Cg,!1);Ag(this,zg,[]);return Dg(yg(this,Eg))};
Lg=function(a,b){a.handle("DI_V1_SEND_APP_ELEMENT_CHANGE",async c=>{c=c?Gg.F(c):void 0;return b.Vm(c)});a.handle("DI_V1_SEND_APP_ELEMENT_CREATE_FROM_PRESET",async c=>{if(c===void 0)throw Error();c=Hg.F(c);c=await b.Um(c);return Je.C(c)});gb(a,"DI_V1_SEND_APP_ELEMENT_DROP",Ig,c=>b.Wm(c),Je);gb(a,"DI_V1_SEND_SELECTION_ACTION_CHANGE_EVENT",Jg,c=>b.Ym(c));gb(a,"DI_V1_SEND_SELECTION_OVERLAY_CAN_OPEN_CHANGE_EVENT",Kg,c=>b.Mg(c))};
Pg=async function(a,b){a=await a.l.request("DI_V1_SYNC_DESIGN_TREE",Mg.C(b));a=Ng(a,"DI_V1_SYNC_DESIGN_TREE","Encountered an error while applying design changes");return Og.F(a)};Dg=async function(a){a=await a.l.request("DI_V1_FINISH_DESIGN_READ",Qg.C({}));a=Ng(a,"DI_V1_FINISH_DESIGN_READ","Encountered an error while closing the design");return Rg.F(a)};
Tg=async function(a){a=await a.l.request("DI_V1_GET_APP_ELEMENT_ID");a=Ng(a,"DI_V1_GET_APP_ELEMENT_ID","Encountered an error while setting app element data");return Sg.F(a)};Ug=async function(a,b){await a.l.request("DI_V1_CLEAR_APP_ELEMENT_ID",b)};Wg=async function(a,b){await a.l.request("DI_V1_SET_APP_ELEMENT_LOADING",Vg.C(b))};Yg=function(a){a.l.request("DI_V1_SUBSCRIBE_APP_ELEMENT_DATA_CHANGE").then(b=>{if(!b.ok)throw Xg(b.error,"Unable to subscribe to app element data change.");})};
$g=async function(a,b){a=await a.l.request("DI_V1_TRACK_APP_API_ELEMENT_ADD_OR_UPDATE_FAILED",Zg.C(b));if(!a.ok)throw Xg(a.error,"Could not track app element's add or update failure");};bh=async function(a,b){a=await a.l.request("DI_V1_GET_SELECTION_CONTENT",ah.C(b));a=Ng(a,"DI_V1_GET_SELECTION_CONTENT","Could not retrieve selection information.");return Ye.F(a)};
eh=async function(a,b){a=await a.l.request("DI_V1_SUBSCRIBE_SELECTION_ACTION_CHANGE",ch.C(b));a=Ng(a,"DI_V1_SUBSCRIBE_SELECTION_ACTION_CHANGE","Could not create selection listener.");return dh.F(a)};gh=async function(a,b){a=await a.l.request("DI_V1_UNSUBSCRIBE_SELECTION_ACTION_CHANGE",fh.C(b));if(!a.ok)throw Xg(a.error,"Could not unsubscribe from selection listener.");};
jh=async function(a,b){a=a.l;var c=a.request;b=hh(kf.C(b[0]),b[1]);b=await c.call(a,"DI_V1_OPEN_SELECTION_EVENT_OVERLAY",b);b=Ng(b,"DI_V1_OPEN_SELECTION_EVENT_OVERLAY","Encountered an error while creating selection event overlay.");return ih.F(b)};mh=async function(a){a=await a.l.request("DI_V1_SUBSCRIBE_SELECTION_OVERLAY_CAN_OPEN_CHANGE",kh.C({target:"image_selection"}));a=Ng(a,"DI_V1_SUBSCRIBE_SELECTION_OVERLAY_CAN_OPEN_CHANGE","Could not create selection overlay can open listener.");return lh.F(a)};
oh=async function(a,b){a=await a.l.request("DI_V1_UNSUBSCRIBE_SELECTION_ACTION_CHANGE",nh.C(b));if(!a.ok)throw Xg(a.error,"Could not unsubscribe from selection overlay can open listener.");};rh=async function(a,b){a=await a.l.request("DI_V1_READ_DESIGN_CONTENT",ph.C(b));a=Ng(a,"DI_V1_READ_DESIGN_CONTENT","Could not read design content.");return qh.F(a)};
th=async function(a,b){a=await a.l.request("DI_V1_SYNC_DESIGN_CONTENT",sh.C(b));a=Ng(a,"DI_V1_SYNC_DESIGN_CONTENT","Design update was rejected and the query has been closed");return qh.F(a)};vh=async function(a,b){await a.l.request("DI_V1_FINISH_DESIGN_CONTENT_UPDATE",uh.C(b))};yh=async function(a){var b=new wh;a=await a.l.request("DI_V1_READ_SPARSE_DESIGN_TREE",wh.C(b));a=Ng(a,"DI_V1_READ_SPARSE_DESIGN_TREE","Encountered an error while reading the design");return xh.F(a)};
Ng=function(a,b,c){if(!a.ok)throw Xg(a.error,c);if(a.value==null)throw new G({code:"internal_error",message:`${b}: Result Cannot be empty`});return a.value};Xg=function(a,b){return a instanceof G?new G({code:a.code,message:`${b}: ${a.rawMessage}`}):new G({code:"internal_error",message:`${b}: ${a}`})};
Ah=function(a,b){let c=()=>Promise.resolve();mh(a.A).then(d=>{const {id:e,mc:f}={id:d.zd,mc:jf(d.mc)};c=async()=>{await oh(a.A,{zd:e})};const g=h=>{var l;(l=a.wh)!==null&&l!==void 0&&l.Cc&&(l.Cc=!1);a.wh=new zh(h);const n=K(a.wh,"internal_error","this.currentInternalSelectionOverlay should exist.");b({get canOpen(){return n.canOpen},get reason(){return n.reason},open:async r=>{if(!n.canOpen)throw new G({code:"bad_request",message:"Overlay can not be opened."});try{return n.Cc&&(n.rf=!0),(await jh(a.A,
[lf({target:"image_selection",Ef:h.id}),r.launchParameters])).appProcessId}catch(t){n.Cc&&(n.rf=!1);if(t instanceof G)throw t;throw new G({code:"internal_error",message:"There was an issue with opening selection overlay. Please try again."});}}})};a.Ri.set(e,h=>g(h));g(f)});return()=>{c()}};Bh=function(a,b){a.Ri.forEach(c=>c(b))};
Ch=function(a,b){const c=b.ranges.map((d,e)=>new ig(e.toString(),a.O,d.chunks));return{contents:c,sync:async()=>{const d=await th(a.A,{content:"RICHTEXT",id:b.id,operations:c.map(e=>({operations:e.operations.map(Re)}))});J(d.content==="RICHTEXT","internal_error","Non richtext response received for richtext sync");d.ranges.forEach(({chunks:e,tombstone:f},g)=>{c[g]._operations=[];f?(Tf(c[g],[]),c[g].deleted=!0):Tf(c[g],e.map(h=>({text:h.D,formatting:h.formatting&&$e(h.formatting)})))})}}};
Dh=function(a,b){const c=new Map;return{contents:b.fills.map(d=>{let e;e=d.type==="image"?{type:"image",ref:d.ref,altText:d.altText,deleted:d.deleted}:{type:"video",ref:d.ref,altText:d.altText,deleted:d.deleted};c.set(d.id,e);return e}),sync:async()=>{const d=await th(a.A,{content:"FILL",id:b.id,Dn:Array.from(c.entries()).map(([e,f])=>({Pk:e,fill:{type:f.type,ref:f.ref,altText:f.altText}}))});J(d.content==="FILL","internal_error","Non fill response received for fill sync");d.fills.forEach(e=>{const f=
c.get(e.id);f&&(f.ref=e.fill.ref,f.deleted=e.tombstone||!1)})}}};Eh=function(a,b){J(a.vc!=null,"internal_error","renderAppElement must not be null");b=a.vc(b);J(Array.isArray(b),"internal_error","renderAppElement must return an array");return b.map(c=>{const d=c.type;switch(d){case "embed":case "text":case "shape":case "image":case "video":case "richtext":return Uc(a.O,c);default:throw new L({code:"bad_request",message:`Unsupported element type '${d}' in app element.`});}})};
Fh=async function(a,{error:b,Bb:c,data:d}){try{var e=a.A;var f=new Zg({Ek:{code:b.code,message:b.rawMessage},Bb:c,data:d?new Map(Object.entries(d)):void 0});await $g(e,f)}catch(g){if(g instanceof G)throw new G({code:g.code,message:`${"Encountered an error while trackAppApiElementAddedOrUpdatedFailed"}: ${g.rawMessage}`});throw new G({code:"internal_error",message:`${"Encountered an error while trackAppApiElementAddedOrUpdatedFailed"}: ${g instanceof Error?g.message:g}`});}};
Gh=async function(a,b){a=jc(b)?Uc(a.O,b):bd(a.O,b);return Fe(a)};Hh=function(a,b,c){if(!a.vc)throw new G({code:"failed_precondition",message:`You've registered an ${b} callback for this AppElement using the '${c}' method,
without registering a render callback with the 'registerRenderAppElement' method.

This doesn't work because the AppElement re-renders based on the AppElementData produced by
the ${b} callback.

Please ensure you've registered the render callback using 'registerRenderAppElement'.`});};Jh=function(a){return new Promise(b=>{if(!Ih(a))return b(!1);const c=document.createElement("img");c.onload=()=>b(!0);c.onerror=()=>b(!1);c.src=a})};Kh=async function(a){const b=[Jh(a.fullSizeSrc)];a.previewUrl&&a.previewUrl!==a.fullSizeSrc&&b.push(Jh(a.previewUrl));if((await Promise.all(b)).filter(c=>!c).length>0)throw new G({code:"bad_request",message:"image could not be loaded"});};
Lh=function(a){try{return typeof a==="string"&&(new URL(a)).toString()!=null}catch(b){return!1}};Mh=function(a){return a instanceof Function};Nh=function(a,b){return typeof a==="string"&&(!b||a.length>=b)};Oh=function(a){return typeof a==="number"&&a>0};Ih=function(a){var b;return Nh(a)&&((b=a.match(/^data:(?:image\/jpeg|image\/png)(?:;base64)?,/))===null||b===void 0?void 0:b.length)===1};Qh=function(a){return Nh(a)&&Ph.has(a)};Rh=function(a,b){return b.some(c=>c===a)};
Th=function(a){return a!=null&&typeof a==="object"&&Sh(a,{width:4,height:4})};Uh=function(a,b){switch(b){case 1:return Ih(a);case 3:return Qh(a);case 2:return typeof a==="number";case 0:return Nh(a);case 4:return Oh(a);default:throw new L({code:"bad_request",message:"Invalid validation type"});}};
Sh=function(a,b,c){if(typeof a!=="object"||(a===null||a===void 0?void 0:a.constructor)!==Object)return!1;const d=new Set(Object.keys(b)),e=new Set(c?Object.keys(c):[]);for(const f of Object.keys(a)){const g=e.has(f);if(!d.has(f)&&!g)throw new G({code:"bad_request",message:`The following unexpected key was supplied: ${f}`});d.delete(f);const h=b[f]||(c===null||c===void 0?void 0:c[f])||(()=>!1);if(h==null)return!1;const l=a[f];if(!(g&&a[f]===void 0||(h instanceof Function?h(l):Uh(l,h))))return!1}if(d.size===
0)return!0;throw new G({code:"bad_request",message:`The following required keys were not supplied: ${Array.from(d).join(", ")}`});};Vh=function(a,b,c){if(Rh(a,b))return!0;throw new G({code:"bad_request",message:`${c||a} must be one of ${b.join(", ")}`});};Wh=function(a){return Nh(a)&&fd.test(a)};
R=function(a,b,c,d=!1){try{if(b(a)||d&&a===void 0)return!0}catch(e){if(e instanceof G)throw e;throw new G({code:"bad_request",message:typeof e==="string"?e:`Error encountered while validating '${a}': ${e}`});}throw new G({code:"bad_request",message:c});};Zh=function(a){return R(a,b=>Sh(b,Xh,Yh),"'UserData' is invalid")};ai=function(a){const {type:b,...c}=$h;R(a,d=>Sh(d,c,{type:b}),"'UserData' is invalid")};bi=function(a){R(a,b=>Sh(b,{},{...Xh,...Yh}),"'UserData' is invalid",!0)};
di=function(a){R(a,b=>Sh(b,{type:c=>Vh(c,["TEXT"],"type"),fontStyle:c=>Vh(c,["italic","normal"],"fontStyle"),decoration:c=>Vh(c,["underline","none"],"decoration"),fontWeight:c=>Vh(c,ci,"fontWeight"),textAlign:c=>Vh(c,["start","center","end","justify"],"textAlign"),children:c=>R(c,d=>{var e=Nh;return Array.isArray(d)&&d.every(e)},'"children must be a string array')},{fontRef:c=>R(c,Wh,"Invalid font reference",!0)}),"'TextDragData' is invalid",!1)};
fi=function(a){const {fullSize:b,...c}=ei;return R(a,d=>Sh(d,c,{fullSize:b}),"'UserData' is invalid")};hi=function(a){return R(a,b=>Sh(b,gi),"'UserData' is invalid")};ii=function(a){const {type:b,resolveVideoRef:c,...d}=ei;R(a,e=>Sh(e,{type:b,resolveVideoRef:c},d),"'UserData' is invalid")};ji=function(a){try{return typeof a==="string"&&(new URL(a)).toString()!=null}catch(b){return!1}};ki=function(a){return a instanceof Function};li=function(a,b){return typeof a==="string"&&(!b||a.length>=b)};
mi=function(a){return typeof a==="number"&&a>0};ni=function(a,b){return b.some(c=>c===a)};pi=function(a){return a!=null&&typeof a==="object"&&oi(a,{width:4,height:4})};
ri=function(a,b){switch(b){case 1:var c;return li(a)&&((c=a.match(/^data:(?:image\/jpeg|image\/png)(?:;base64)?,/))===null||c===void 0?void 0:c.length)===1;case 3:return li(a)&&qi.has(a);case 2:return typeof a==="number";case 0:return li(a);case 4:return mi(a);default:throw new L({code:"bad_request",message:"Invalid validation type"});}};
oi=function(a,b,c){if(typeof a!=="object"||(a===null||a===void 0?void 0:a.constructor)!==Object)return!1;const d=new Set(Object.keys(b)),e=new Set(c?Object.keys(c):[]);for(const f of Object.keys(a)){const g=e.has(f);if(!d.has(f)&&!g)throw new G({code:"bad_request",message:`The following unexpected key was supplied: ${f}`});d.delete(f);const h=b[f]||(c===null||c===void 0?void 0:c[f])||(()=>!1);if(h==null)return!1;const l=a[f];if(!(g&&a[f]===void 0||(h instanceof Function?h(l):ri(l,h))))return!1}if(d.size===
0)return!0;throw new G({code:"bad_request",message:`The following required keys were not supplied: ${Array.from(d).join(", ")}`});};si=function(a,b,c){if(ni(a,b))return!0;throw new G({code:"bad_request",message:`${c||a} must be one of ${b.join(", ")}`});};ti=function(a){return li(a)&&fd.test(a)};
ui=function(a,b,c,d=!1){try{if(b(a)||d&&a===void 0)return!0}catch(e){if(e instanceof G)throw e;throw new G({code:"bad_request",message:typeof e==="string"?e:`Error encountered while validating '${a}': ${e}`});}throw new G({code:"bad_request",message:c});};wi=function(a){const {type:b,...c}=vi;ui(a,d=>oi(d,c,{type:b}),"'UserData' is invalid")};
xi=function(a){ui(a,b=>oi(b,{type:c=>si(c,["text"],"type"),fontStyle:c=>si(c,["italic","normal"],"fontStyle"),decoration:c=>si(c,["underline","none"],"decoration"),fontWeight:c=>si(c,ci,"fontWeight"),textAlign:c=>si(c,["start","center","end","justify"],"textAlign"),children:c=>ui(c,d=>Array.isArray(d)&&d.length>0&&d.every(li),'"children must be a string array')},{fontRef:c=>ui(c,ti,"Invalid font reference",!0)}),"'TextDragData' is invalid",!1)};
zi=function(a){const {fullSize:b,...c}=yi;return ui(a,d=>oi(d,c,{fullSize:b}),"'UserData' is invalid")};Ai=function(a){const {type:b,resolveVideoRef:c,...d}=yi;ui(a,e=>oi(e,{type:b,resolveVideoRef:c},d),"'UserData' is invalid")};Ci=function(a){return ui(a,b=>oi(b,Bi),"'UserData' is invalid")};
Gi=function(a,b){a.handle("DND_V1_RESOLVE_QUEUED_IMAGE",async()=>{const c=await b.Gg();return Di.C(c)});a.handle("DND_V1_RESOLVE_QUEUED_VIDEO",async()=>{const c=await b.Om();return Ei.C(c)});a.handle("DND_V1_RESOLVE_QUEUED_AUDIO",async()=>{const c=await b.Fg();return Fi.C(c)})};Ii=async function(a,b){a=await a.l.request("DND_V2_START_DRAG",Hi.C(b));if(!a.ok)throw a.error;};Ki=async function(a,b){a=await a.l.request("DND_V1_SYNC_DRAG",Ji.C(b));if(!a.ok)throw a.error;};
Li=function(a={}){return((a===null||a===void 0?void 0:a.type)==="IMAGE"||(a===null||a===void 0?void 0:a.type)==null)&&a.resolveImageRef!=null};Mi=async function(a){try{await Kh(a)}catch(b){if(b instanceof G)throw new G({code:b.code,message:`Encountered an error while dragging element: ${b.rawMessage}`});throw new G({code:"internal_error",message:`Encountered an error while dragging element: ${b}`});}};Ni=function(a){switch(a){case "start":case "end":case "center":return a;default:return"start"}};
Pi=async function(a,b,c){b.preventDefault();const d=b.currentTarget;if(d){var e=document.body.style.pointerEvents||"all";document.body.style.pointerEvents="none";var {top:f,left:g,width:h,height:l}=d.getBoundingClientRect();return{zg:await Oi(a,d,c,{$b:{x:b.clientX,y:b.clientY},wc:{x:g,y:f},ec:{width:h,height:l}}),onDragEnd:()=>{document.body.style.pointerEvents=e;const n=new DragEvent("dragend",b);d.dispatchEvent(n)}}}};
Qi=async function(a,b,c){try{a.Jb.start(),await Ii(a.A,b)}finally{a.Jb.stop(),c()}};Ri=async function(a,b,c){try{a.Jb.start(),await a.A.startDragToPoint(b)}finally{a.Jb.stop(),c()}};Si=async function(a,b,c){try{a.Jb.start(),await a.A.startDragToCursor(b)}finally{a.Jb.stop(),c()}};
Oi=async function(a,b,c,d){const e=c===null||c===void 0?void 0:c.type;if(!e||!Ti.includes(e))throw new G({code:"bad_request",message:`Unsupported and/or invalid drag data type: '${c===null||c===void 0?void 0:c.type}'`});switch(e){case "text":return a=await a.ej.fc(b,c),Ui(a,d);case "image":return b=await a.Rh.fc(b,c),a.bg=void 0,a.Yi(b.resolveImageRef),Ui(b,d);case "video":return b=await a.sj.fc(b,c),a.Zi(b.resolveVideoRef),Ui(b,d);case "audio":return b=a.kh.fc(c),a.Wi(b.resolveAudioRef),Ui(b,d);
case "embed":return Ui(c,d);default:throw new L({code:"bad_request",message:`Invalid drag data type: ${e}`});}};
$i=function(a,b,c,d){return async e=>{const f=await d();c.onDragStart(b);a.bg=void 0;try{switch(a.Jb.start(),f.type){case void 0:case "IMAGE":f.resolveImageRef!=null?(a.Yi(f.resolveImageRef),await a.A.startDrag(new Vi({...f,...e}))):await a.A.startDrag(new Wi({...f,...e}));break;case "TEXT":await a.A.startDrag(new Xi({...f,...e}));break;case "VIDEO":a.Zi(f.resolveVideoRef);await a.A.startDrag(new Yi({...f,...e}));break;case "AUDIO":a.Wi(f.resolveAudioRef);await a.A.startDrag(new Zi({...f,...e}));
break;default:throw new L({code:"internal_error",message:`Invalid drag data type: ${f}`});}}finally{a.Jb.stop(),c.onDragEnd(b)}}};aj=function(a){const b=a.type;switch(b){case "IMAGE":return{...a,type:"image",altText:void 0};case "VIDEO":return{...a,type:"video",altText:void 0};default:throw new L({code:"bad_request",message:`Invalid fill type: ${b}`});}};bj=function(a){return a.asset?{...a,asset:aj(a.asset)}:{...a,asset:void 0}};
cj=function(a){const b=a.type;switch(b){case "TEXT":return{...a,type:"text"};case "IMAGE":return{...a,type:"image",altText:a.altText};case "VIDEO":return{...a,type:"video",altText:a.altText};case "EMBED":return{...a,type:"embed"};case "SHAPE":return{...a,type:"shape",paths:a.paths.map(c=>{var d=c.fill;d=d.asset?{...d,asset:aj(d.asset)}:{...d,asset:void 0};return{...c,fill:d}})};case "GROUP":return{...a,type:"group",children:a.children.map(c=>cj(c))};default:throw new L({code:"bad_request",message:`Invalid element type: ${b}`});
}};dj=function(a){switch(a.status){case "completed":return{...a,status:"COMPLETED"};case "aborted":return{...a,status:"ABORTED"};default:throw new L({code:"internal_error",message:"Invalid response."});}};
ej=function(a){return{...a,acceptedFileTypes:a.acceptedFileTypes.map(function(b){switch(b){case "PNG":return"png";case "JPG":return"jpg";case "PDF_STANDARD":return"pdf_standard";case "VIDEO":return"video";case "GIF":return"gif";case "PPTX":return"pptx";case "SVG":return"svg";default:throw new L({code:"failed_precondition",message:`Invalid file type (${b}).`});}})}};
mj=function(a,b,c){const d=new fj(a,new gj(a,c),b,c);a={designInteraction:new hj(a,b,c,"REAL"),dragAndDrop:{startDrag:d.startDrag,startDragToCursor:d.startDragToCursor,startDragToPoint:d.startDragToPoint},export:new ij(a,c)};return{v1:{designInteraction:new jj(a.designInteraction),dragAndDrop:new kj(d),export:new lj(a.export)},design:{v2:a}}};nj=async function(a){a=await a.l.request("DEV_TOOLKIT_V1_SUBSCRIBE_TO_NETWORK_REQUEST_SIMULATION_CHANGE");if(!a.ok)throw a.error;};
pj=function(a,b){gb(a,"DEV_TOOLKIT_V1_SEND_NETWORK_REQUEST_SIMULATION_CONFIG",oj,c=>b.Xm(c))};rj=function(a){a.Yh||(a.Yh=!0,pj(a.l,{Xm:b=>{qj(a,b)}}),nj(a.ma).catch(()=>{}))};sj=function(a,b){a.Jc.add(b);rj(a)};qj=function(a,b){a.Jc.forEach(c=>c(b))};uj=function(a){return a in tj?tj[a]:a};
vj=function(a){return{activities:{registerActivity:(b,c)=>{eb(b==="connect_data","bad_request",`Invalid activity name: ${b}`);a.registerActivity("connect_data",{...c,renderDataTableSelectionUI:d=>c.renderDataTableSelectionUI({...d,updateDataRef:async e=>{try{return await d.updateDataRef(e)}catch(f){if(f instanceof G){if(f.code==="internal_error")return{status:"internal_error"};if(f.code==="bad_request"&&["data_table_limit_exceeded","data_table_invalid_format","metadata_invalid","data_source_title_length_limit_exceeded",
"data_source_ref_limit_exceeded"].includes(f.message))return{status:f.message}}throw f;}}})})}}}};
wj=function(a){return{intents:{v1:{design:{prepareDesignEditor:b=>{a.registerActivity("edit_design",b)},prepareDesignPublisher:b=>{a.registerActivity("design_publisher",b)}},data:{prepareDataConnector:b=>{a.registerActivity("connect_data",{fetchDataTable:c=>b.fetchDataTable!=null?b.fetchDataTable(c):b.getDataTable(c),renderDataTableSelectionUI:c=>b.renderSelectionUi(c)})}},asset:{prepareAssetPicker:b=>{a.registerActivity("asset_picker",b)}}}}}};
xj=function(a){a.$h||(a.$h=!0,Ab(a.l,{Ng:b=>{a.Ng(b)}}),ub(a.ma))};zj=async function(a,b){b=yj.C(b);a=await a.l.request("APP_PROCESS_V1_SET_STATE_CHANGE_SUBSCRIPTION",b);if(!a.ok)throw a.error;};Bj=async function(a,b){b=Aj.C(b);a=await a.l.request("APP_PROCESS_V1_SET_MESSAGE_SUBSCRIPTION",b);if(!a.ok)throw a.error;};Dj=async function(a,b){b=Cj.C(b);a=await a.l.request("APP_PROCESS_V2_SET_STATE_HANDLER",b);if(!a.ok)throw a.error;};
Ij=function(a,b){a.handle("APP_PROCESS_V1_NOTIFY_STATE_CHANGE",async c=>{if(c===void 0)throw new G({code:"internal_error",message:"APP_PROCESS_V1_NOTIFY_STATE_CHANGE:Request can not be undefined"});if(!Ej(c))throw new G({code:"internal_error",message:"Could not convert object into NotifyStateChangeRequest"});var d=c[1];c=c[2];if(d===void 0)throw new G({code:"internal_error",message:"Missing proto payload in NotifyStateChangeRequest"});d=[Fj.F(d),c];await b.Vl(d)});a.handle("APP_PROCESS_V1_RUN_STATE_HANDLER",
async c=>{if(c===void 0)throw new G({code:"internal_error",message:"APP_PROCESS_V1_RUN_STATE_HANDLER:Request can not be undefined"});if(!Ej(c))throw new G({code:"internal_error",message:"Could not convert object into RunStateHandlerRequest"});var d=c[1];c=c[2];if(d===void 0)throw new G({code:"internal_error",message:"Missing proto payload in RunStateHandlerRequest"});d=[Gj.F(d),c];await b.Tm(d)});a.handle("APP_PROCESS_V1_ROUTE_MESSAGE",async c=>{if(c===void 0)throw new G({code:"internal_error",message:"APP_PROCESS_V1_ROUTE_MESSAGE:Request can not be undefined"});
if(!Ej(c))throw new G({code:"internal_error",message:"Could not convert object into RouteMessageRequest"});var d=c[1];c=c[2];if(d===void 0)throw new G({code:"internal_error",message:"Missing sender AppProcessInfo in RouteMessageRequest"});d=[Hj.F(d),c];await b.Sm(d)})};
Jj=function(a){a=a[0].type;switch(a){case "OPENING":return"opening";case "OPEN":return"open";case "CLOSING":return"closing";case "CLOSED":return"closed";case "SUSPENDED":throw Error("unknown app process state");default:throw new L({code:"bad_request",message:`Unknown process state: ${a}`});}};Lj=function(a,b){return{processId:a.processId,launchParams:b,surface:Kj(a.surface)}};
Kj=function(a){switch(a){case 1:case 5:case 3:case 6:case 7:return"object_panel";case 2:return"selected_image_overlay";case 4:return"headless";default:throw new L({code:"bad_request",message:`Unknown proto app surface: ${a}`});}};Mj=function(a){switch(a){case "completed":return 1;case "aborted":return 2;default:throw new L({code:"bad_request",message:`Unknown proto close reason: ${a}`});}};
Nj=function(a){return async function(...b){try{await a(...b)}catch(c){console.error("App error thrown from callback passed to appProcess API: ",c)}}};Qj=async function(a,b,c){const d=await (new Oj(a)).getInfo();return new Pj(a,Lj(...d),b,c)};Rj=function(a,b){a.handle("FEATURE_SUPPORT_V1_SEND_SUPPORT_CHANGE",async()=>b.Zm())};
Tj=async function(a){a=await a.l.request("FEATURE_SUPPORT_V1_GET_UNSUPPORTED_FEATURES");if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"FEATURE_SUPPORT_V1_GET_UNSUPPORTED_FEATURES: Response cannot be empty"});return Sj.F(a.value)};Uj=async function(a){await a.l.request("FEATURE_SUPPORT_V1_SUBSCRIBE_SUPPORT_CHANGE")};Vj=async function(a){await a.l.request("FEATURE_SUPPORT_V1_TRACK_REGISTER_ON_CHANGE")};
Wj=function(a){eb(a.length>0,"bad_request","Arguments to isSupported cannot be empty.");eb(a.every(b=>typeof b==="function"),"bad_request","Every argument to isSupported must be a function")};Xj=async function(a){const b=await Tj(a.ma);a.oj=new Set(b.features)};Zj=async function(a){a=new Yj(a);await Xj(a);return a};bk=function(a,b=0){b="~".repeat(Math.ceil(b/2));return{type:ak.literal,value:a==="left"?"\u1019\u103c"+b:b+"\u1019\u103c"}};
ck=function(a){return a<11?3:a<21?2:a<31?1.8:a<51?1.6:a<71?1.7:1.3};jk=function(a){a=typeof a==="string"?dk(a,{ignoreTag:!1}):a;let b=0;a.forEach(d=>{if(ek(d)){var e=d.value;b+=e.length;const f=ck(e.length);d.value=e.replace(/\S+/gu,(g,h)=>fk(gk(g,f),h))}else if(hk(d)||ik(d))for(e of Object.values(d.options))jk(e.value);else kk(d)&&jk(d.children)});const c=Math.max(1,b*ck(b)*.75-b);return[bk("left",Math.ceil(c/2)),...a,bk("right",Math.ceil(c/2))]};
pk=async function(a,b,c,d,e){c=await Qj(b,c,d);a=new lk(b,a,d);const f=await Zj(b);b=new mk(b,d);return{v1:{platform:new nk(a),appProcess:c},platform:{v2:{platform:a,appProcess:c,i18n:new ok(e,d),features:f,notification:b}},Wh:c,up:f}};qk=function(a){const [b,c,d]=a.split(".").map(Number);return{major:b,minor:c,patch:d}};rk=async function(a,b,c,d){try{await a.A.registerPackageVersion(b,c,d)}catch(e){a.j.G(e,{L:"SDK registration failed"})}};
tk=function(a,b,c,d){return b.includes(c)?{googleAdsAuth:new sk(a,d)}:{}};
uk=function(a){switch(a){case "invalid_client":case "invalid_scope":case "invalid_grant":case "unsupported_response_type":case "unsupported_grant_type":case "unsupported_token_type":case "invalid_request":return"bad_request";case "access_denied":return"permission_denied";case "unauthorized_client":return"not_allowed";case "server_error":case "temporarily_unavailable":case "bad_server_response":case "other_error":return"bad_external_service_response";default:throw new L({code:"internal_error",message:`Invalid OAuth error code ${a}`});
}};vk=function(a){var b;return a!=null&&typeof a==="object"&&((b=Object.getPrototypeOf(a))!==null&&b!==void 0?b:Object.prototype)===Object.prototype};wk=function(a){return Object.values(a).every(b=>typeof b==="string")};yk=function(a){return xk.has(a)};zk=function(a){return Object.entries(a!==null&&a!==void 0?a:{}).map(([b,c])=>({key:b,value:c}))};
Ak=function(a){switch(a){case 1:return"invalid_request";case 2:return"access_denied";case 3:return"unauthorized_client";case 4:return"invalid_client";case 5:return"invalid_scope";case 6:return"invalid_grant";case 7:return"unsupported_response_type";case 8:return"unsupported_grant_type";case 9:return"unsupported_token_type";case 10:return"server_error";case 11:return"temporarily_unavailable";case 12:return"bad_server_response";case 13:return"other_error";default:throw new L({code:"internal_error",
message:`Invalid error code: ${a}`});}};Bk=function(a){const b=a.type;switch(b){case "AUTHENTICATED":return{type:"authenticated"};case "CANCELED":return{type:"canceled"};case "DENIED":return{type:"denied",details:a.details};case "FAILED":return{type:"failed",reason:a.tc==="signature_verification_failed"?{type:a.tc,details:a.Cm}:{type:a.tc}};default:throw new L({code:"internal_error",message:`Unexpected authentication result type: '${b}'.`});}};
Ek=async function(a,b={}){Ck(a.Y,{Hb:"method",Ib:"authenticate",Ob:"requestAuthorization"});a.B("requestAuthentication");if(b!=null&&typeof b!=="object")throw new G({code:"bad_request",message:`Invalid authentication request. Expected an object but received '${typeof b}'.`});var c=b.context;if(c!=null){if(typeof c!=="string")throw new G({code:"bad_request",message:`Invalid authentication context. Expected a string but received '${typeof c}'.`});if(!(c.length<=32))throw new G({code:"bad_request",message:`Authentication context can be at most '${32}' characters. Received context of length '${c.length}'.`});
}try{const e=await a.A.authenticate(new Dk(b)),f=Bk(e);a:{const g=f.type;switch(g){case "authenticated":var d={status:"COMPLETED"};break a;case "canceled":d={status:"ABORTED"};break a;case "denied":d={status:"DENIED",details:f.details};break a;case "failed":const h=f.reason.type;switch(h){case "invalid_context":throw new G({code:"bad_request",message:"Invalid authentication context provided."});case "invalid_options":throw new G({code:"bad_request",message:"Invalid authentication request."});case "invalid_redirect_parameters":throw new G({code:"bad_external_service_response",
message:"Invalid redirect parameters received from app backend."});case "invalid_redirect_url":throw new G({code:"failed_precondition",message:"Invalid redirect URL received. Please make sure a valid redirect URL has been provided via the developer portal."});case "offline":throw new G({code:"user_offline",message:"Unable to authenticate user as they are offline."});case "popup_is_not_available":throw new G({code:"permission_denied",message:"Unable to open popup dialog as it was blocked either by the user or their browser."});
case "signature_verification_failed":throw new G({code:"internal_error",message:"Signature verification is no longer supported. If issue persists please report to Canva."});case "get_connection_status_failed":throw new G({code:"internal_error",message:"Something went wrong while authenticating."});case "fetch_redirect_url_failed":throw new G({code:"internal_error",message:"Something went wrong while authenticating."});case "unknown":throw new G({code:"internal_error",message:"Something went wrong while authenticating."});
default:throw new L({code:"internal_error",message:`Unexpected auth failure reason type: '${h}'.`});}default:throw new L({code:"internal_error",message:`Unexpected auth result: '${g}'.`});}d=void 0}return d}catch(e){if(e instanceof G)throw e;throw new G({code:"internal_error",message:`Something unexpected happened while authenticating: ${e instanceof Error?e.message:e}`});}};
Fk=function(a){switch(a){case "generate_image":return 9;case "generate_video":return 10;case "generate_audio":return 11;case "generate_text":return 12;case "modify_image":return 1;case "modify_video":return 2;case "modify_audio":return 3;case "modify_text":return 4;case "import_image":return 5;case "import_video":return 6;case "import_audio":return 7;case "import_text":return 8;default:throw new L({code:"bad_request",message:`Unknown billable action: ${a}`});}};
Qk=function(a){return{rn(b){return hb(a,"MONETIZATION_V1_START_TRACKING_SESSION",Gk,b,Hk)},Pm(b){return hb(a,"MONETIZATION_V1_RESUME_TRACKING_SESSION",Ik,b,Jk)},closeTrackingSession(b){return hb(a,"MONETIZATION_V1_CLOSE_TRACKING_SESSION",Kk,b,Lk)},isEnabled(b){return hb(a,"MONETIZATION_V1_IS_ENABLED",Mk,b,Nk)},requestEnableBillableAction(b){return hb(a,"MONETIZATION_V1_REQUEST_ENABLE_BILLABLE_ACTION",Ok,b,Pk)}}};
Wk=async function(a,b,c){var d;try{var e=await (new Rk(a)).getInfo()}catch(f){}e=new Sk(a,e===null||e===void 0?void 0:(d=e.authentication)===null||d===void 0?void 0:d.Fn,b,c);a={authentication:{getCanvaUserToken:e.getCanvaUserToken,getUserCapabilitiesToken:e.getUserCapabilitiesToken,requestUpgrade:e.requestUpgrade,getUserInfo:e.getUserInfo,initOauth:e.initOauth},monetization:new Tk(a,b,c),OauthError:Uk};return{v1:{authentication:new Vk(e)},user:{v2:a}}};
Ck=function(a,{Hb:b,Ib:c,Ob:d}){console.warn(`${"Apps SDK"}: The "${c}" ${b} is deprecated. Instead, use "${d}".`);yb(a.Ee,new xb({Hb:b,Ib:c,Ob:d})).catch(e=>a.j.G(`Encountered an error while registering unstable api usage: ${e}`))};Xk=function(a,b){a.Ad("experimental",b)};$k=function(a){return{Ni(b){return hb(a,"ACTIVITIES_V1_REPORT_ACTIVITY_REGISTRATION",Yk,b)},Si(b){return hb(a,"ACTIVITIES_V1_SEND_ACTION_RESULT",Zk,b)}}};
cl=async function(a,b,c){try{const d=K(a.im[b],"internal_error",'Unknown message "{}"',b),e=K(a.l,"internal_error","IntentMessenger is not connected"),f=d.eb,g=await e.send(b,al(c,d.cb));return bl(g,f)}catch(d){throw a.j.G(d,{L:"Error sending message",tags:new Map([["message",String(b)]])}),d;}};al=function(a,b){if(b)return eb(!!a,"internal_error","Can not serialize empty message payload"),JSON.stringify(b.C(a))};
bl=function(a,b){if(b)return eb(!!a,"internal_error","Can not deserialize empty message payload"),b.F(JSON.parse(a))};
kl=function(a,b,c,d){const e=$k(a),f=new Map;gb(a,"ACTIVITIES_V1_ABORT_ACTION",dl,g=>{g=f.get(g.Ka);g===null||g===void 0||g.abort(Error("Action aborted by consumer"))});gb(a,"ACTIVITIES_V1_INVOKE_ACTION",el,g=>{const h=g.Ka,l=g.Aj,n=g.xj;var r=ma(c[l]);const t=ma(r[n]);r=t.config.cb;const w=t.config.eb,x=d.Nc(`${l}_${n}`);x.setTag("intent_name",l);x.setTag("action_name",n);const F=new AbortController;f.set(h,F);F.signal.addEventListener("abort",()=>f.delete(h),{once:!0});const H=async I=>{if(f.has(h)){f.delete(h);
var O=I.ok?void 0:I.error;if(I.ok)try{await e.Si(new fl({Ka:h,sb:al(I.value,w)}));return}catch(N){O=N,x.G(N,{L:"Error sending action result"})}if(O){console.error(O);try{await e.Si(new gl({Ka:h}))}catch(N){console.error(N)}}}};g=bl(g.sb,r);r=t.run;r((...I)=>hl(b,l,n,...I),{params:g,signal:F.signal,j:x,Hf:I=>{I=new il(t.config.Eb,t.config.Mb,I,x);jl(I,a,h,F.signal);return I}},H).catch(I=>H(q(I)))})};
jl=function(a,b,c,d){gb(b,"ACTIVITIES_V1_ACTION_MESSAGE",ll,async e=>{const f=await a.Qc(e.ji,e.sb);return new ml({Ka:e.Ka,sb:f})},ml);a.connect({send:async(e,f)=>{if(d.aborted)throw d.reason;e=new ll({Ka:c,ji:String(e),sb:f});return(await hb(b,"ACTIVITIES_V1_ACTION_MESSAGE",ll,e,ml)).sb}})};
hl=function(a,b,c,...d){var e,f;ia(nl(a,b,c),"App Intent or action {}::{} is not registered",b,c);var g;return(g=(f=a.Fc[b])===null||f===void 0?void 0:(e=f[c])===null||e===void 0?void 0:e.call(f,...d))!==null&&g!==void 0?g:void 0};nl=function(a,b,c){return b in a.Fc&&c in a.Fc[b]&&typeof a.Fc[b][c]==="function"};
pl=async function(a){var b=await a.ih.load();if(b.type!=="SUCCESS")return await a.hh.Ni({Li:[]}),b;try{await a.hh.Ni(new Yk({Li:Object.entries(a.Fc).map(([c,d])=>new ol({name:c,actions:Object.keys(d)}))}))}catch(c){a.j.G(c,{L:"Error reporting registered activities"})}return a.xf&&a.xf.Kh.length>0&&(b=a.xf.Kh.map(c=>({yj:c.name,actions:c.actions.filter(d=>!nl(a,c.name,d))})).filter(c=>c.actions.length>0),b.length)?{type:"MISSING_ACTIONS",Pl:b.flatMap(({yj:c,actions:d})=>d.map(e=>`${c}:${e}`))}:{type:"SUCCESS"}};
ql=function(){return(a,b,c)=>{a={};for(const d in c)a[d]={run:c[d],config:b[d]};return a}};rl=function(){return(a,b)=>b};
wl=function(a){switch(a.type){case "container":return new sl({id:a.id,name:a.name});case "image":return new tl({name:a.name,url:a.url,mimeType:a.mimeType,thumbnailUrl:a.thumbnailUrl,parentRef:a.parentRef});case "video":return new ul({name:a.name,url:a.url,mimeType:a.mimeType,thumbnailImageUrl:a.thumbnailImageUrl,parentRef:a.parentRef});case "audio":return new vl({name:a.name,url:a.url,mimeType:a.mimeType});default:throw new m(a);}};
xl=function(a){switch(a){case 1:return"container";case 2:return"image";case 3:return"video";case 4:return"audio";default:throw new m(a);}};zl=function(a,b){return new yl(b(a.le),b(a.Ve),a.Db,a.Rb)};Al=function(a,b){return new yl(a,b,!1,!1)};Bl=function(a,b){a.Db||(a.Db=b.Db);a.Rb||(a.Rb=b.Rb);return b};Cl=function(a,b=!0){a.Db||(a.Db=b)};Dl=function(a,b=!0){a.Rb||(a.Rb=b)};El=function(a,b){if(a.clients){for(const c of a.clients.keys())try{c.error(b)}catch(d){}a.clients=void 0}};
Fl=function(a,b){ia(a.S!=null);if(a.clients){var c=!1;for(const d of a.clients.keys())try{d.next(b)}catch(e){try{d.error(`could not publish to incoming: ${e}`)}catch(f){}a.clients.delete(d);c=!0}c&&!a.clients.size&&(a.clients=void 0)}};Il=function(a,b,c,d){var e={yk:!1};return(e===null||e===void 0?0:e.yk)?new Gl(a,b,c,d):new Hl(a,b,c,d)};Jl=function(a){a.Me&&(a.Me.reportChanged(),a.Me=void 0)};Kl=function(a,b){const c=new Map;for(const [d,e]of a)c.set(d,b(e,d));return c};
Ll=function(a){return a.filter(()=>!0)};Ml=function(a,b){k(Object.getPrototypeOf(a)===Object.prototype);const c={};for(const d in a)c[d]=b(a[d],d);return c};Pl=function(a,b){return a===Nl?b:b===Nl?a:new Ol(a,b)};Ql=function(a,b){return b===Nl?Nl:new a(b)};Rl=function(a){const b=Ia(c=>a(c));return c=>c!=null&&typeof c==="object"?b(c):a(c)};Tl=function(a,b){k(Number.isSafeInteger(a)&&Number.isSafeInteger(b)&&a<=b);return new Sl(c=>Number.isSafeInteger(c)&&a<=c&&c<=b)};
Xl=function(a){a instanceof Ul?Ql(Vl,a.serializer):new Wl(a,Ql(Vl,a.Ah),Ql(Vl,a.bj))};bm=function(a,b){const c={};let d=Yl.get(a);d||Yl.set(a,d={});for(const [e,f]of Object.entries(b)){if(b=f){b=d;if(e in b){if(b[e]!==f)throw new Zl(`Can not apply a different decorator to the already decorated ${e} property. Check the parent class decorator is the same.`);b=!0}else b[e]=f,b=!1;b=!b&&!$l(a,e,f)}b&&(e in a||Object.defineProperty(a,e,{configurable:!0}),c[e]=f)}am(a,c)};
$l=function(a,b,c){if(c!==cm&&c!==cm.bound)return!1;let d=dm(a,c,a[b]);Object.defineProperty(a,b,{get(){return d},set(e){d=dm(a,c,e)},configurable:!em().safeDescriptors});return!0};dm=function(a,b,c){return typeof c!=="function"?c:(c===null||c===void 0?0:c.Mn)?c:b===cm.bound?cm(c.bind(a)):cm(c)};fm=function(a,b){return a?b?(...c)=>{a(...c);b(...c)}:a:b};gm=function(a,b){a=a.length;k(0<=b&&b<a,"{} \u2209 [0, {})",b,a)};hm=function(a,b){a=a.length;k(0<b&&b<a,"{} \u2209 (0, {})",b,a)};
im=function(a,b){b&&(a.fb(0),a.Od+=b);return a};jm=function(a,b){b>0&&(a.fb(2),a.Pd+=b);return a};km=function(a,b){return a?b?{D:fm(a.D,b.D),item:fm(a.item,b.item),Z:fm(a.Z,b.Z)}:a:b};lm=function(a,b,c){a.move(b,!0,c)};mm=function(a,b){a=a.ob;k(0<b&&b<a,"{} \u2209 (0, {})",0,a)};
nm=function(a,b,c){switch(b.type){case 0:case 1:switch(c.type){case 0:case 1:return a.Cb(b.state,c.state);case 2:return a.Ae(b.state);default:throw new m(c);}case 2:switch(c.type){case 0:case 1:return a.pj(c.state);case 2:return b=b.state,k(b>=0),b&&(a.fb(3,2,2),a.acc+=b),a;default:throw new m(c);}default:throw new m(b);}};om=function(a){const b=ma(a.U);a.U=a.H[a.i++];return b};pm=function(a,b){const c=ma(a.U),d=c.ob;k(0<b&&b<=d);if(b<d){const [e,f]=c.bf(b);a.U=f;return e}a.U=a.H[a.i++];return c};
sm=function(a,b,c){switch(c.type){case 0:return b;case 1:return k(b.type===1),new qm(a.component.apply(b.state,c.delta));case 3:var d=c.oldState;k(rm(a,b,d),"{} != {}",b,d);return c.newState;default:throw new m(c);}};rm=function(a,b,c){switch(b.type){case 0:return c.type===0&&b.state===c.state;case 1:return c.type===1&&a.component.ja(b.state,c.state);case 2:return c.type===2&&b.state===c.state;default:throw new m(b);}};
vm=function(a,b){const c=tm.dc(),d=a.cursor(0,{...um,Z:g=>c.I(g)}),e={...um,D:g=>c.I(g.length)},f={...um,D:g=>c.Ae(g)};b.forEach({I:g=>{d.move(g,!1,e)},delete:g=>{d.move(g,!1,f)},insert:g=>c.insert(g)});return c.build()};
xm=function(a,b){const c=new wm,d=a.cursor();a=h=>{throw Error(String(h));};const e={...um,D:h=>c.I(h.length)},f={...um,D:a},g={...um,D:()=>0,Z:a};b.forEach({I:h=>lm(d,h,e),update:h=>{throw new m(h);},insert:h=>h.type!==2&&c.insert(h.state),Cb:(h,l)=>{h.type===2?(lm(d,h.length,f),l.type!==2&&c.insert(l.state)):(lm(d,h.length,g),l.type===2?c.delete(h.length):(k(h.state===l.state,"non-reflexive change: {} != {}",h,l),c.I(h.length)))}});return c.build()};
ym=function(a,b){k(Object.getPrototypeOf(a)===Object.prototype);const c={};for(const d in a)c[d]=b(a[d],d);return c};Am=function(a,b,c){return new zm({...a,...b,...c})};Bm=function(...a){const b=new Set;for(const c of a)for(const d in c)k(!b.has(d),'duplicate key: "{}"',d),b.add(d)};
Cm=function(a){if(a.computed==null)return{J:{},attributes:{}};const {J:b,attributes:c,Tc:d}=a.computed.create({...a.values,...a.J,...a.attributes});return{J:Ml(a.computed.J,(e,f)=>b[f]),attributes:Ml(a.computed.attributes,(e,f)=>c[f]),Tc:d}};
Dm=function(a,b){if(!a)return b;if(!b)return a;const c=a.create,d=b.create;return{J:{...a.J,...b.J},attributes:{...a.attributes,...b.attributes},create:e=>{const {J:f,attributes:g,Tc:h}=c(e),{J:l,attributes:n,Tc:r}=d({...e,...f,...g});return{J:{...f,...l},attributes:{...g,...n},Tc:h&&r?()=>{h();r()}:h||r}}}};Em=function(a,b,c){for(const [d,e]of Object.entries(a))c(d,e,b[d])};Fm=function(a,b){return{type:0,ha:a,ua:b}};Gm=function(a){return{type:1,length:a}};
Im=function(a){const b=a.U;if(!b||b.type===1)return Hm;a.U=a.input[a.i++];a.apply(b);return b};Km=function(a){if(a instanceof Jm)return a;if(Array.isArray(a)){const [b,c]=a;return new Jm(b,c)}return new Jm(a.from,a.to)};Lm=function(a,b){return a?!!b&&a.from===b.from&&a.to===b.to:!b};Mm=function(a,b){let c=0,d=0;for(const e of a.jd)switch(a=e.length,e.type){case 0:b.I&&b.I(a,c,d);c+=a;d+=a;break;case 1:b.insert&&b.insert(a,c,d);d+=a;break;default:throw new m(e.type);}};
Nm=function(a,b){b.forEach((c,d)=>a.ranges.set(d,c));return a};Pm=function(a,b,c){const d=ma(a._next);ia(d.type===b,"{} != {}",d.type,b);k(0<c&&c<=d.length,"{} \u2209 ({}, {}]",c,0,d.length);a._next=c<d.length?new Om(b,d.length-c):a.i<a.input.length?a.input[a.i++]:void 0};Qm=function(a,b){Pm(a,0,b);a.be+=b;a.Ab+=b};Rm=function(a,b,c){let {from:d,to:e}=a;d+=d>b?c:0;e+=e>b?c:0;return a.from!==d||a.to!==e?new Jm(d,e):a};
Tm=function(a,b,c,d){for(const [e,f]of a){const g=f.Kd,h=f.Hd,l=g&&(b!=null?Rm(g,b,d):g),n=h&&(c!=null?Rm(h,c,d):h);l===g&&n===h||a.set(e,new Sm(l,n))}};Um=function(a,b){return a.size?b.size?new Set([...a.keys(),...b.keys()]):a.keys():b.keys()};Vm=function(a,b){return a===b||a.size===b.size&&Array.from(a.keys()).every(c=>a.get(c)===b.get(c))};Wm=function(a,b){const c=new Map;for(const [d,e]of a)b(e)&&c.set(d,e);return c};
Xm=function(a,{min:b,max:c}){return typeof a==="number"&&Number.isFinite(a)&&a>=b&&a<=c&&(Math.abs(a)>=2.2250738585072014E-308||Object.is(a,0))};Ym=function(a,{max:b}){return typeof a==="string"&&a.length<=b};
fn=function(a){switch(a.status){case "completed":try{var b,c;return new Zm({dataTable:$m(a.dataTable),metadata:new an({description:(b=a.metadata)===null||b===void 0?void 0:b.description,providerInfo:((c=a.metadata)===null||c===void 0?0:c.providerInfo)?{name:a.metadata.providerInfo.name,url:a.metadata.providerInfo.url||void 0}:void 0})})}catch(d){return new bn}case "outdated_source_ref":return new cn;case "remote_request_failed":return new dn;case "app_error":return new en({message:a.message});default:throw new m(a);
}};gn=function(a){switch(a.type){case "DATA_SELECTION":return{reason:"data_selection",dataSourceRef:a.dataSourceRef};case "OUTDATED_SOURCE_REF":return{reason:"outdated_source_ref",dataSourceRef:a.dataSourceRef};case "APP_ERROR":return{reason:"app_error",message:a.message,dataSourceRef:a.dataSourceRef};default:throw new m(a);}};
hn=function(a){switch(a.type){case "COMPLETED":return{status:"completed"};case "APP_ERROR":return{status:"app_error",message:a.message};case "OUTDATED_REF":return{status:"outdated_source_ref"};case "REQUEST_FAILED":return{status:"remote_request_failed"};case "LIMIT_EXCEEDED":throw new G({code:"bad_request",message:"data_table_limit_exceeded"});case "INVALID_FORMAT":throw new G({code:"bad_request",message:"data_table_invalid_format"});case "INVALID_METADATA":throw new G({code:"bad_request",message:"metadata_invalid"});
case "ABORTED":case "FETCH_ERROR":case "INTERNAL_ERROR":throw new G({code:"internal_error",message:"internal_error"});default:throw new m(a);}};
$m=function(a){return{Tj:a.columnConfigs?a.columnConfigs.map(b=>new jn({name:b.name,type:b.type})):[],rows:a.rows.map(b=>({cells:b.cells.map(c=>{switch(c.type){case "date":return new kn({value:c.value});case "number":var d;const e=new ln({formatting:(d=c.metadata)===null||d===void 0?void 0:d.formatting});return new mn({value:c.value,metadata:e});case "string":return new nn({value:c.value});case "boolean":return new on({value:c.value});case "media":return new pn({value:c.value.map(f=>{switch(f.type){case "image_upload":return new qn(f);
case "video_upload":return new rn(f);default:throw new m(f);}})});default:throw new m(c);}})}))}};un=function(a){a=a.split(".");if(a.length>1){const b=a.pop();if(!b||!sn.test(b))return!1}return a.every(b=>tn.test(b))};
zn=function(a,b){try{if(!Array.isArray(a.rows))return q({code:"invalid_format",reason:"Rows property on the data table is not an array"});if(a.rows.length>b.row)return q({code:"exceeded_limit",reason:`The number of rows exceeds the limit, which is ${b.row}. The number of rows is ${a.rows.length}.`});const {Tl:g,gl:h}=vn(a);if(h>b.media.hi)return q({code:"exceeded_limit",reason:`The number of images exceeds the limit, which is ${b.media.hi}. The number of images is ${h}.`});try{var c=wn(g);if(c>b.size)return q({code:"exceeded_limit",
reason:`The data table size in bytes exceeds the maximum allowed size. The table size is ${c}, while the limit is ${b.size}`})}catch(n){return q({code:"invalid_format",reason:`The data table is not serializable. The data table's serialization threw error "${n}"`})}c=-1;let l=0;for(let n=0;n<a.rows.length;n++){const r=a.rows[n];l=Math.max(l,r.cells.length);if(!Array.isArray(r.cells))return q({code:"invalid_format",reason:`Cells property is not an array on the row ${n}`});const t=r.cells.length;c<0&&
(c=t);if(t!==c)return q({code:"invalid_format",reason:`The number of columns is not consistent between rows. On row ${n} the number of columns is ${t}, while on the previous ones it is ${c}`});if(t>b.column)return q({code:"exceeded_limit",reason:`The number of columns exceeds the limit, which is ${b.column}. The number of columns is ${t}.`});for(let w=0;w<r.cells.length;w++){var d;const x=r.cells[w],F=(d=a.columnConfigs)===null||d===void 0?void 0:d[w];if(F){const H=F.type;if(H!=="variant"&&H!==x.type)return q({code:"invalid_format",
reason:`Cell type mismatch: expected "${H}" for column ${w}, but found "${x.type}" in row ${n}, cell ${w}.`})}if(x.type==="media")try{xn(x,b);break}catch(H){let I=String(H);H instanceof G&&(I=H.message);return q({code:"invalid_format",reason:`Invalid cell with type "${x.type}", row ${n}, cell ${w}: ${I}`})}if(!yn(x,b)){var e=x.type;const H=String(x.value);var f=H.length<=100?H:`${H.slice(0,20)}...${H.slice(-20)}`;return q({code:"invalid_format",reason:`Invalid cell with type "${e}" and value "${f}". Row ${n}, cell ${w}`})}}}return a.columnConfigs&&
l!==a.columnConfigs.length?q({code:"invalid_format",reason:`The number of column configs does not match the number of columns. The number of column configs is ${a.columnConfigs.length}, while the number of columns is ${l}`}):p()}catch(g){return q({code:"invalid_format",reason:`The following error occurred while validating the table: "${g}"`})}};
yn=function({type:a,value:b},c){switch(a){case "date":return b==null||Xm(b,c.number)&&!isNaN((new Date(b*1E3)).getTime());case "number":return b==null||Xm(b,c.number);case "string":return b==null||Ym(b,c.string);case "boolean":return b==null||typeof b==="boolean";default:throw new L({code:"bad_request",message:`Invalid table cell type "${a}".`});}};
xn=function({value:a},b){if(a.length>b.media.qh)throw new G({code:"bad_request",message:`Media cell cannot have more than ${b.media.qh} items`});for(b=0;b<a.length;b++)try{const c=a[b];switch(c.type){case "image_upload":An({...c,type:"image"});break;case "video_upload":An({...c,type:"video"});break;default:throw new L({code:"bad_request",message:"Invalid item type."});}}catch(c){throw a=String(c),c instanceof G&&(a=c.message),new G({code:"bad_request",message:`Invalid media item at ${b}: ${a}`});
}};
Fn=function(a){var b,c;if(a.description&&!Ym(a.description,{max:Bn.description}))return q({code:"value_exceeded_limit",reason:`The description length exceeded limit. The limit is ${Bn.description}`});if(((b=a.providerInfo)===null||b===void 0?0:b.name)&&!Ym(a.providerInfo.name,{max:Bn.providerInfo.name}))return q({code:"value_exceeded_limit",reason:`The provider info name length exceeded limit. The limit is ${Bn.providerInfo.name}`});if(a=(c=a.providerInfo)===null||c===void 0?void 0:c.url){if(!Ym(a,{max:Bn.providerInfo.url}))return q({code:"value_exceeded_limit",
reason:`The provider info url length exceeded limit. The limit is ${Bn.providerInfo.url}`});a:{try{if(!a.startsWith("#page-")){if(!Cn.test(a))throw new G({code:"bad_request",message:"Invalid URL"});b:{const f=decodeURIComponent(a);for(const g of Dn)if(g.test(f)){var d=!0;break b}d=!1}if(d)throw new G({code:"bad_request",message:"Invalid URL"});try{var e=new URL(a)}catch(f){throw new G({code:"bad_request",message:"Invalid URL"});}if(!En.test(e.protocol)){if(e.pathname.includes("[")||e.pathname.includes("]"))throw new G({code:"bad_request",
message:"URL may not contain [ or ]"});if(!(e.hash.split("#").length<=2))throw new G({code:"bad_request",message:"Invalid URL hash"});if(!un(e.hostname))throw new G({code:"bad_request",message:"Invalid URL domain"});}}}catch(f){c=!1;break a}c=!0}if(!c)return q({code:"invalid_provider_url",reason:`The provider info url is not valid. The url is ${a}`})}return p()};wn=function(a){return(new TextEncoder).encode(JSON.stringify(a)).length};
vn=function(a){let b=0;return{Tl:{...a,rows:a.rows.map(c=>({...c,cells:c.cells.map(d=>{if(d.type!=="media")return d;b+=d.value.length;return{type:"media",value:[]}})}))},gl:b}};Gn=function(a){return a.replace(/./g,b=>b.charCodeAt(0).toString(2).padStart(8,"0")).replace(/0/g,"\u2062").replace(/1/g,"\u2064")};
Mn=function(a,b){var c=Hn(),d=In,e={};for(var f=0;f<b.length;++f)e[f]=b[f];b=c+"-"+a;if(f=Jn.get(b))return e=f.format(e),Kn?"\u2062"+e+Gn(a):e;f=(f=Ln[c])&&f[a];f==null&&(f=void 0);if(f==null)throw Error(`Could not find string for ${c} ${a}`);c=d(f,c);Jn.set(b,c);e=c.format(e);return Kn?"\u2062"+e+Gn(a):e};Nn=function(a){var b=Hn(),c=Ln[b];c=c&&c[a];c==null&&(c=void 0);if(c==null)throw Error(`Could not find string for ${b} ${a}`);return Kn?"\u2062"+c+Gn(a):c};
In=function(a,b){switch(b){case "en-psaccent":b="en";break;case "ar":case "ar-AE":case "ar-EG":case "ar-SA":case "fa-IR":case "he-IL":case "pa-PK":case "ur-PK":case "ckb-IQ":case "ug-CN":b=`${b}-u-nu-latn`}try{On.resolveLocale(b)}catch(c){b=On.defaultLocale}return new On(a,b,Pn,{ignoreTag:!0})};
Qn=function(a,b){var c=document.getElementById("errorMessageBox");c?c.textContent=b:(c=document.createElement("p"),c.id="errorMessageBox",c.style.color=a.theme==="light"?"black":"white",c.style.fontFamily='"Canva Sans", Helvetica, sans-serif',c.style.fontSize="14px",c.style.whiteSpace="break-spaces",c.textContent=b,document.body.prepend(c))};Rn=function(a,b,c){const d=Object.getOwnPropertyDescriptor(a,b);Object.defineProperty(a,b,{...d,value:c,configurable:!1})};Sn=function(a,b){a[b]&&delete a[b]};
Xn=function(a){let b;try{b=decodeURIComponent(a)}catch(c){return a}return Tn.test(b)?":uuid":Un.test(b)?":email":b.includes("@")?"REDACTED":Vn.test(b)?":digits":Wn.test(b)?"uri:REDACTED":a};Yn=function(a){try{return(new URL(a)).pathname}catch(b){return""}};Zn=function(a){return a?a.split("/").map(Xn).join("/"):a};
co=function(a){const b=window.fetch,c=async(...d)=>{a:{try{var [e]=d;var f=($n(e)?e.url:e).toString();break a}catch(n){}f=void 0}if(f)try{var g=(new URL(f)).hostname}catch(n){g="unknown"}else g="unknown";e=f?Zn(Yn(f)):"/unknown";g=ao(1,a,{hostname:g,path:e});g.start();try{const n=await b(...d);const [r,t]=d;var h=$n(r)?r.body:(t===null||t===void 0?void 0:t.body)||null;const [w,x]=d;var l=$n(w)?w.method:(x===null||x===void 0?void 0:x.method)||"GET";g.complete(a,n.status);f&&a.Eh.track({requestUrl:f,
Qa:h,na:n.status,Ha:l});return n}catch(n){throw g.complete(a,499),n;}};Rn(window,"fetch",async(d,e)=>{var f;const {Pg:g,Qg:h}=((f=a.ye)===null||f===void 0?void 0:f.hg)||{};if(g){let l;(e===null||e===void 0?0:e.signal)?l=e.signal:d instanceof Request&&d.signal&&(l=d.signal);await new Promise((n,r)=>{function t(){clearTimeout(w);r(new DOMException("Aborted","AbortError"))}const w=setTimeout(()=>{l===null||l===void 0||l.removeEventListener("abort",t);n()},g);l===null||l===void 0||l.addEventListener("abort",
t)})}return h?new Response(null,{status:h,statusText:bo(h)}):c(d,e)})};
eo=function(a){const b=window.XMLHttpRequest;class c extends b{open(d,e,f,g,h){this.url=e;this.method=d;try{this.hostname=(new URL(e)).hostname}catch(l){this.hostname="unknown"}super.open(d,e,f,g,h)}async send(d){var e,f;const {Pg:g,Qg:h}=((e=a.ye)===null||e===void 0?void 0:e.hg)||{};if(g){const n=this.abort;await new Promise((r,t)=>{const w=setTimeout(()=>{this.abort=n;r()},g);this.abort=()=>{clearTimeout(w);t();n.call(this)}})}if(h)Object.defineProperty(this,"status",{value:h}),Object.defineProperty(this,
"statusText",{value:bo(h)}),Object.defineProperty(this,"response",{value:""}),Object.defineProperty(this,"responseText",{value:""}),Object.defineProperty(this,"readyState",{value:c.DONE}),this.dispatchEvent(new ProgressEvent("readystatechange")),this.dispatchEvent(new ProgressEvent("loadend"));else{e=typeof this.url==="string"?this.url:((f=this.url)===null||f===void 0?void 0:f.toString())||"";f=Zn(Yn(e));var l=ao(2,a,{hostname:this.hostname,path:f});l.start();this.addEventListener("loadend",()=>{var n;
l.complete(a,this.status);a.Eh.track({requestUrl:((n=this.url)===null||n===void 0?void 0:n.toString())||"",Qa:d||null,na:this.status,Ha:this.method||"GET"})});super.send(d)}}}Rn(window,"XMLHttpRequest",c)};ao=function(a,b,c){return new fo(a,b,c)};$n=function(a){return!!a&&typeof a==="object"&&!(a instanceof URL)};
bo=function(a){return{100:"Continue",200:"OK",201:"Created",204:"No Content",301:"Moved Permanently",302:"Found",304:"Not Modified",400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",408:"Request Timeout",429:"Too Many Requests",500:"Internal Server Error",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"}[a]||"Unknown Status"};go=function(a){var b=window;b.addEventListener("click",()=>{pb(a)},{capture:!0});b.addEventListener("keydown",()=>{rb(a)},{capture:!0})};
ho=function(){var a=location;const b=()=>{console.error("Navigation blocked. Please refer to our Design Guidelines for external links:\nhttps://www.canva.dev/docs/apps/design-guidelines/external-links/")};window.addEventListener("click",c=>{try{if(c.target instanceof HTMLAnchorElement){const d=new URL(c.target.href);d.origin!==a.origin?(c.preventDefault(),b()):d.pathname!==a.pathname&&b()}}catch(d){}},{capture:!0})};
io=function(a,b){const c=HTMLMediaElement.prototype.play;Rn(HTMLMediaElement.prototype,"play",function(){return a.state==="suspended"?(b.info(Nn("YfcEnQ")),Promise.reject(new G({code:"not_allowed",message:Nn("YfcEnQ")}))):c.call(this)})};no=async function({Ee:a,yf:b,j:c,Sa:d,appId:e,appName:f,Da:g,Ic:h,pd:l,ye:n}){jo({pd:l,window});d={j:c,ma:a,Sa:d,appId:e,appName:f,Da:g,Ic:h,Eh:new ko(e,a,c),ye:n};co(d);eo(d);lo();go(a);ho();io(new mo(b),c)};
oo=function(a,b){for(const c in b){if(c in a)throw Error(`field '${c}' already defined`);const d=Object.freeze(b[c]);Object.defineProperty(a,c,{get(){return d},configurable:!1,enumerable:!1})}};
yo=async function({Kj:a,l:b,j:c,sc:d,wm:e,Hg:f,window:g,i18n:h,ih:l=new po(d.ge)}){const n=new Rk(b);try{var r;const x=new qo(n,c),F=await pk(e.platform.rm,b,x,c,h);let H;try{H=new ro(b,c)}catch(Ja){}await no({Ee:n,j:c,Sa:a,appId:d.appId,appName:d.appName,Da:d.Da,Ic:d.Ic,pd:d.pd,yf:F.Wh,ye:H});const I=await Wk(b,x,c),O=mj(b,x,c),N=gc(b,x,c,d.Ec),ja=new so(b,c),qa=new to(l,c,b,(r=e.activities)===null||r===void 0?void 0:r.zj);var t={...vj(qa)},w={...I.v1};uo=uj;const za={canva:{...t,...w,CanvaError:G,
...O.v1,...N.v1,...F.v1,generation:ja},canva_sdk:{error:{v2:{CanvaError:G}},asset:N.asset,design:O.design,...wj(qa),platform:F.platform,user:I.user,generation:{v2:{generation:ja}}},__canva__:{uiKit:new vo(b,c),...tk(b,d.Yk,d.appId,c),sdkRegistration:new wo(c,b),context:{locale:d.locale,country:d.country}}};a=()=>{};za.canva.fetch={get:a,post:a};oo(g,za);let U;try{U=(await za.__canva__.uiKit.getUiContext()).theme}catch(Ja){U="dark"}return{sdk:za,Fk:new xo(d.Da,c,U),El:()=>pl(qa),yf:F.Wh}}catch(x){throw c.md(x,
{L:"failed to initialise sdk"}),console.error("failed to initialise sdk"),f.Ua().addEvent("init_sdk_failed"),x;}};
Bo=async function({j:a,window:b=zo,deleteDatabase:c=Ao}){async function d(f,g){try{return await g()}catch(h){h instanceof DOMException&&f.includes(h.name)||a.ad(h,{L:"Failed to clear site data"})}}if((new URLSearchParams(b.location.search)).get("clearSiteData")==="preset-all"){await d(["SecurityError"],()=>{var f;return(f=b.localStorage)===null||f===void 0?void 0:f.clear()});await d(["SecurityError"],()=>{var f;return(f=b.sessionStorage)===null||f===void 0?void 0:f.clear()});var e=await d(["UnknownError",
"SecurityError"],()=>{var f,g;return(g=b.indexedDB)===null||g===void 0?void 0:(f=g.databases)===null||f===void 0?void 0:f.call(g)});if(e){b.location.origin.includes("canva.ui-app.dev")&&console.warn("\n      WARNING: If you're Proxying the App Sandbox Editor webpage locally on the same origin \n\n               as the Editor (ie canva.ui-app.dev:9090 for both the Editor and App Sandbox) you will increase \n\n               the likelihood of IndexDB operations timing out as both the editor \n\n               and App Sandbox share the same web storage layers. \n\n\n               To avoid this, run the Editor and the App Sandbox development environments on \n\n               different ports. Such as running the Editor on port 9090, and the App Sandbox on 9091.\n      ");
for(const f of e)await d([],()=>c(f))}}};Ao=function(a){return new Promise((b,c)=>{if(!a.name)return b();const d=setTimeout(()=>{c(`Timed out whilst deleting database '${a.name}'`)},100),e=(g,h)=>{clearTimeout(d);g.readyState==="done"&&g.result&&g.result.close();h()},f=window.indexedDB.deleteDatabase(a.name);f.addEventListener("blocked",()=>e(f,b));f.addEventListener("error",g=>e(f,()=>c(g)));f.addEventListener("success",()=>e(f,b))})};Co=function(a){return new Promise(b=>setTimeout(b,a))};
Do=function(a){return()=>Co(a)};Eo=function(a,b,c,d){d=[c instanceof Error?c:null,a.context,d].filter(Hd);Object.keys(a.tags).length>0&&d.push(a.tags);return[`[ConsoleErrorClient][${a.name}][${b}]: ${c}`,...d]};
Go=function(a){if(Fo==null&&(Fo={...((typeof self!=="undefined"?self.flags:void 0)||{})},Go("fe634b10"))){var b,c,d={},e;const g=new URLSearchParams((e=(c=self)===null||c===void 0?void 0:(b=c.location)===null||b===void 0?void 0:b.search)!==null&&e!==void 0?e:"");for(const [h,l]of g)if(b=h.match(/^flags?\.(.+)$/i))b=b[1],b=Ho().v3(b,314159).toString(16),d[b]=l;Io=d}d=Io===null||Io===void 0?void 0:Io[a];d!=null&&(delete Io[a],Fo[a]=d===""||d==="true");var f;return(f=Fo[a])!==null&&f!==void 0?f:!1};
Jo=function(a){Object.keys(a).forEach(b=>a[b]==null&&delete a[b])};Lo=function(a){if(a instanceof Ko){const b=[];a.values.forEach(c=>{b.push(Lo(c))});return b}if(a instanceof Mo){const b={};a.values.forEach(c=>{b[c.name]=Lo(c.value)});return b}return a.value};Oo=function(a,b,c){return b!=null&&typeof b==="object"&&b.sampleRate!=null&&b instanceof Error?No(b.sampleRate):c==="error"||c==="fatal"?a.zh:a.yh};No=function(a){return Math.min(Math.max(0,a),1)};
Po=function(a,b){let c=b;Object.entries(a.Ti).forEach(([d,e])=>{c=c.split(e).join(d)});return c};Qo=function(a,b={}){Object.keys(b).forEach(c=>{const d=b[c];typeof d==="string"&&(b[c]=Po(a,d))})};Ro=function(a,b){var c;return{...b,frames:b===null||b===void 0?void 0:(c=b.frames)===null||c===void 0?void 0:c.map(d=>{for(const [e,f]of Object.entries(a.Ti)){const g=h=>h===null||h===void 0?void 0:h.replace(f,e);d.module=g(d.module);d.abs_path=g(d.abs_path);d.filename=g(d.filename)}return d})}};
So=function(a,b){var c,d;b.exception&&b.exception.values&&(b.exception={...b.exception,values:(d=b.exception)===null||d===void 0?void 0:(c=d.values)===null||c===void 0?void 0:c.map(e=>({...e,...(e.stacktrace&&{stacktrace:Ro(a,e.stacktrace)})}))})};To=function(a,b){var c=b.request;c!=null&&c.url!=null&&(c.url=Po(a,c.url));So(a,b);b.tags!=null&&Qo(a,b.tags)};
Uo=function(a,b){const c=[];b.message&&c.push(b.message);if(b.exception){const {type:d="",value:e=""}=b.exception.values&&b.exception.values[0]||{};d!=="Error"&&c.push(d,e)}return c.some(d=>a.Dj.some(e=>Object.prototype.toString.call(e)==="[object RegExp]"?e.test(d):typeof e==="string"?d.indexOf(e)!==-1:!1))};Wo=function(a){if(a instanceof Vo)return a;if(a&&typeof a==="object"&&"cause"in a)return Wo(a.cause)};
Yo=function(a,b){var c,d;if((a===null||a===void 0?void 0:a.message)!==(b===null||b===void 0?void 0:b.message))return!1;a=(c=a.exception)===null||c===void 0?void 0:c.values;b=(d=b.exception)===null||d===void 0?void 0:d.values;if(a==null||b==null||a.length!==b.length)return!1;for(d=0;d<a.length;d++)if(a[d].value!==b[d].value||a[d].type!==b[d].type||!Xo(a[d].stacktrace,b[d].stacktrace))return!1;return!0};
Xo=function(a,b){a=a===null||a===void 0?void 0:a.frames;b=b===null||b===void 0?void 0:b.frames;if(a==null&&b==null)return!0;if(a==null||b==null||a.length!==b.length)return!1;for(let c=0;c<a.length;c++)if(a[c].filename!==b[c].filename||a[c].colno!==b[c].colno||a[c].lineno!==b[c].lineno)return!1;return!0};$o=function(a,b){const c=a.history.find(f=>Yo(f.event,b));if(c==null)return!1;const d=Zo.now(),e=c.timestamp;return Yo(b,c.event)&&d-e<a.wn};bp=function(a){return a({iteratee:b=>ap({frame:b,pn:"/dist/renderer/"})})};
ap=function({frame:a,pn:b}){if(a.filename==null)return a;const c=a.filename.replace(/\\/g,"/").split(b);if(c.length<=1)return a;a.filename="app://"+b+c.pop();return a};cp=function(a,b){try{const c=new URL(b,`${a.location.protocol}//${a.location.host}`);if(!["http:","https:"].includes(c.protocol))return"";a.Ej.some(d=>c.hostname.includes(d))&&c.pathname.startsWith("/_ajax")||(c.pathname="");c.search="";return b.includes(c.host)?c.toString():c.pathname||"/"}catch(c){return""}};
ep=function(a){const b=[];for(const c of dp){const d=c(a);d&&b.push(d)}return b};fp=function(a,b){a!=null&&typeof a!=="string"&&a instanceof Vo&&a.requestId!=null&&b("requestId",a.requestId)};
hp=function(a){return(b,c)=>{b.request&&(b.request=a.Jg(b.request));if(gp(a,b))return null;fp(c===null||c===void 0?void 0:c.originalException,(e,f)=>{b.tags==null&&(b.tags={});b.tags[e]=f});if(a.jg){b.tags==null&&(b.tags={});a:switch(a.jg.status){case 2:var d="OFFLINE";break a;case 1:d="ONLINE";break a;default:d="UNKNOWN"}b.tags.offlineStatus=d}try{To(a.xh,b)}catch(e){a.G(e)}return a.Bf.reduce((e,f)=>f(e,c),b)}};
rp=function(a,b,c){var d,e,f,g=(d=a.T)===null||d===void 0?void 0:d.getCurrentHub().getClient();d=g&&g.getOptions()||{};var h;g=(h=b.sampleRate)!==null&&h!==void 0?h:1;var l;h=[new ip,new jp(2E3),new kp(g,(l=b.Sl)!==null&&l!==void 0?l:g),new lp,new mp,new np(a.allowUrls,location)];a.T&&(h.push(a.T.dedupeIntegration()),h.push(a.T.extraErrorDataIntegration()),h.push(bp(a.T.rewriteFramesIntegration)));a.Ea.flags&&a.Ea.flags.uk&&h.push(new op(pp));a.setTags(a.Ea.tags);a.setExtras(a.Ea.extra);a.setTag("reactVersion",
qp);if(l=typeof navigator!=="undefined"?navigator.userAgent:void 0)l=ep(l),a.setTags(l);b=b.om;b!==1&&a.setTag("webx",String(b===3));a.setTag("iframe",String(typeof window!=="undefined"&&window.self!==window.top));c.xi&&a.setTag("webview",c.xi);d.beforeSend=hp(a);c={...d,maxValueLength:1024,dsn:d.dsn||a.Ea.dsn,environment:d.environment||a.Ea.environment,release:d.release||a.Ea.release,tracesSampleRate:0,sampleRate:1,integrations:h,allowUrls:a.allowUrls,autoSessionTracking:!1,ignoreErrors:["variable: _AutofillCallbackHandler",
"_AutofillCallbackHandler is not defined","Non-Error promise rejection captured with value: Object Not Found Matching Id"]};if(Go("e75f1ec")){var n;c.transport=(n=a.T)===null||n===void 0?void 0:n.makeBrowserOfflineTransport(a.T.makeFetchTransport);c.transportOptions={flushAtStartup:!0}}Jo(c);(e=a.T)===null||e===void 0||e.init(c);(f=a.T)===null||f===void 0||f.configureScope(r=>{r.setUser({id:Eb()});r.setExtra("isAnonymousUser",!0);r.setTag("initLocation","error_client")})};
gp=function(a,b){const c=b.exception&&b.exception.values&&b.exception.values.length>0&&b.exception.values[0],d=c&&c.stacktrace||void 0,e=d&&d.frames&&d.frames[0]&&d.frames[0].filename,f=b.message||c&&c.value||void 0;return a.Vf.some(g=>g({message:f,filename:e,location,tags:b.tags,event:b}))};sp=function(a,b){var c,d;b instanceof Error?(c=a.T)===null||c===void 0||c.captureException(b):(d=a.T)===null||d===void 0||d.captureMessage(b)};
up=function(a,b,c){if(b==null)return Error((c?c+" ":"")+"[null error thrown]");if(typeof b==="object"){const e=b instanceof __c.tp?new __c.tp(b.message,b.sampleRate):Error(b.message);b.stack&&(e.stack=b.stack);b.cause&&(e.cause=b.cause);if(c){var d;if((d=b.message)===null||d===void 0?0:d.startsWith(c))return a.setTag("prefixCollision","true"),b;a=c+" "+(e.message||"[no message on error]");try{e.message=a}catch(f){if(f instanceof TypeError)return Error(a);throw f;}}return e}return b.toString()};
vp=function(a,b,c,d){a.T==null?(console.error(c),d&&console.log("errorParams",d)):a.T&&a.T.withScope(e=>{typeof d==="string"&&(d={L:d});c=up(e,c,typeof d==="string"?d:d===null||d===void 0?void 0:d.L);d!=null&&(d.fingerprint&&e.setFingerprint(d.fingerprint),d.En&&e.setTag("userFlow",d.En),d.extra&&d.extra.forEach((f,g)=>e.setExtra(g,f)),d.tags&&d.tags.forEach((f,g)=>e.setTag(g,f)));a.componentStack.length>0&&e.setTag("component",a.componentStack.join("."));e.setLevel(b);sp(a,c)})};
Jp=function(a){const b=a.statusCode;switch(b){case 400:return new wp(a);case 401:return new xp(a);case 403:return new yp(a);case 404:return new zp(a);case 409:return new Ap(a);case 418:return new Bp(a);case 429:return new Cp(a);case 500:return new Dp(a);case 503:return new Ep(a);case 504:return new Fp(a);default:return 400<=b&&b<500?new Gp(a):500<=b&&b<600?new Hp(a):new Ip(a)}};
Kp=function(a){if(!a.startsWith("'\"])}while(1);</x>//"))throw new Dp;try{var b=JSON.parse(a.substring(20));if(b==null||typeof b!=="object")throw new TypeError(`expected an object, found: ${b}`);return b}catch(c){throw new Dp(c);}};Lp=function(a){let b;try{b=Kp(a)}catch(d){return{}}a=b.endUserMessage;const c=b.error;return{endUserMessage:typeof a==="string"?a:void 0,message:typeof c==="string"?c:void 0,body:b}};
Op=async function(a,b,c){const d=c&&c.kj,e=d&&(c&&c.Qd||d.af);e&&(c={...c,kj:{...d,af:`${e}.csrf`},Qd:`${e}.csrf`});return a.Xc("GET",`${a.Yc}/${Mp}/${b}`,{Ya:c,timeoutMs:3E4}).then(f=>Np.F(f.body))};
Qp=async function(a,b,c,d,e=1){let f=a.Fb.get(b);f==null&&(f=Op(a,b,c),a.Fb.set(b,f));let g;try{g=await f}catch(h){throw a.Fb.get(b)===f&&a.Fb.delete(b),h;}try{if(e===1&&g.Jk<a.se.now()+Pp)throw new Bp;return await d(g)}catch(h){if(h instanceof Bp)return a.Fb.get(b)===f&&a.Fb.delete(b),Qp(a,b,c,d,e+1);throw h;}};
Rp=function(a,b,c,d){const e=c.status,f=c.body;if(200<=e&&e<300)return a.Ii(c),{body:d?Kp(f):{},getResponseHeader:n=>{n=c.getResponseHeader(n);return n!=null?n:void 0}};const {message:g,endUserMessage:h,body:l}=Lp(f);a=c.getResponseHeader("x-request-id")||c.getResponseHeader("cf-ray")||void 0;throw Jp({statusCode:e,message:g,requestId:a,requestUrl:b,endUserMessage:h,body:l});};Sp=function(a){k(a.startsWith("/")&&a.length>1);return a.split("/")[1]};
Tp=async function(a,b,c,d,e,f){return(await a.Xc(b,`${a.Yc}/_ajax${c}`,{headers:f!=null?{"Content-Type":"application/json;charset=UTF-8"}:void 0,Ya:d,timeoutMs:3E4,uh:e,body:f!=null?JSON.stringify(f):void 0})).body};Wp=function(a,b=new Up){return new Vp(b,a,void 0,void 0,void 0)};Xp=function(a){a.oc.sort((b,c)=>c-b);a.oc.splice(a.ii).forEach(b=>{a.wd.delete(b)});a.oc.length!==a.wd.size&&(a.j.error("Interaction list and map are out of sync, disconnecting observer"),a.disconnect())};
Yp=function(a,b){a.cg.set(b.id,b);a.Hh||(a.Hh=setTimeout(()=>{for(const c of a.cg.values())a.Zl(c);a.cg.clear();a.Hh=void 0}))};Zp=function(a){try{var b;(b=a.Jd)===null||b===void 0||b.observe({type:a.Oe.type,buffered:a.Oe.buffered})}catch(d){var c;(c=a.Jd)===null||c===void 0||c.observe({entryTypes:[a.Oe.type]})}};$p=function(a){a.resources.length>2E3&&(a.resources.sort((b,c)=>c.endTime-b.endTime),a.resources=a.resources.slice(0,2E3))};
aq=function(a,b){const c={Ug:0,ij:0,gj:0,hj:0};for(const d of a.resources)d.startTime>=b.startTime&&d.endTime<=b.endTime&&(c.Ug+=d.yn,c.ij++,d.wl&&c.gj++,d.zl&&c.hj++);return c};__c.bq=function(a){return a.Ca==="span"&&a.attrs.get("is_uop")===!0};dq=function(a){a.timer==null&&a.ea.length!==0&&a.Za.length!==0&&(a.timer=setTimeout(()=>{a.al(()=>{a.timer=void 0;cq(a);dq(a)})},a.config.Qk))};
cq=function(a){var b=performance.now()-a.config.Em,c;for(c=a.ea.length-1;c>=0&&!(a.ea[c].createTime<=b);c--);var d=a.ea.slice(0,c+1);a.ea=a.ea.slice(c+1);const e=new Set,f=[];c=[];for(let g=a.Za.length-1;g>=0;g--){const h=a.Za[g];e.has(h.id)||h.createTime>b?(e.add(h.id),f.push(h)):c.push(h)}c.reverse();c.sort((g,h)=>g.startTime-h.startTime);a.Za=f.reverse();b=[];for(const g of d)if(d=eq(g,c))a.Sa.Td("interaction_latency",{startTime:d.startTime,links:[{jj:g.context}]}).setAttribute("user_operation",
d.Cn).setAttributes(d.Bn).end("ok",d.startTime+d.latency),b.push(d);fq(a,b)};eq=function(a,b){let c;for(const d of b){if(a.startTime<d.startTime)break;a.startTime<=d.startTime+d.latency&&(!c||c.latency<d.latency)&&(c=d)}if(c)return{interactionId:c.id,startTime:c.startTime,latency:c.latency,Cn:a.name,Bn:a.attrs}};fq=function(a,b){a.Cd=a.Cd.concat(b);a.Cd.sort((c,d)=>d.latency-c.latency);a.Cd.splice(a.config.Xl)};
hq=function(a,b,c){if(!a.xd())return{count:void 0,duration:void 0};if(b==null||c==null)return{count:0,duration:0};a=gq(a,b,c);return{count:a.length,duration:a.reduce((d,{duration:e})=>d+e,0)}};gq=function(a,b,c){const d=[];for(const e of a.Bd)a=e.startTime+e.duration,a>b&&a<=c&&d.push(e);return d};
iq=function(a,b){var c=b.attrs.get("was_always_visible");if(typeof c==="boolean")return c;if(b.endTime!=null){a:{c=b.startTime;let d;for(const e of a.Vb){if(e.time>=c&&e.time<=b.endTime&&e.status==="hidden"){a=!1;break a}e.time<=c&&(d=e)}a=d!=null?d.status==="visible":a.sh===a.Vb[0].time?a.Vb[0].status==="visible":void 0}return a}};jq=function(a){return a.document.visibilityState==="visible"?"visible":"hidden"};
qq=function(a,b,c,d){if(d.Bk){var e=new kq(c);lq(a,e);e=new mq(c);lq(a,e);d.tk&&(e=new nq(c),lq(a,e));d.wk&&(d=new oq(c,a,f=>new pq(f,c),{Kl:200,Ll:50,bl:1E3,Qk:5E3,Em:2E3,Xl:10}),lq(a,d),b.Uh=d)}};__c.rq=async function(a,b){if(a.mj==null)a.j.G("Attempted to send user operation before host RPC client has been initiated");else try{await a.mj(b)}catch(c){a.j.G(c)}};
sq=function(a){return[["name",a.name],["status",a.status],["instrumentationScope",a.za],["startTime",a.startTime],["endTime",a.endTime],["duration",a.duration],["parentSpanId",a.parentSpanId]]};__c.tq=function(a){return[["spans",JSON.stringify(a.map(sq),void 0,2)]]};
xq=function({span:a,j:b,Oa:c,mo:d=new Map}){try{var e,f,g,h,l;ia(!a.isRecording(),"Span must be ended to create a PerformanceContext");const n=uq(c,"LongTaskService"),r=uq(c,"VisibilityService"),t=uq(c,"DataUsage"),w=a.startTime,x=a.endTime;ia(x!=null,"Span endTime must exist to create a PerformanceContext");const F=new Map([["start",vq(w,w)]]),H=__c.bq(a)?(e=a.Ba)===null||e===void 0?void 0:e.od:void 0;for(const {name:ja,startTime:qa}of a.Zb)F.set(ja,vq(w,qa));if(H!=null)for(const [ja,qa]of H)F.set(ja,
vq(w,qa));for(const [ja,qa]of d)F.set(ja,vq(w,qa));F.set("finish",vq(w,x));if(n==null||r==null)return{metrics:F,...((g=a.qb)===null||g===void 0?void 0:(f=g.frameRate)===null||f===void 0?void 0:wq(f))};const I=hq(n,w,x),O=iq(r,a),N=t===null||t===void 0?void 0:aq(t,{startTime:w,endTime:x});return{metrics:F,wp:I.count,xp:I.duration,Mq:O,resources:void 0,...N,...((l=a.qb)===null||l===void 0?void 0:(h=l.frameRate)===null||h===void 0?void 0:wq(h))}}catch(n){return c=n instanceof Error?n.message:"Unknown error creating PerformanceContext",
d=c.includes("Invalid metric: adjusted time must not be negative")?2E-4:.2,b.ad(new __c.tp(c,d),{L:"Error creating PerformanceContext",tags:new Map([["span.name",a.name],["service.name",String(a.Na.get("service.name"))]])}),{bp:c}}};vq=function(a,b){a=b-a;ia(a>=0,"Invalid metric: adjusted time must not be negative");return Math.round(a)};
zq=function(a){return function(){for(let b=0;b<a*2;b++)yq[b]=Math.floor(Math.random()*16)+48,yq[b]>=58&&(yq[b]+=39);return String.fromCharCode.apply(null,yq.slice(0,a*2))}};Aq=function(a){let b,c;a instanceof Map?b=a:a&&(c=a);return{Ke:b,Le:c}};Bq=function(a){const {Ke:b,Le:c}=Aq(a);var d;return{...c,attrs:(d=b!==null&&b!==void 0?b:c===null||c===void 0?void 0:c.attrs)!==null&&d!==void 0?d:new Map}};
Cq=function(a){for(const c of a.Pa.plugins)try{var b;(b=c.Md)===null||b===void 0||b.call(c,a)}catch(d){a.j.G(d,{L:"Plugin.onSpanEnd error",extra:new Map([["plugin",c.name],...sq(a)])})}};Fq=function(a){var b;(b=a.Ba)===null||b===void 0||Dq(b,a);a.X instanceof Eq&&a.X.Ba!=null&&a.X.Ba!==a.Ba&&Dq(a.X.Ba,a)};
Hq=function(a,b,c,d){const e=a.Sf={bc:a.bc,cc:a.cc};try{var f;a.timeout&&clearTimeout(a.timeout);let g,h,l;b instanceof Map?h=b:b!=null&&(g=b);c instanceof Map?h=c:c!=null&&(l=c);d!=null&&(l=d);a.bd=!1;g!=null&&a.setStatus(g);h&&a.setAttributes(h);if((f=a.qb)===null||f===void 0?0:f.frameRate){Gq(a.qb.frameRate);const {Wf:n,Lh:r,frameCount:t}=wq(a.qb.frameRate);n!=null&&r!=null&&t!=null&&(a.attrs.set("frame_duration_mean",n),a.attrs.set("frame_duration_standard_deviation",r),a.attrs.set("frame_count",
t),a.attrs.set("long_frame_duration",n+2*r))}a.ended=!0;a.endTime=l!==null&&l!==void 0?l:a.getCurrentTime();a.duration=a.endTime-a.startTime;Cq(a);Fq(a);a.Pa.Uc.process([a]);a.Ld.forEach(n=>n(e));a.bd=!0;return e}catch(g){return a.j.G(g,{L:"Error ending span",extra:new Map(sq(a))}),e}};
Kq=function({Ga:{performance:a,name:b,type:c,attrs:d,startTime:e,timeout:f,Be:g},Sa:h,X:l,Vj:n,j:r,Yl:t}){d=d||new Map;c&&d.set("uop_attr_type",c);d.set("sample_rate_override",1);d.set("is_uop",!0);c=l===null||l===void 0?void 0:l.mb();if(l!=null&&!l.mb()){const F=l.Ua();F instanceof Iq&&(l=F.wa)}e={performance:a,attrs:d,startTime:e,timeout:f};const w=l?h.startSpan(b,l,e):h.Td(b,e);ia(w instanceof Eq,"User operations can only be created by SpanImpls");const x=[];n.forEach(F=>{try{const H=F.oo();x.push(H)}catch(H){r.G(H)}});
h=new Map(x.flatMap(F=>[...F.entries()]));a=new Iq(b,w,h,r,c,g,(a===null||a===void 0?0:a.vq)?new Map:void 0);w.Ba=a;a.fe(()=>{Jq(w,w.attrs.get("uop_attr_type"))});a.setAttributes(h);a.setAttributes(d);t===null||t===void 0||t(w);return a};Lq=function(a){a=a===null||a===void 0?void 0:a.Ua();return a instanceof Iq?a:void 0};
Dq=function(a,b){a.Mf.delete(b);if(!a.ended){if(a.od&&b.Ca==="span"&&!b.aborted){a.od.set(`${b.name}_start`,b.startTime);for(var c of b.Zb)a.od.set(`${b.name}_${c.name}`,c.startTime);b.endTime!=null&&a.od.set(`${b.name}_end`,b.endTime)}c=b.status==="error";b=b.attrs.get("timed_out")===!0;if(a.Mf.size===0||c||b){a.ended=!0;const e=Mq(a,a.wa);if(e!=null){b&&!a.wa.name.endsWith("timed_out")&&(a.wa.setAttribute("timed_out",!0,!0),a.Be||(a.wa.name+=".timed_out"));var d=a.Tf=a.wa.end(c||a.Be&&b?"error":
"ok",e.endTime);a.Ld.forEach(f=>f(d))}else a.wa.abort(),a.lg.forEach(f=>f())}}};Mq=function(a,b){if(!b.aborted){var c=b.endTime!=null?b:void 0;for(const d of b.Mc)b=Mq(a,d),b!=null&&(c==null||b.endTime>c.endTime)&&(c=b);return c}};Jq=function(a,b){if(typeof b==="string"){for(const c of a.Zb)c.setAttribute("uop_attr_type",b,!0);for(const c of a.Mc)c.attrs.get("is_uop")!==!0&&(c.setAttribute("uop_attr_type",b,!0),Jq(c,b))}};
Nq=function(a){if(a){var b=a===null||a===void 0?void 0:a.Ua();return b instanceof Iq?b.Rd:a.mb()}};wq=function(a){return{frameCount:a.xc.count,Wf:a.xc.count>0?a.xc.Nl:void 0,Lh:a.xc.count>0?a.xc.sm:void 0}};Gq=function(a){a.vf&&a.Ag.cancelAnimationFrame(a.vf);a.document.removeEventListener("visibilitychange",a.Ne);a=wq(a);var b=Oq;const c=a.frameCount*a.Wf,d=a.Wf+2*a.Lh;c>0&&(b.frameCount+=a.frameCount,b.gi.add(d,c));for(const e of b.Vh)e(a)};
lq=function(a,b){try{const d=b.name;if(a.config.plugins.some(e=>e.name===d))throw Error(`Plugin already exists: ${b.name}`);a.config.plugins.push(b)}catch(d){var c;a.j.G(d,{extra:new Map([["attrs",Object.fromEntries((c=a.config)===null||c===void 0?void 0:c.Na)]])})}};uq=function(a,b){try{return a.config.plugins.find(d=>d.name===b)}catch(d){var c;a.j.G(d,{extra:new Map([["attrs",Object.fromEntries((c=a.config)===null||c===void 0?void 0:c.Na)]])})}};
Tq=function(a,b){var c;const d=new Map([["app.component",a.app],["service.name",a.app],["app.source",(c=a.source)!==null&&c!==void 0?c:"web"],["session_id",Eb()],["ctx.user",a.Yg],["ctx.brand",a.mh],["ctx.organization",a.ri],["device.id",a.deviceId],["x-canva-tenant","canva-app"]]);if(a.aa==="HTTP"){var e;c=new Pq((e=a.xn)!==null&&e!==void 0?e:0,b);d.set("device.platform",a.platform);var f;d.set("app.flavor",(f=a.Tk)!==null&&f!==void 0?f:"");var g;d.set("app.build.variant",(g=a.variant)!==null&&g!==
void 0?g:"baseline");var h;d.set("app.release",(h=a.release)!==null&&h!==void 0?h:"")}else c=new Qq;const l={Ea:a,j:b};a=__webpack_require__.me(76014).then(()=>__c.Rq).then(({ql:n})=>n(l));b=new Sq(a,b);return{Ig:c,Uc:b,Na:d}};
dr=async function({Af:a,ge:b,Vo:c}){a:{var d=a.j;switch(d.aa){case "CONSOLE":b=new Uq;break a;case "SENTRY":d=new Vq(d);d.Xi([Wq,Xq]);Yq(d,b);if(c)for(const l of c)d.setTag(...l);b=d;break a;default:throw new m(d);}b=void 0}a:{c=a.un;try{if(typeof self!=="undefined"&&c!=null&&c.aa!=="NOOP"){var e=new Zq(Tq(c,b)),f=new $q(e,b);try{if(c.aa!=="NOOP"&&c.Ck){qq(f,e,b,c);var g=new ar(b);lq(f,g);c.source==="webx"&&lq(f,new __c.br(b))}}catch(l){b.G(l)}var h={Zc:f,uq:e};break a}}catch(l){b.G(l)}h=void 0}h=
h?h.Zc:new cr;switch(a.mode){case "REAL":return e=Wp(a.Qh,new Up),{j:b,Qh:e,mode:a.mode,Zc:h};case "FAKE":return{j:b,mode:a.mode,qq:Do(a.tn),Zc:h};default:throw new m(a);}};Wq=function(a){return a.tags&&a.tags.app_approval_status?a.tags.app_approval_status!=="RELEASED":!1};
Xq=function({event:a}){var b;a=a===null||a===void 0?void 0:(b=a.exception)===null||b===void 0?void 0:b.values;return!!a&&a.length!==0&&a.every(c=>{var d;return((d=c.mechanism)===null||d===void 0?void 0:d.type)==="instrument"})===!0};
Yq=function(a,b){let c=()=>!1;try{const d=new URL(b);c=e=>e===null||e===void 0?void 0:e.includes(d.pathname)}catch(d){}a.uf(d=>{try{var e,f,g,h;(f=d.exception)===null||f===void 0||(e=f.values)===null||e===void 0||e.forEach(n=>{var r,t;return(t=n.stacktrace)===null||t===void 0?void 0:(r=t.frames)===null||r===void 0?void 0:r.forEach(w=>{c(w.filename)&&(w.in_app=!1)})});const l=(h=d.exception)===null||h===void 0?void 0:(g=h.values)===null||g===void 0?void 0:g.find(n=>{var r,t,w;return((r=n.mechanism)===
null||r===void 0?void 0:r.handled)===!1&&((w=n.stacktrace)===null||w===void 0?void 0:(t=w.frames)===null||t===void 0?void 0:t.some(x=>{var F;return(F=x.filename)===null||F===void 0?void 0:F.startsWith(b)}))});l&&(d.level="warning",d.tags=d.tags||{},d.tags.third_party_script="true",d.fingerprint=er(l.type,l.value))}catch(l){}return d})};
er=function(a="unknown",b="unknown"){const c=["Failed to execute 'send' on 'XMLHttpRequest': Failed to load '<url>'.","Could not find string for <locale> <id>"].find(d=>(new RegExp(`^${d.replace(/<.+>/g,".+")}$`)).test(b));return["third_party_script_error",a,c||b]};
gr=async function({j:a,Zc:b,sc:c,Hg:d}){var e=c.appId;e=`third_party_app.${c.appName.toLowerCase().replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_]/g,"*")}_${e}`;a.setTag("app_tracer_name",e);var f=await Jb(a);if(!f.ok)throw a.md(f.error,{L:"Could not init sandbox comms"}),d.Ua().addEvent("init_comms_failed"),Error("Could not init sandbox comms");d.Ua().addEvent("init_comms_completed");f=f.value;const g=await (new Rk(f)).getInfo();let h="object_panel",l;if(c.xk)try{l=Pb({fl:document,fg:c.fg,$f:g.platform.$f})}catch(w){a.info("Failed to set localized messages, localized messages will not be enabled for the app")}const {El:n,
Fk:r,yf:t}=await yo({window,Kj:b.sd(e),l:f,j:a,sc:c,wm:g,Hg:d,i18n:l});try{h=t.current.getInfo().surface}catch(w){a.info("Failed to retrieve the current surface, fallback to object panel")}d.Ua().addEvent("init_sdk_completed");document.documentElement.classList.remove(...fr);document.body.classList.remove(...fr);a=h;b=K(document.getElementById("root"),"internal_error","Page 'root' div is missing");b.style.margin="0px";b.style.height="100%";b.style.backgroundColor="transparent";switch(a){case "selected_image_overlay":b.style.paddingLeft=
"0";document.body.style.backgroundColor="transparent";document.documentElement.style.backgroundColor="transparent";b.style.overflow="hidden";break;case "object_panel":b.style.paddingLeft="16px";b.style.overflow="auto";break;case "headless":break;default:throw new m(a);}c.Mh&&Lb({window,sc:c});a=await n();switch(a.type){case "LOAD_ERROR":c=a.Fe;a=a.error;r.Da===6?r.j.G(a,{L:"Could not load app JS script",extra:new Map([["appJsUrl",c]])}):console.error(`Unable to load script from: '${c}',`,a);c=Mn("v/GPpw",
[c]);Qn(r,r.Da===1?c:Nn("taqVJQ"));d.Ua().addEvent("bootstrap_app_failed");break;case "MISSING_ACTIONS":c=a.Pl;r.Da===6?r.j.error("App did not register the required activity actions on load",{extra:new Map([["missingActions",c]])}):console.error("The following required activity actions were not registered: ",c);c=Mn("Zdj8UA",[c.join(", ")]);Qn(r,r.Da===1?c:Nn("taqVJQ"));d.Ua().addEvent("bootstrap_app_failed");break;case "SUCCESS":r.clear();d.Ua().addEvent("bootstrap_app_completed");break;default:throw new m(a);
}};__c.aa=[];ea=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,c){if(a==Array.prototype||a==Object.prototype)return a;a[b]=c.value;return a};da=ca(this);fa("globalThis",function(a){return a||da});
fa("Object.fromEntries",function(a){return a?a:function(b){var c={};if(!(Symbol.iterator in b))throw new TypeError(""+b+" is not iterable");b=b[Symbol.iterator].call(b);for(var d=b.next();!d.done;d=b.next()){d=d.value;if(Object(d)!==d)throw new TypeError("iterable for fromEntries should yield objects");c[d[0]]=d[1]}return c}});var hr=__webpack_require__(245307).Fm;var ir=__webpack_require__(970995).unstable_registerHook;__webpack_require__(588587);var jr=__webpack_require__(269018)._;var yg=__webpack_require__(449011)._;var kr=__webpack_require__(934276)._;var Ag=__webpack_require__(260023)._;var lr=__webpack_require__(876408)._;var mr=__webpack_require__(910357)._;var nr=__webpack_require__(952277),ek=nr.eW,ik=nr.Jp,hk=nr.N6,dk=nr.qg,kk=nr.xm,ak=nr.ZE;var or=__webpack_require__(165661).E1;var pr=__webpack_require__(400770),em=pr._getGlobalState,qr=pr._isComputingDerivation,cm=pr.action,rr=pr.comparer,sr=pr.computed,tr=pr.createAtom,am=pr.makeObservable,ur=pr.observable,vr=pr.ObservableMap,wr=pr.onBecomeUnobserved;var xr=__webpack_require__(450117).B7;__webpack_require__(268245);var yr=__webpack_require__(388909).t;__webpack_require__(535921);__webpack_require__(206928);var On=__webpack_require__(270713).Ay;var zr=__webpack_require__,Ar=zr(882262),Ho=zr.n_x(Ar);var qp=__webpack_require__(845212).version;typeof ir!=="function"||hr.isNoop||ir(hr.wrap);__webpack_require__.p=self.__canva_public_path__;var m=class extends Error{constructor(a){super(`unhandled case: ${JSON.stringify(a)}`)}};var Br=class{constructor(a){this.type=a}};var Cr=class extends Br{required(a,b){b=b[a];if(b==null||typeof b!==this.type)throw new TypeError(`expected ${this.type} for property "${a}", found: ${JSON.stringify(b)}`);return b}optional(a,b){b=b[a];if(b!=null){if(typeof b!==this.type)throw new TypeError(`expected optional ${this.type} for property "${a}", found: ${JSON.stringify(b)}`);return b}}},va=new Cr("object");var sa={},na={},pa=typeof window!=="undefined"&&window.location?xa():{},Aa=new Map([["",!0],["true",!0],["false",!1]]),Ba=new Map([["",void 0],["null",null],["undefined",void 0]]),ya=/^str\((.*)\)$/;var Ca=class{get ok(){return!0}map(a){return new Ca(a(this.value))}constructor(a){this.value=a}},Ea=class{get ok(){return!1}map(){return this}constructor(a){this.error=a}},p=Da,q=Fa;var Na={K:"string"},Dr={K:"boolean",defaultValue:!1,Sk:1},Er={K:"number",defaultValue:0,Sk:8},Fr={K:"number",defaultValue:0},Gr={K:"number",defaultValue:0},S=a=>{const {tag:b,M:c,ra:d}=u(a);return La(Er,c,b,d)},T=a=>{const {tag:b,M:c,ra:d}=u(a);return La(Fr,c,b,d)},Hr=a=>{const {tag:b,M:c,ra:d}=u(a);return La(Gr,c,b,d)},Ir=a=>{const {tag:b,M:c}=u(a);return Ma(Er,c,b)},V=a=>{const {tag:b,M:c}=u(a);return Ma(Fr,c,b)},Jr=a=>{const {tag:b,M:c}=u(a);return Ma(Gr,c,b)},Kr=a=>{const {tag:b,M:c}=u(a);return{tag:b,
da:4,M:c,K:Fr.K}},W=(a,b)=>{const {tag:c,M:d,ra:e}=u(a,b);return La(Na,d,c,e)},X=a=>{const {tag:b,M:c}=u(a);return Ma(Na,c,b)},Lr=a=>{const {tag:b,M:c}=u(a);return{tag:b,da:4,M:c,K:Na.K}},Y=a=>{const {tag:b,M:c,ra:d}=u(a);return La(Dr,c,b,d)},Z=a=>{const {tag:b,M:c}=u(a);return Ma(Dr,c,b)},Mr=Oa(Na),Nr=Oa("object");var Or=C(()=>({aa:v(2,"CONSOLE")}));var Pr=E(()=>[1,2,3],1);var Qr=C(()=>({name:W(1),value:W(2)}));var Rr=C(()=>({uk:Z(1)}));var Sr=C(()=>({Mo:Z(1),Fp:V(2),Gp:V(3),Hp:V(4)}));var Tr=C(()=>({type:v(1,"STRING"),value:W(1)}));var Ur=C(()=>({type:v(2,"BOOL"),value:Y(1)}));var Vr=C(()=>({type:v(3,"INT"),value:T(1)}));var Wr=C(()=>({type:v(4,"DOUBLE"),value:S(1)}));var Ko=C(()=>({type:v(5,"ARRAY"),values:A(1,Xr)}));var Mo=C(()=>({type:v(6,"KVLIST"),values:A(1,Yr)}));var Xr=D(()=>({type:[1,Tr,2,Ur,3,Vr,4,Wr,5,Ko,6,Mo]}),()=>({}));var Yr=C(()=>({name:W(1),value:y(2,Xr)}));var Zr=C(()=>({aa:v(3,"SENTRY"),dsn:X(28),environment:X(30),release:X(34),sampleRate:Ir(29),tracesSampleRate:Ir(31),Jo:Z(32),om:Qa(33,Pr),tags:A(35,Qr),flags:z(36,Rr),Ep:z(37,Sr),extra:A(38,Yr),Sl:Ir(39)}));var $r=D(()=>({aa:[2,Or,3,Zr]}),()=>({}));var as=E(()=>[0,"CLIENT_FULL",1,"CLIENT_HYDRATE",2,"SERVER_FULL"]);var bs=E(()=>[1,3,2],1);var cs=C(()=>({action:v(1,"REGISTER"),hq:W(1),scope:W(2)}));var ds=C(()=>({action:v(2,"UNREGISTER")}));var es=C(()=>({action:v(3,"UPDATE")}));var fs=C(()=>({action:v(4,"RETAIN")}));var gs=D(()=>({action:[1,cs,2,ds,3,es,4,fs]}),()=>({}));var hs=C(()=>({workerUrl:W(1),Uq:V(2)}));var is=E(()=>[1,2]);var js=E(()=>[1,2,3,4]);var ks=C(()=>({category:B(1,js),name:W(2)}));var ls=C(()=>({Pn:Y(15),nq:Y(12),Dq:Y(13),eo:Y(1),Co:Y(2),Lo:Y(14),jo:W(3),yp:W(9),Wp:W(10),aq:A(5,ks),Tp:X(6),qp:Kr(16),io:Kr(17),xo:Z(18),hp:Z(19),ho:Jr(22),Qo:Z(23)}));var ms=()=>({Ck:Z(5),Je:V(6),Ie:V(7),Kk:V(8),Bk:Z(9),fq:Ir(10),xn:Ir(11),source:X(13),Yg:X(14),mh:X(4),ri:X(17),deviceId:X(18),Tn:X(15),Mk:Z(16),So:Z(19),wk:Z(20),To:Z(21),Ro:Z(22),Qn:Lr(23),Ho:Z(24),tk:Z(25)});var ns=C(()=>({...ms(),aa:v(1,"HTTP"),app:W(27),endpoint:W(28),release:X(29),Tk:X(31),No:Z(32),Oo:Z(33),platform:X(35),variant:X(36)}));var os=C(()=>({...ms(),aa:v(2,"CONSOLE"),app:W(27)}));var ps=C(()=>({...ms(),aa:v(3,"NOOP")}));var qs=D(()=>({aa:[1,ns,2,os,3,ps]}),ms);var rs=C(()=>({traceId:W(1),spanId:W(2),traceFlags:T(3)}));var ss=C(()=>({href:W(1),pq:X(3)}));var ts=()=>({Rm:Y(12),Ih:Y(14),commit:W(5),timestamp:Jr(11),j:y(6,$r),cq:B(7,as),runtime:B(9,bs),kq:z(15,gs),Tq:z(4,hs),Ip:X(13),nl:Qa(17,is),wq:z(18,ls),un:z(20,qs),Rp:z(24,rs),Vp:A(21,ss),Eq:Lr(22),bo:X(34)});var Np=C(()=>({token:W(1),Jk:Hr(2)}));var us=C(()=>({gd:X(1),wf:X(9),Gc:X(2),Hc:X(3),ee:X(14),kf:X(12),he:X(4),Ge:X(10),app:X(11),ie:X(5),je:X(6),Yc:X(7),Fb:Nr(8,Np)}));var vs=C(()=>({gd:X(1),Gc:X(2),Hc:X(3),ee:X(10),kf:X(9),he:X(4),Ge:X(5),app:X(6),ie:X(7),je:X(8)}));var ws=C(()=>({url:W(1),context:z(2,vs),zp:V(3)}));var xs=C(()=>({Ik:W(27)}));var ys=C(()=>({Ik:W(27),ko:X(28),locale:W(29),fo:V(30),mh:X(31),ri:X(37),Yg:X(34),Xo:X(32),$o:X(33),deviceId:X(35)}));var zs=()=>({Jq:z(3,xs),Wo:y(4,ys),Yo:Mr(5),appName:X(9),sp:Kr(16),sq:Kr(17),Fo:Y(18),vo:Z(19)});var As=C(()=>({...zs(),aa:v(2,"CONSOLE")}));var Bs=C(()=>({...zs(),aa:v(8,"NOOP")}));var Cs=C(()=>({containerId:W(1)}));var Ds=C(()=>({Nn:W(1),projectId:W(2)}));var Es=C(()=>({Fj:W(1)}));var Fs=C(()=>({}));var Gs=C(()=>({pp:z(2,Cs),Lp:z(4,Ds),Vn:z(6,Es),jp:z(7,Fs)}));var Hs=C(()=>({...zs(),aa:v(14,"PRODUCT_ANALYTICS"),plugins:z(32,Gs),Qq:V(36),Po:Y(37),Rq:Y(40),Ko:Y(45),Eo:Y(47)}));var Is=D(()=>({aa:[2,As,8,Bs,14,Hs]}),zs);var Js=C(()=>({aa:v(1,"NONE")}));var Ks=C(()=>({aa:v(2,"FULLSTORY"),Mp:W(28)}));var Ls=D(()=>({aa:[1,Js,2,Ks]}),()=>({}));var Ms=E(()=>[1,2,3,4]);var Ns=C(()=>({qo:Qa(1,Ms),Zp:Qa(2,Ms),Bp:Qa(4,Ms),Ap:Qa(8,Ms),Iq:Qa(5,Ms),gq:Qa(6,Ms),po:Qa(7,Ms),no:Qa(10,Ms),lq:Qa(9,Ms),Kq:Qa(11,Ms),ro:Qa(12,Ms),co:Qa(13,Ms),lo:Qa(14,Ms),On:Qa(15,Ms)}));var Os=C(()=>({Up:y(1,Ns),Yp:Y(2)}));var Ps=C(()=>({Yg:X(1),Fj:W(2),Cq:Y(3),Hq:z(4,Os)}));var Qs=C(()=>({url:W(1),Sn:X(2),Bq:Y(3),Nq:X(4)}));var Rs=C(()=>({...ts(),mode:v(2,"REAL"),Qh:y(27,us),Pq:y(30,ws),Rn:y(28,Is),tp:z(29,Ls),$n:z(32,Ps),iq:z(31,Qs)}));var Ss=C(()=>({...ts(),mode:v(3,"FAKE"),tn:T(27),hostname:X(28),Oq:V(29)}));var Ts=D(()=>({mode:[2,Rs,3,Ss]}),ts);var G=class extends Error{constructor(a){a.code=uo(a.code);const b=a.message.endsWith(".")?"":".";super(`[${a.code}]:  ${a.message}${b}`.trim());this.code=a.code;this.name="CanvaError";this.rawMessage=a.message;Object.setPrototypeOf(this,G.prototype)}},uo=a=>a;var L=class extends G{};var Us=C(()=>({canAcceptPayments:Y(1)}));var Vs=E(()=>[1,2]);var Ws=C(()=>({code:W(1),direction:B(2,Vs)}));var Xs=C(()=>({locale:y(1,Ws),vk:Z(2)}));var Ys=C(()=>({rm:y(1,Us),$f:z(2,Xs)}));var Zs=C(()=>({experimentalPremiumAppUi:Z(1)}));var $s=C(()=>({Fn:z(1,Zs)}));var ol=C(()=>({name:W(1),actions:Lr(2)}));var at=C(()=>({Kh:A(2,ol)}));var bt=C(()=>({zj:y(1,at)}));var ct=C(()=>({platform:y(1,Ys),authentication:z(2,$s),activities:z(3,bt)}));var dt=E(()=>[1,2]);var ib=C(()=>({hb:B(1,dt)}));var kb=C(()=>({hb:B(1,dt),durationMs:T(2),na:T(3)}));var mb=C(()=>({hb:B(1,dt),durationMs:T(2),na:T(3),endpoint:W(4)}));var et=E(()=>[1]);var ob=C(()=>({type:B(1,et)}));var ft=E(()=>[1]);var qb=C(()=>({type:B(1,ft)}));var gt=C(()=>({Gn:V(1),Wl:V(2)}));var sb=C(()=>({Qd:W(1),ym:z(2,gt)}));var zb=C(()=>({theme:X(1),direction:X(2)}));var ht=C(()=>({version:W(1)}));var vb=C(()=>({Eg:W(1),methodName:W(2),propertyName:X(3)}));var xb=C(()=>({Hb:W(1),Ib:W(2),Ob:W(3)}));var Rk=class{async getUiContext(){const a=await this.l.request("UI_CONTEXT_V1_GET_UI_CONTEXT");if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"UI_CONTEXT_V1_GET_UI_CONTEXT: response cannot be empty"});return zb.F(a.value)}async registerAppUiKitVersion(a){a=ht.C(a);a=await this.l.request("UI_CONTEXT_V1_REGISTER_APP_UI_KIT_VERSION",a);if(!a.ok)throw a.error;}async getInfo(){const a=await this.l.request("GET_INFO_V1");if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",
message:"GET_INFO_V1: response cannot be empty"});return ct.F(a.value)}constructor(a){this.l=a}};var Bb=class extends Error{constructor(){super("[internal_error] Comms promise timed out.")}},Hb=class{reset(a){a&&(this.timeoutMs=a);this.setTimeout()}resolve(a){clearTimeout(this.df);this.Nm(a)}reject(a){clearTimeout(this.df);this.Mi(a)}promise(){return this.p}setTimeout(){clearTimeout(this.df);this.df=setTimeout(()=>{Cb(this)},Math.max(this.timeoutMs-500,500))}constructor(a){this.timeoutMs=a;this.p=new Promise((b,c)=>{this.Nm=b;this.Mi=c});this.setTimeout()}};var it=class{constructor(a,b,c){this.Zk=a;this.port=b;this.j=c;this.send=d=>{try{return this.port.postMessage(d),p()}catch(e){return this.j.G(e),q(e)}};this.dm=d=>{this.j.G(d)};this.$l=({data:d})=>{if(d)try{this.Zk.Dm(d)}catch(e){this.j.G(e)}else this.j.error(new G({code:"internal_error",message:"missing data in 'MessageEvent'"}))};this.port.onmessage=this.$l;this.port.onmessageerror=this.dm}};var jt=class{request(a,b){const c=this.Ai,d=new Hb(5E3),e=this.Lm(),f=async function(){c.set(e,{path:a,Mm:d});try{const g=await d.promise();return p(g)}catch(g){return g instanceof Bb?q(new G({code:"internal_error",message:`Comms promise timed out (${a}).`})):q(g)}finally{c.delete(e)}}();b=this.send(e,a,b);b.ok||(this.j.G(b.error,{L:"unable to send request",tags:new Map([["type","request"],["path",a]])}),d.reject(b.error));return f}constructor(a,b){this.send=a;this.j=b;this.Lm=Eb;this.Ai=new Map}};var kt=class{handle(a,b){if(this.Vc.has(a))throw new G({code:"internal_error",message:`Handler for '${a}' is already defined.`});this.Vc.set(a,b)}constructor(a,b){var c=console;this.Fd=a;this.j=b;this.Km=!1;this.ik=c;this.Vc=new Map;this.Gk=new Set}};var Ib=class{constructor(a,b){this.request=(c,d)=>this.client.request(c,d);this.handle=(c,d)=>this.Vc.handle(c,d);a=new lt(c=>{switch(c.type){case "ack":case "error":case "response":var d=this.client;const e=c.requestId,f=c.type,{path:g,Mm:h}=d.Ai.get(e)||{};if(h)switch(f){case "response":h.resolve(c.payload);break;case "ack":h.reset(2E4);break;case "error":d.j.B({level:"info",category:"sandbox_comms",message:"Error response received",data:{path:g!==null&&g!==void 0?g:"unknown"}});h.reject(new G({code:c.code,
message:c.message}));break;default:throw new m(c);}else f!=="ack"&&d.j.error("request has already been handled and resolved or was not sent from this client",{tags:new Map([["type",f],["requestId",`${e}`]])});break;case "request":Gb(this.Vc,c);break;default:throw new m(c);}},a,b.Nc("bus"));this.client=new jt(a.Xc,b.Nc("client"));this.Vc=new kt(a,b.Nc("requestHandler"))}},lt=class{constructor(a,b,c){this.Qc=a;this.Xc=(d,e,f)=>this.hd.send({type:"request",requestId:d,path:e,payload:f});this.fm=d=>{switch(d.type){case "ack":this.Qc({type:"ack",
requestId:d.requestId});break;case "error":this.Qc({type:"error",requestId:d.requestId,code:d.code,message:d.message});break;case "response":this.Qc({type:"response",requestId:d.requestId,payload:d.payload});break;case "request":this.Qc({type:"request",requestId:d.requestId,path:d.path,payload:d.payload});break;default:throw new m(d);}};this.hd=new it({Dm:this.fm},b,c)}};var mt=E(()=>[1,"DEVELOPMENT",2,"APPROVED",3,"SUBMITTED",4,"REJECTED",8,"TRANSLATION",{Tb:!0},5,"RELEASED",6,"SUPERSEDED",7,"DISABLED"]);var nt=E(()=>[1,2]);var ot=C(()=>({key:W(1),message:W(2)}));var pt=C(()=>({Fl:W(1),Gl:B(2,nt),fi:A(15,ot)}));var qt=C(()=>({Ol:Hr(1),Hn:Hr(2),Mj:Hr(3)}));var rt=C(()=>({ge:W(1),appId:W(5),appName:W(6),Da:B(10,mt),Ic:Y(8),fg:z(14,pt),xk:Z(15),locale:X(2),country:X(3),Mh:X(4),pd:Y(11),Yk:Lr(12),Go:Z(16),Ec:y(17,qt)}));var Nb={code:"en",direction:"ltr"},Ob={messages:{}};var Qb=Symbol.for("canva_sdk_feature_tag");var st=({namespace:a,client:b,method:c})=>({level:"log",data:{app_api_namespace:a,app_api_client:b,app_api_method:c}});var tt=C(()=>({type:v(1,"IMAGE"),parentRef:X(7),url:W(2),mimeType:W(3),thumbnailUrl:W(4),width:V(5),height:V(6),uploadedToastVisibility:X(8)}));var ut=C(()=>({type:v(2,"VIDEO"),parentRef:X(8),url:W(2),mimeType:W(3),thumbnailImageUrl:W(4),thumbnailVideoUrl:X(5),width:V(6),height:V(7),uploadedToastVisibility:X(9)}));var vt=C(()=>({type:v(3,"AUDIO"),url:W(2),mimeType:W(3),title:W(4),durationMs:T(5),uploadedToastVisibility:X(6)}));var wt=D(()=>({type:[1,tt,2,ut,3,vt]}),()=>({}));var xt=C(()=>({type:v(1,"DONE"),ref:W(1),qc:Y(2)}));var yt=C(()=>({type:v(2,"FAILED"),tc:W(1)}));var zt=D(()=>({type:[1,xt,2,yt]}),()=>({}));var At=C(()=>({type:v(1,"IMAGE"),ref:W(1)}));var Bt=C(()=>({type:v(2,"VIDEO"),ref:W(1)}));var Ct=C(()=>({type:v(3,"AUDIO"),ref:W(1)}));var Tb=D(()=>({type:[1,At,2,Bt,3,Ct]}),()=>({}));var Dt=C(()=>({type:v(1,"DONE")}));var Et=C(()=>({type:v(2,"FAILED"),tc:W(1)}));var Ub=D(()=>({type:[1,Dt,2,Et]}),()=>({}));var Ft=C(()=>({type:v(1,"IMAGE"),ref:W(1)}));var Gt=C(()=>({type:v(2,"VIDEO"),ref:W(1)}));var Ht=D(()=>({type:[1,Ft,2,Gt]}),()=>({}));var It=C(()=>({type:v(1,"IMAGE"),ref:W(1),url:W(2)}));var Jt=C(()=>({type:v(2,"VIDEO"),ref:W(1),url:W(2)}));var Kt=D(()=>({type:[1,It,2,Jt]}),()=>({}));var Lt=C(()=>({x:T(1),y:T(2),height:T(3),width:T(4)}));var Mt=E(()=>[1]);var Nt=C(()=>({type:v(1,"SOLID"),hexString:W(1)}));var Ot=D(()=>({type:[1,Nt]}),()=>({}));var Pt=C(()=>({anchor:y(1,Lt),scopes:Ra(Mt),selectedColor:z(3,Ot)}));var Wb=C(()=>({}));var Qt=C(()=>({fontRefs:Lr(1)}));var Rt=C(()=>({weight:W(1),styles:Lr(2)}));var St=C(()=>({ref:W(1),name:W(2),weights:A(3,Rt),previewUrl:X(4)}));var Tt=C(()=>({fonts:A(1,St)}));var Ut=C(()=>({selectedFontRef:X(1)}));var Vt=C(()=>({type:v(1,"COMPLETED"),font:y(1,St)}));var Wt=C(()=>({type:v(2,"ABORTED")}));var Xt=D(()=>({type:[1,Vt,2,Wt]}),()=>({}));var Yt=C(()=>({Lg:v(1,"SOLID"),selection:y(1,Nt)}));var Yb=D(()=>({Lg:[1,Yt]}),()=>({}));var Zt=class{async upload(a){a=wt.C(a);a=await this.l.request("CONTENT_V2_UPLOAD",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"CONTENT_V2_UPLOAD: Response cannot be empty"});return zt.F(a.value)}async getTemporaryUrl(a){a=Ht.C(a);a=await this.l.request("CONTENT_V1_GET_TEMPORARY_URL",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"CONTENT_V1_GET_TEMPORARY_URL: Response cannot be empty"});return Kt.F(a.value)}async openColorSelector(a){a=
Pt.C(a);a=await this.l.request("CONTENT_V1_OPEN_COLOR_SELECTOR",a);if(!a.ok)throw a.error;}async findFonts(a){a=Qt.C(a);a=await this.l.request("CONTENT_V1_FIND_FONTS",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"CONTENT_V1_FIND_FONTS: Response cannot be empty"});return Tt.F(a.value)}async requestFontSelection(a){a=Ut.C(a);a=await this.l.request("CONTENT_V1_REQUEST_FONT_SELECTION",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",
message:"CONTENT_V1_REQUEST_FONT_SELECTION: Response cannot be empty"});return Xt.F(a.value)}constructor(a){this.l=a}};var $t=a=>a.map(b=>{switch(b){case "solid":return 1;default:throw new L({code:"internal_error",message:`Invalid scope ${b}`});}}),au=({anchor:a,scopes:b,selectedColor:c})=>{a={height:a.height,width:a.width,x:a.left,y:a.top};b=$t(b);a:{if(c!=null)switch(c.type){case "solid":c={type:"SOLID",hexString:c.hexString};break a;default:throw new L({code:"internal_error",message:`Unknown color type ${c.type}`});}c=void 0}return{anchor:a,scopes:b,selectedColor:c}},bu=a=>a.map(b=>{switch(b){case "normal":case "italic":return b;
default:throw new L({code:"bad_request",message:`Unknown font style ${b}`});}}),cu=a=>{const b=a.weight;switch(b){case "normal":case "thin":case "extralight":case "light":case "medium":case "semibold":case "bold":case "ultrabold":case "heavy":return{weight:a.weight,styles:bu(a.styles)};default:throw new L({code:"bad_request",message:`Unknown font weight ${b}`});}},du=a=>({...a,weights:a.weights.map(cu),ref:a.ref}),$b=(a,b,c)=>{switch(a){case "invalid_dimensions":return new G({code:"bad_request",message:"Invalid asset dimensions received."});
case "invalid_id":return new G({code:"bad_request",message:"Invalid asset ID received."});case "invalid_parent_ref":return new G({code:"bad_request",message:"Invalid reference to parent asset received."});case "invalid_duration":return new G({code:"bad_request",message:"Invalid asset duration received."});case "invalid_media_type":return new G({code:"bad_request",message:"Invalid asset type received."});case "invalid_options":return new G({code:"bad_request",message:"Invalid upload options received."});
case "invalid_thumbnail_url":return new G({code:"bad_request",message:"Invalid asset thumbnail URL received."});case "invalid_title":return new G({code:"bad_request",message:"Invalid asset title received."});case "invalid_url":return new G({code:"bad_request",message:"Invalid asset URL received."});case "mismatched_mime_type":return new G({code:"bad_request",message:"Mime type mismatch between supplied and asset mime-types."});case "unsupported_mime_type":return new G({code:"bad_request",message:"Unsupported asset mime-type."});
case "offline":return new G({code:"user_offline",message:"Could not carry out the request due to the user being offline."});case "quota_exceeded":return new G({code:"quota_exceeded",message:"Unable to upload asset due to user having exceeded their uploads quota."});case "timeout":return new G({code:"timeout",message:"Upload operation timed-out. Please try again later."});case "unavailable_thumbnail":return new G({code:"not_found",message:"Asset thumbnail was unavailable at provided URL."});case "unavailable_media":return new G({code:"not_found",
message:"Asset was unavailable at provided URL."});case "unknown":return new G({code:"internal_error",message:"Something unexpected went wrong."});case "oversized_media":return b==="video"?new G({code:"bad_external_service_response",message:`Asset upload failed due to it exceeding the maximum supported file size of ${Math.floor((c===null||c===void 0?NaN:c.Hn)/1048576)} MB.`}):b==="image"?new G({code:"bad_external_service_response",message:`Asset upload failed due to it exceeding the maximum supported file size of ${Math.floor((c===
null||c===void 0?NaN:c.Ol)/1048576)} MB (or 3MB for SVGs).`}):b==="audio"?new G({code:"bad_external_service_response",message:`Asset upload failed due to it exceeding the maximum supported file size of ${Math.floor((c===null||c===void 0?NaN:c.Mj)/1048576)} MB.`}):new G({code:"bad_external_service_response",message:"Asset upload failed due to it exceeding the maximum supported file size."});case "oversized_media_dimensions":return new G({code:"bad_external_service_response",message:"Asset upload failed due to it exceeding the 250 megapixels limit."});
default:throw new L({code:"internal_error",message:`Unexpected failure reason type '${a}'.`});}};var eu=["image","video"],fu=["solid"],dc=/^Y[A-Za-z0-9_-]{10}:[0-9]+$/,hu=a=>{if(typeof a!=="object"||a==null)throw new G({code:"bad_request",message:"Anchor must be an object and cannot be undefined."});if(!(gu(a.height)&&gu(a.width)&&gu(a.top)&&gu(a.left)))throw new G({code:"bad_request",message:"Anchor values must be numbers."});},iu=a=>{if(typeof a!=="object"||a==null)throw new G({code:"bad_request",message:"Open color selector options must be an object and cannot be undefined."});if(!Array.isArray(a.scopes))throw new G({code:"bad_request",
message:`Invalid scopes. Expected "array" received "${a.scopes}".`});for(const b of a.scopes){if(!P(b))throw new G({code:"bad_request",message:`Invalid scope. Expected "string" received "${b}".`});if(!fu.includes(b))throw new G({code:"bad_request",message:`Invalid scope. Expected one of ${fu} received "${b}".`});}if(a.selectedColor!=null){if(!P(a.selectedColor.type))throw new G({code:"bad_request",message:`Invalid selected color type. Expected "string" received ${a.selectedColor.type}`});if(!P(a.selectedColor.hexString))throw new G({code:"bad_request",
message:`Invalid selected color hexString. Expected "string" received ${a.selectedColor.hexString}`});}},An=a=>{if(typeof a!=="object"||a==null)throw new G({code:"bad_request",message:"Upload options must be an object and cannot be undefined."});if(!P(a.type))throw new G({code:"bad_request",message:`Invalid upload type. Expected "string" received "${typeof a.type}".`});if(a.uploadedToastVisibility!=null&&!P(a.uploadedToastVisibility))throw new G({code:"bad_request",message:`Invalid uploaded toast visibility. Expected "string" or "undefined" received "${typeof a.type}".`});
const b=a.type;switch(b){case "image":if(a.parentRef&&!P(a.parentRef))throw new G({code:"bad_request",message:`Invalid image 'parentRef'. Expected "string" received "${typeof a.parentRef}".`});if(!P(a.url))throw new G({code:"bad_request",message:`Invalid image 'url'. Expected "string" received "${typeof a.url}".`});if(!P(a.mimeType))throw new G({code:"bad_request",message:`Invalid image 'mimeType'. Expected "string" received "${typeof a.mimeType}".`});if(!P(a.thumbnailUrl))throw new G({code:"bad_request",
message:`Invalid image 'thumbnailUrl'. Expected "string" received "${typeof a.thumbnailUrl}".`});if(!ju(a))throw new G({code:"bad_request",message:"Invalid image 'dimensions'."});break;case "video":if(a.parentRef&&!P(a.parentRef))throw new G({code:"bad_request",message:`Invalid video 'parentRef'. Expected "string" received "${typeof a.parentRef}".`});if(!P(a.url))throw new G({code:"bad_request",message:`Invalid video 'url'. Expected "string" received "${typeof a.url}".`});if(!P(a.mimeType))throw new G({code:"bad_request",
message:`Invalid video 'mimeType'. Expected "string" received "${typeof a.mimeType}".`});if(!P(a.thumbnailImageUrl))throw new G({code:"bad_request",message:`Invalid video 'thumbnailImageUrl'. Expected "string" received "${typeof a.thumbnailImageUrl}".`});if(a.thumbnailVideoUrl!=null&&!P(a.thumbnailVideoUrl))throw new G({code:"bad_request",message:`Invalid video 'thumbnailVideoUrl'. Expected "string" or "undefined" received "${typeof a.thumbnailVideoUrl}".`});if(!ju(a))throw new G({code:"bad_request",
message:"Invalid video 'dimensions'."});break;case "audio":if(!P(a.url))throw new G({code:"bad_request",message:`Invalid audio 'url'. Expected "string" received "${typeof a.url}".`});if(!P(a.mimeType))throw new G({code:"bad_request",message:`Invalid audio 'mimeType'. Expected "string" received "${typeof a.mimeType}".`});if(!P(a.mimeType))throw new G({code:"bad_request",message:`Invalid audio 'title'. Expected "string" received "${typeof a.title}".`});if(!gu(a.durationMs))throw new G({code:"bad_request",
message:`Invalid audio 'durationMs'. Expected "number" received "${typeof a.durationMs}".`});a=a.durationMs;if(!(Number.isSafeInteger(a)&&a>0))throw new G({code:"bad_request",message:"Invalid audio 'durationMs'. Duration must be a non-zero positive integer."});break;default:throw new L({code:"bad_request",message:`Invalid upload type "${b}".`});}},P=a=>typeof a==="string",gu=a=>typeof a==="number"&&Number.isFinite(a),ju=({width:a,height:b})=>typeof a==="number"&&typeof b==="number"||a==null&&b==null;var ku,ec=class{async getTemporaryUrl(a){this.B("getTemporaryUrl");try{if(!(typeof a==="object"&&a!=null&&P(a.type)&&eu.includes(a.type)&&P(a.ref)))throw new G({code:"bad_request",message:"Malformed request"});var b=this.A,c=b.getTemporaryUrl;a:{const g=a.type;switch(g){case "image":var d={...a,type:"IMAGE"};break a;case "video":d={...a,type:"VIDEO"};break a;default:throw new L({code:"internal_error",message:`Unexpected options type '${g}'.`});}}const f=await c.call(b,d);a:{const g=f.type;switch(g){case "IMAGE":var e=
{type:"image",ref:f.ref,url:f.url};break a;case "VIDEO":e={type:"video",ref:f.ref,url:f.url};break a;default:throw new L({code:"internal_error",message:`Unexpected result type '${g}'.`});}}return e}catch(f){if(f instanceof G)throw new G({code:f.code,message:`Encountered an error while trying to get a temporary URL: ${f.rawMessage}`});throw new G({code:"internal_error",message:`Encountered an error while trying to get a temporary URL: ${f instanceof Error?f.message:f}`});}}async upload(a){this.B("upload");
An(a);try{a:{const d=a.type;switch(d){case "IMAGE":case "image":var b=new tt(a);break a;case "VIDEO":case "video":b=new ut(a);break a;case "AUDIO":case "audio":b=new vt(a);break a;default:throw new L({code:"bad_request",message:`Unexpected upload options type '${d}'.`});}}a=b;const c=await this.A.upload(a);return ac({type:a.type,result:c,ld:this.ld,Ec:this.Ec})}catch(c){if(c instanceof G)throw c;throw new G({code:"internal_error",message:`Encountered an error while uploading asset: ${c instanceof
Error?c.message:c}`});}}async openColorSelector(a,b){hu(a);iu(b);this.oh=b.onColorSelect;this.A.openColorSelector(new Pt(au({anchor:a,scopes:b.scopes,selectedColor:b.selectedColor}))).catch(c=>{if(c instanceof G)throw c;throw new G({code:"internal_error",message:`Failed to open the color selector: ${c instanceof Error?c.message:c}`});});return()=>{Xb(this.A).catch(c=>{throw new G({code:"internal_error",message:`Failed to close the color selector: ${c}`});})}}async Zf(a){if(this.oh!=null){var b=this.oh;
if(a.Lg==="SOLID")a={selection:{type:"solid",hexString:a.selection.hexString}};else throw new L({code:"internal_error",message:`Unknown result selection type ${a.Lg}`});b.call(this,a)}}async findFonts(a={}){this.B("findFonts");cc(a.fontRefs);return{fonts:(await this.A.findFonts(new Qt(a))).fonts.map(du)}}async requestFontSelection(a={}){this.B("requestFontSelection");a=await this.A.requestFontSelection(new Ut(a));return a.type==="ABORTED"?{type:"aborted"}:{type:"completed",font:du(a.font)}}ld({qc:a,
...b}){return async()=>{if(!a){var c=this.A;a:{var d=b.type;switch(d){case "image":d=new At({...b});break a;case "video":d=new Bt({...b});break a;case "audio":d=new Ct({...b});break a;default:throw new L({code:"internal_error",message:`Unexpected options type '${d}'.`});}}c=await Vb(c,d);a:switch(d=c.type,d){case "DONE":c={type:"done"};break a;case "FAILED":c={type:"failed",reason:{type:c.tc}};break a;default:throw new L({code:"internal_error",message:`Unexpected result type '${d}'.`});}d=c.type;
switch(d){case "done":break;case "failed":throw $b(c.reason.type,b.type,this.Ec);default:throw new L({code:"internal_error",message:`Unexpected upload result type '${d}'.`});}}}}B(a){this.j.B(st({namespace:"asset",client:"Content",method:a}))}constructor(a,b,c,d){this.Y=b;this.j=c;this.Ec=d;ku(this);this.A=new Zt(a);this.ld=this.ld.bind(this);Zb(a,{Zf:async e=>{await this.Zf(e)}})}};
({e:[ku]}=jr(ec,[[M("asset.v2.getTemporaryUrl"),2,"getTemporaryUrl"],[M("asset.v2.upload"),2,"upload"],[M("asset.v2.openColorSelector"),2,"openColorSelector"],[M("asset.v2.findFonts"),2,"findFonts"],[M("asset.v2.requestFontSelection"),2,"requestFontSelection"]],[]));Sb(ec.prototype);var fc=class{async getTemporaryUrl(a){const b=await (async()=>{const c=a.type;switch(c){case "IMAGE":return this.Ub.getTemporaryUrl({...a,type:"image"});case "VIDEO":return this.Ub.getTemporaryUrl({...a,type:"video"});default:throw new L({code:"failed_precondition",message:`Invalid getTemporaryUrl options type (${c}).`});}})();switch(b.type){case "image":return{...b,type:"IMAGE"};case "video":return{...b,type:"VIDEO"};default:throw new L({code:"internal_error",message:"Invalid response."});}}async upload(a){const b=
a.type;switch(b){case "IMAGE":return this.Ub.upload({...a,type:"image",aiDisclosure:"none"});case "VIDEO":return this.Ub.upload({...a,type:"video",aiDisclosure:"none"});case "AUDIO":return this.Ub.upload({...a,type:"audio",aiDisclosure:"none"});default:throw new L({code:"failed_precondition",message:`Invalid upload options type (${b}).`});}}async openColorSelector(a,b){return this.Ub.openColorSelector(a,b)}async findFonts(a={}){return this.Ub.findFonts(a)}async requestFontSelection(a={}){a=await this.Ub.requestFontSelection(a);
switch(a.type){case "completed":return{...a,type:"COMPLETED"};case "aborted":return{...a,type:"ABORTED"};default:throw new L({code:"internal_error",message:"Invalid response."});}}constructor(a){this.Ub=a}};var lu=class{constructor(a,b){this.page=a;this.Pe=b;this.group=async({elements:c})=>{eb(this.page.type==="absolute","bad_request","Page type must be absolute");eb(Array.isArray(c),"bad_request","The input elements must be an array");eb(c.length>=2,"bad_request","At least two elements are required to create a group");eb(c.length===(new Set(c)).size,"bad_request","Duplicate elements detected");eb(c.every(f=>f.type!=="unsupported"&&f.type!=="group"),"bad_request","The following element types cannot be grouped: unsupported, group");
const d=this.page.elements.toArray();c={type:"GROUP",mk:c.map((f,g)=>{f=d.indexOf(f);J(f!==-1,"bad_request",`Element#${g} does not exist in the current page`);return f})};const e=await this.Pe(c);J(e.type===c.type,"internal_error","Mismatch input and output types");c=e.Yf;c=K(this.page.elements.toArray()[c],"internal_error",`Element#${c} does not exist`);J(c.type==="group","internal_error",`Unexpected element type: ${c.type}`);return c};this.ungroup=async({element:c})=>{eb(this.page.type==="absolute",
"bad_request","Page type must be absolute");eb(!!c&&c.type==="group","bad_request","The input element must be a group");var d=this.page.elements.toArray().findIndex(g=>g===c);J(d!==-1,"bad_request","The group element does not exist in the current page");d={type:"UNGROUP",Yf:d};const e=await this.Pe(d);J(e.type===d.type,"internal_error","Mismatch input and output types");d=e.An;const f=this.page.elements.toArray();return d.map(g=>K(f[g],"internal_error",`Element#${g} does not exist`))}}};var qc=["fontRef","fontSize","textAlign","listLevel","listMarker"],xc=new Set(qc),od=a=>Object.entries(a).some(([b,c])=>xc.has(b)&&c!=null);var mu=class{formatText(a,b){const {bounds:{index:c,length:d},formatting:e}=Pc({type:"format",bounds:sc(this,a),formatting:b});if(d!==0){a=c+d;var f=lc(this,Math.max(a-1,0));oc(this,c,e);this.attributes.slice(Math.min(c+1,a),a).forEach((g,h)=>{pc(this,c+1+h,b)});a<this.D.length&&this.attributes[a]==null&&pc(this,a,f)}}formatParagraph(a,b){const {bounds:{index:c,length:d},formatting:e}=Pc({type:"formatParagraph",bounds:sc(this,a),formatting:b});a=c===this.D.length&&this.D.endsWith("\n");b=this.D.length===
0;if(!a&&!b){a=Math.max(c+d-1,0);b=this.D.slice(0,c).lastIndexOf("\n");var f=b===-1?0:b+1;a=this.D.indexOf("\n",a);b=a===-1?this.D.length-1:a;var g=lc(this,b+1);pc(this,f,e);this.attributes.slice(f+1,b+1).forEach((h,l)=>{pc(this,f+1+l,e)});if(b<this.D.length-1)if(a=b+1,this.attributes.hasOwnProperty(a)){const h=lc(this,b);b=this.attributes.slice(a);g=b.findIndex(l=>l!=null&&!kc(l,h));mc(this,{index:a,length:g===-1?b.length:g})}else pc(this,a,g)}}appendText(a,b){({Sb:a}=Pc({type:"append",Sb:{text:a,
formatting:b}}));return tc(this,this.D.length,a.text,a.formatting)}replaceText(a,b,c){const {bounds:d,wb:e}=Pc({type:"replace",bounds:sc(this,a),wb:[{text:b,formatting:c}]});let f;d.length>0&&(f=lc(this,d.index),wc(this,d));return b.length===0?{bounds:{index:d.index,length:0}}:tc(this,d.index,e[0].text,e[0].formatting,f)}readPlaintext(){return this.D}readTextRegions(){let a=0;const b=this.attributes.reduce((c,d,e)=>{c.length>0?c[c.length-1].text=this.D.slice(a,e):e>0&&c.push({text:this.D.slice(a,
e)});const f=d!=null&&Object.keys(d).length>0;c.push({text:"",...(f?{formatting:d}:{})});a=e;return c},[]);if(b.length>0)b[b.length-1].text+=this.D.slice(a);else if(this.D.length>0)b[0]={text:this.D};else return[];return b}constructor(a,b){this.O=a;this.D="";this.attributes=[];b.forEach(({text:c,formatting:d})=>{this.attributes[this.D.length]=d!==null&&d!==void 0?d:{};this.D+=c})}};var fd=/^Y[A-Za-z0-9_-]{10}:[0-9]+$/,ci="normal thin extralight light medium semibold bold ultrabold heavy".split(" "),gd="none disc circle square decimal lower-alpha lower-roman checked unchecked".split(" ");var yc=/^(?:xn--)?[a-zA-Z0-9]+$/i,zc=/^(?!:\/\/)([a-zA-Z0-9]([a-zA-Z0-9-_]*[a-zA-Z0-9])?)$/i,qd=/^(tel|sms|mailto|shortcuts):/i,pd=/^(https?|ftp|tel|sms|mailto|shortcuts):(\/\/|[^/])[^ ]+(\/|$)|^[^: ]+(\/|$)|^[\w.]+:\d+(\/|$)/i;var Wc=/data:.*,.*/,Xc=/^data:image\/svg\+xml;base64,/i,Bc=/^https?:\/\/[^\s]+\s*$/,Hc=/^#[0-9a-f]{6}$/i,nu=/^M[a-zA-Z0-9_-]{10}:[0-9]+$/,ou=/^M[a-zA-Z0-9_-]{10,}:[0-9]+$/,pu=/^V[A-Za-z0-9_-]{10}$/,qu=/^V[A-Za-z0-9_-]{10,}$/,ru=/^a[A-Za-z0-9_-]{10}$/,jd=ci.map(a=>`"${a}"`).join(" | "),hd=gd.map(a=>`"${a}"`).join(" | "),su=class{get ag(){return this.mode==="REAL"?nu:ou}get ah(){return this.mode==="REAL"?pu:qu}constructor(a,b="REAL"){this.Y=a;this.mode=b;this.xl=c=>{if(typeof c!=="string")return!1;
Q(this.ag.test(c),"invalid image media reference","invalid_element_state");return!0};this.Bl=c=>{if(typeof c!=="string")return!1;Q(this.ah.test(c),"invalid image media reference","invalid_element_state");return!0}}};var tu=Object.freeze({mediaContainer:void 0,colorContainer:void 0});Object.freeze({flipX:!1,flipY:!1});var uu=Object.freeze({weight:0,color:{type:"solid",color:"#000000"}}),vu=Object.freeze({top:0,left:0,width:0,height:0,rotation:0,transparency:0,locked:!1}),wu=Object.freeze({...vu,type:"rect",fill:{...tu},stroke:{...uu}}),xu=Object.freeze({...vu,type:"shape",viewBox:{top:0,left:0,width:0,height:0},paths:[]}),yu=Object.freeze({...vu,type:"embed"}),zu=Object.freeze({...vu,height:100,type:"text"});var Au={next:()=>{},error:()=>{}},Bu=class{next(a){this.closed||this.o.next(this.f(a))}constructor(a,b){this.o=a;this.f=b;this.closed=!1}},Cu=class extends Bu{error(a){this.closed||(this.closed=!0,this.o.error(a))}constructor(a,b){super(a,b);this.o=a;this.f=b}},Du=class extends Bu{complete(){this.closed||(this.closed=!0,this.o.complete())}constructor(a,b){super(a,b);this.o=a;this.f=b}},Eu=class{next(a){this.rc.call(this.Ra,a)}error(a){this.onError.call(this.Ra,a)}constructor(a,b,c){this.Ra=a;this.rc=
b;this.onError=c}},Fu=class{next(a){this.rc.call(this.Ra,a)}complete(){this.ng.call(this.Ra)}constructor(a,b,c){this.Ra=a;this.rc=b;this.ng=c}};var rd=class{create(a,b=Au){a=this.V(a);this.connect(a,b);return a}};var zd=class{connect(a){ia(this.S==null);this.S=a;return new Fu(this,this.og,this.complete)}og(a){this.S&&this.Ta(a)}complete(){this.S&&(this.S=void 0)}error(a){this.S&&(this.S.error(a),this.S=void 0)}Kb(a){this.jc||(this.jc=new Eu(this,this.mg,this.error));return new Cu(this.jc,a)}mg(a){this.S&&this.S.next(a)}ka(a){var b;this.Ta(a);(b=this.S)===null||b===void 0||b.next(a)}constructor(){this.jc=this.S=void 0}};var yd=Symbol("$impl"),Gu=class extends zd{snapshot(){const a=this.Xd,b=this.uc,c=this.Xb,d={};for(const e in a)d[e]=this.values[e];for(const e in b)d[e]=b[e].snapshot(this.J[e]);for(const e in c)d[e]=c[e].snapshot(this.attributes[e]);return d}Ta(a){for(const b in a)a[b]!=null&&(b in this.uc?this.Hi[b].next(a[b]):b in this.Xb&&this.jh[b].next(a[b]))}destroy(a){var b=this.Xd,c=this.uc;const d=this.Xb;for(const e in b)b[e].pe(this.values[e],a[e]);for(const e in c)b=this.Hi[e],c[e].destroy(this.J[e],
a[e]),b.complete();for(const e in d)c=this.jh[e],d[e].destroy(this.attributes[e],a[e]),c.complete()}getAttribute(a){return this.attributes[a].value}setAttribute(a,b){this.attributes[a].value=b}Jf(a){const b={...this.values,...this.J};Object.defineProperties(b,a);Object.defineProperty(b,yd,{enumerable:!1,writable:!1,value:this});return b}constructor(a,b,c,d){super();this.Xd=a;this.uc=b;this.Xb=c;this.values=ud(a,(e,f)=>e.kd(d[f]));a=ud(b,(e,f)=>{const g=wd(this,f),{Rc:h,mutable:l}=td(e,d[f],g);return{ref:l,
gb:h,Xa:g}});this.J=ud(a,e=>e.ref);this.Hi=ud(a,e=>e.gb);ud(a,e=>e.Xa);c=ud(c,(e,f)=>{const g=xd(this,f),{Rc:h,mutable:l}=td(e,d[f],g);return{ref:l,gb:h,Xa:g}});this.attributes=ud(c,e=>e.ref);this.jh=ud(c,e=>e.gb);ud(c,e=>e.Xa)}},be=class extends rd{V(a){return(new Gu(this.values,this.J,this.attributes,a)).Jf(this.yg)}Ac(a){return a[yd]}connect(a,b){return this.Ac(a).connect(b)}snapshot(a){return this.Ac(a).snapshot()}destroy(a,b){this.Ac(a).destroy(b)}Wa({values:a={},J:b={},attributes:c={}}){return new be({...this.values,
...a},{...this.J,...b},{...this.attributes,...c})}constructor(a,b,c){super();this.values=a;vd(a,{...b},{...c});this.J=ud(b,sd);this.attributes=ud(c,sd);this.yg=ud(c,(d,e)=>({enumerable:!0,get(){return this[yd].getAttribute(e)},set(f){this[yd].setAttribute(e,f)}}))}};var wg=class{createEmbedElement(a){Ad(a);const {url:b,...c}=Bd({...yu,...a});Cc(b);return{...c,url:b}}createRectElement(a){var b,c,d,e;Ad(a);const f={mediaContainer:((b=a.fill)===null||b===void 0?void 0:b.mediaContainer)&&Cd(this,a.fill.mediaContainer),colorContainer:void 0};if((c=a.fill)===null||c===void 0?0:c.colorContainer)f.colorContainer=Dd(a.fill.colorContainer);return{...Bd({...wu,...a}),stroke:{weight:((d=a.stroke)===null||d===void 0?void 0:d.weight)||0,colorContainer:((e=a.stroke)===null||
e===void 0?0:e.colorContainer)?Dd(a.stroke.colorContainer):uu.color},fill:f}}createShapeElement(a){Ad(a);const b=Bd({...xu,...a});Ec(b.viewBox);return{...b,paths:a.paths.map(c=>{var d,e,f;return{d:c.d,fill:{colorContainer:((d=c.fill)===null||d===void 0?void 0:d.colorContainer)&&Dd(c.fill.colorContainer),mediaContainer:((e=c.fill)===null||e===void 0?void 0:e.mediaContainer)&&Cd(this,c.fill.mediaContainer),isMediaEditable:!((f=c.fill)===null||f===void 0||!f.isMediaEditable)},stroke:c.stroke?{weight:c.stroke.weight,
colorContainer:Dd(c.stroke.colorContainer)}:{weight:uu.weight,colorContainer:uu.color}}})}}createRichtextRange(){return new mu(this.O,[])}createTextElement(a){Ad(a);return{...Bd({...zu,...a}),text:{regions:a.text.regions}}}constructor(a){this.O=a}};var Hu=a=>typeof a==="number"&&Number.isSafeInteger(a),Iu=a=>typeof a==="number"&&Number.isFinite(a),Sd=class{constructor(a,b,c,d,e,f,g,h,l,n){var r=ge;this.value=ee;this.array=r;this.fa=a;this.list=b;this.pi=c;this.optional=d;this.literal=e;this.regexp=f;this.box=g;this.zc=h;this.Gi=l;this.N=n;this.number=(t,w)=>{k(Iu(t)&&Iu(w)&&t<=w,"Invalid number: {}");return this.value(x=>Iu(x)&&t<=x&&x<=w)};this.De=(t,w)=>{k(Hu(t)&&Hu(w)&&t<=w,"Invalid number: {}");return this.value(x=>Hu(x)&&t<=x&&x<=w)};this.rl=
this.De(-2147483648,2147483647);this.value(Hu);this.Qf=this.value(Iu);this.boolean=this.value(t=>typeof t==="boolean");this.string=this.value(t=>typeof t==="string");this.char=this.value(t=>typeof t==="string"&&t.length===1);this.value(t=>Iu(t)&&0<t&&t<=Number.MAX_VALUE);this.De(1,2147483647);this.Id=this.number(0,Number.MAX_VALUE);this.De(0,2147483647);this.De(0,Number.MAX_SAFE_INTEGER);this.array(this.Id);this.array(this.string);this.gm=t=>this.fa(this.pi(t));this.fa(this.string);this.Yb=this.fa(this.boolean);
this.fa(this.rl);this.Gh=this.fa(this.Qf);this.ki=this.fa(this.Id)}};var Fd=class{toString(){return`U(${this.delta})`}constructor(a){this.delta=a;this.type=0}},Ju=class{toString(){return`R(${this.oldState}, ${this.newState})`}constructor(a,b){this.oldState=a;this.newState=b;this.type=1}};var Ku=class extends zd{Ta(a){if(a!=null)switch(a.type){case 1:k(this.qj.xa(this._value,a.oldState));this._value=a.newState;break;case 0:k(a.delta==null);break;default:throw new m(a);}}get value(){return this._value}set value(a){this.qj.kd(a);this.ka(new Ju(this._value,a))}constructor(a,b){super();this.qj=a;this._value=b}},Td=class extends rd{V(a){a=this.type.kd(a);return new Ku(this.type,a)}connect(a,b){return a.connect(b)}snapshot(a){return a.value}destroy(a,b){this.type.pe(a.value,b)}constructor(a){super();
this.type=a}},Od=class extends zd{instantiate(a){const b=this.Kb(Gd),{mutable:c,Rc:d}=td(this.type,a,b);this.ce=c;this.gb=d;this.Xa=b}destroy(a){var b=this.gb;this.type.destroy(this.ce,a);b.complete()}Ta(a){if(a!=null)switch(a.type){case 0:this.gb.next(a.delta);break;case 1:this.destroy(a.oldState);this.instantiate(a.newState);break;default:throw Error();}}get ref(){return this.ce}set(a){this.ka(new Ju(this.type.snapshot(this.ce),a))}constructor(a,b){super();this.type=sd(a);a=this.Kb(Gd);const {mutable:c,
Rc:d}=td(this.type,b,a);this.ce=c;this.gb=d;this.Xa=a}},Zd=class extends rd{V(a){return new this.nf(this.type,a)}connect(a,b){return a.connect(b)}snapshot(a){return this.type.snapshot(a.ref)}destroy(a,b){this.type.destroy(a.ref,b)}constructor(a,b){super();this.nf=b;this.type=sd(a)}};var Lu={type:0,length:1},Mu={type:1,length:1},Nu=class{constructor(a,b,c,d){this.H=a;this.pre=b;this.post=c;this.Dg=d}},Ld=class{ub(a){if(this.mode!==a){switch(this.mode){case void 0:break;case 0:var b=this.acc;this.H.push(b===1?Lu:{type:0,length:b});this.pre+=this.acc;this.post+=this.acc;this.acc=0;break;case 1:b=this.acc;this.H.push(b===1?Mu:{type:1,length:b});this.post+=this.acc;this.acc=0;break;case 2:case 3:break;default:throw new m(this.mode);}this.mode=a}}accumulate(a,b=1){k(b>=0);b&&(this.ub(a),
this.acc+=b);return this}append(a,b){switch(a.type){case 0:return this.I(a.length);case 1:return this.expand(a.length);case 2:var c=a.shift;if(!b&&(b=a.state,c&&c.N===c.ta&&(c=void 0,a={type:2,state:b,shift:void 0}),b==null&&c==null))return this.expand();this.ub(a.type);c&&Jd(this,c);this.H.push(a);this.post++;return this;case 3:c=a.shift;if(!b)if(b=a.delta,c&&c.N===c.ta&&(c=void 0,a=Id(b)),b==null){if(c==null)return this.I()}else if(b.type===1&&b.oldState==null&&b.newState==null&&c==null)return this.I();
this.ub(a.type);c&&Jd(this,c);this.H.push(a);this.pre++;this.post++;return this;default:throw new m(a);}}I(a){return a==null||typeof a==="number"?this.accumulate(0,a):this.append(Id(void 0,a))}expand(a){return a==null||typeof a==="number"?this.accumulate(1,a):this.append({type:2,state:void 0,shift:a})}insert(a,b){return this.append({type:2,state:a,shift:b})}update(a,b){return this.append(Id(a!=null?new Fd(a):void 0,b))}pj(a){return this.append(Id(new Ju(void 0,a)))}Ae(a){return this.append(Id(new Ju(a)))}Cb(a,
b,c){return this.append(Id(new Ju(a,b),c))}build(a){this.mode!==0&&this.ub();if(a&&a.Sq())return a.cp(this.H);if(!this.Ue&&!this.Bg)return new Nu(this.H,this.pre,this.post,0);a=this.H;const b=ma(this.Ue);var c=[...b.keys()];if(c.some((g,h)=>g!==h)){const g=new Map;c.forEach((h,l)=>g.set(h,l));for(const h of b.values())switch(c=a[h],c.type){case 2:var d=c.shift,e=g.get(d.N),f=g.get(d.ta);if(e!==d.N||f!==d.ta)a[h]={type:2,state:c.state,shift:{N:e,ta:f}};break;case 3:d=c.shift;e=g.get(d.N);f=g.get(d.ta);
if(e!==d.N||f!==d.ta)a[h]=Id(c.delta,{N:e,ta:f});break;case 0:case 1:throw Error();default:throw new m(c);}}return new Nu(a,this.pre,this.post,b.size)}constructor(){this.H=[];this.acc=this.post=this.pre=0;this.Bg=this.Ue=this.mode=void 0}};var Ou;Ou=Symbol.iterator;
var Pd=class extends zd{get Sh(){if(this.Zd)return this.Zd;const a=new Map;this.oa.forEach((b,c)=>b&&a.set(b.value,c));return this.Zd=a}get pa(){return this.Yd||(this.Yd=this.oa.filter(Hd))}get(a){return(a=this.oa[a])&&a.value}snapshot(){const a=[];this.oa.forEach((b,c)=>{b!=null&&(a[c]=this.type.snapshot(b.value))});return a}destroy(a){let b=0;this.oa.forEach((d,e)=>{d!=null&&(k(e in a),this.type.destroy(d.value,a[e]),b++)});const c=a.reduce(d=>d+1,0);k(b===c)}Ta(a){var b=!1;const c=this.oa,d=new Map,
e=new Map;var f=0;c.length<a.pre&&(this.Yd=void 0,c.length=a.pre);for(var g of a.H)switch(g.type){case 0:f+=g.length;break;case 1:c.splice(f,0,...Array(g.length));f+=g.length;b=!0;break;case 2:var h=g.state;b=g.shift;c.splice(f,0,h!=null?Md(this,h):Array(1)[0]);b&&(e.set(b.N,c[f]),d.set(b.ta,f));f++;b=!0;break;case 3:var l=g.delta;h=g.shift;if(l)switch(l.type){case 0:l=l.delta;l!=null&&ma(c[f]).to.next(l);break;case 1:var n=l.oldState;b=l.newState;if(n==null)ia(c[f]==null);else{l=n;n=ma(c[f]);var r=
n.to;this.type.destroy(n.value,l);r.complete()}c[f]=b!=null?Md(this,b):Array(1)[0];b=!0;break;default:throw new m(l);}h&&(e.set(h.N,c[f]),d.set(h.ta,f),b=!0);f++;break;default:throw new m(g);}ia(e.size===a.Dg);ia(d.size===a.Dg);for(f=0;f<a.Dg;f++)ia(e.has(f)),g=ma(d.get(f)),c[g]=e.get(f)||Array(1)[0];for(;c.length&&c[c.length-1]==null;)c.length--;b&&(this.Zd=this.Yd=void 0)}get empty(){return!this.pa.length}count(){return this.pa.length}toArray(){return this.pa.map(a=>a.value)}[Ou](){return this.toArray()[Symbol.iterator]()}get Rk(){const a=
this.pa[0];return a&&a.value}get Cl(){const a=this.pa[this.pa.length-1];return a&&a.value}first(a){if(!a)return this.Rk;const b=this.pa.find(c=>a(c.value));return b&&b.value}last(a){if(!a)return this.Cl;const b=this.pa;for(let c=b.length-1;c>=0;c--){const d=b[c];if(a(d.value))return d.value}}next(a,b){const c=this.oa;for(a=Kd(this,a)+1;a<c.length;a++){const d=c[a];if(d&&(!b||b(d.value)))return d.value}}previous(a,b){const c=this.oa;for(a=Kd(this,a)-1;a>=0;a--){const d=c[a];if(d&&(!b||b(d.value)))return d.value}}has(a){return this.Sh.has(a)}set(a,
b){var c;k(a>=0);a>=this.oa.length&&(this.oa.length=a+1);const d=(c=this.oa[a])===null||c===void 0?void 0:c.value;c=d!=null?this.type.snapshot(d):void 0;this.ka((new Ld).I(a).Cb(c,b).build());return this.oa[a].value}replace(a,b){a=Kd(this,a);return this.set(a,b)}append(a){return this.insertBefore(void 0,a)}prepend(a){return this.insertAfter(void 0,a)}insertAfter(a,b){return Nd(this,a?Kd(this,a)+1:0,b)}insertBefore(a,b){return Nd(this,a?Kd(this,a):this.oa.length,b)}delete(a){a=(new Ld).I(Kd(this,a)).Ae(this.type.snapshot(a)).build();
this.ka(a)}moveTo(a,b){const c=Kd(this,b);if(c===a)return b;this.ka(c<a?(new Ld).I(c).I({N:0,ta:1}).I(a-c-1).expand({N:1,ta:0}).build():(new Ld).I(a).expand({N:0,ta:1}).I(c-a).I({N:1,ta:0}).build());return b}moveAfter(a,b){a=a!=null?Kd(this,a):-1;this.moveTo(a+1,b)}moveBefore(a,b){a=a!=null?Kd(this,a):this.oa.length;this.moveTo(a,b)}map(a){return this.pa.map(({value:b,id:c},d)=>a(b,d,c))}flatMap(a){return this.pa.flatMap(({value:b,id:c},d)=>a(b,d,c))}filter(a){return this.pa.filter((b,c)=>a(b.value,
c,b.id)).map(b=>b.value)}forEach(a){this.pa.forEach((b,c)=>b!=null&&a(b.value,c,b.id))}reduce(a,b){return this.pa.reduce((c,d,e)=>a(c,d.value,e,d.id),b)}some(a){return this.pa.some((b,c)=>a(b.value,c,b.id))}every(a){return this.pa.every((b,c)=>a(b.value,c,b.id))}constructor(a,b){super();this.Rl=0;this.Zd=this.Yd=void 0;this.type=sd(a);k(!b.length||b[b.length-1]!=null);this.oa=b.map(c=>Md(this,c))}},Ud=class extends rd{dc(){return new Ld}Ma(a){return a}V(a){return new this.nf(this.type,a)}connect(a,
b){return this.Ma(a).connect(b)}snapshot(a){return this.Ma(a).snapshot()}destroy(a,b){this.Ma(a).destroy(b)}constructor(a,b){super();this.type=a;this.nf=b}};var Pu={next:a=>k(a==null),complete:()=>{}},Wd=class extends rd{V(a){return a!=null?this.type.V(a):void 0}connect(a,b){if(a==null)return Pu;a=this.type.connect(a,b);return new Du(a,ma)}snapshot(a){return a!=null?this.type.snapshot(a):void 0}destroy(a,b){if(a!=null&&b!=null)this.type.destroy(a,b);else if(a!=null||b!=null)throw Error();}constructor(a){super();this.type=sd(a)}};var $d=class extends rd{create(a,b){return super.create(a,b)}V(a){const b=this.Fh(a);return this.Kc[b].V(a)}connect(a,b){const c=this.Of(a);a=this.Kc[c].connect(a,new Cu(b,this.hm[c]));return new Du(a,this.jl[c])}snapshot(a){const b=this.Of(a);return this.Kc[b].snapshot(a)}destroy(a,b){const c=this.Of(a),d=this.Fh(b);k(c===d);this.Kc[c].destroy(a,b)}constructor(a,b,c){super();this.Fh=b;this.Of=c;this.Kc=ud(a,sd);this.hm=ud(this.Kc,(d,e)=>f=>({key:e,value:f}));this.jl=ud(this.Kc,(d,e)=>f=>{la(e,f.key);
return f.value})}};var Qu=class{kd(a){k(this.Fa(a));return a}pe(a,b){if(!this.xa(a,b))throw Error(`Invalid argument: ${this.stringify(a)} != ${this.stringify(b)}`);}},Ru=class extends Qu{xa(a,b){return a===b}stringify(a){return JSON.stringify(a)}},de=class extends Ru{constructor(a){super();this.Fa=a}},Xd=class extends Ru{Fa(a){return a===this.value}constructor(a){super();this.value=a}},Yd=class extends Ru{Fa(a){return typeof a==="string"&&this.regexp.test(a)}constructor(a){super();this.regexp=a}},fe=class extends Qu{Fa(a){return a.every(b=>
this.type.Fa(b))&&(!this.cd||this.cd(a))}xa(a,b){return a.length===b.length&&a.every((c,d)=>d in b&&this.type.xa(c,b[d]))&&a.reduce(c=>c+1,0)===b.reduce(c=>c+1,0)}stringify(a){return a.length?"[ "+a.map(b=>this.type.stringify(b)).join(", ")+" ]":"[]"}constructor(a,b){super();this.type=a;this.cd=b}},Vd=class extends Qu{Fa(a){return a==null||this.type.Fa(a)}xa(a,b){return a!=null?b!=null&&this.type.xa(a,b):b==null}stringify(a){return a!=null?this.type.stringify(a):"undefined"}constructor(a){super();
this.type=a}},ae=class extends Qu{Fa(a){return this.keys.every(b=>this.fields[b].Fa(a[b]))&&(!this.cd||this.cd(a))}xa(a,b){return this.keys.every(c=>this.fields[c].xa(a[c],b[c]))}stringify(a){return this.keys.length?"{ "+this.keys.map(b=>`${b}: ${this.fields[b].stringify(a[b])}`).join(", ")+" }":"{}"}constructor(a,b){super();this.fields=a;this.cd=b;this.keys=Object.keys(this.fields)}};var Qd=class extends Od{set(a){super.set(this.lf(a))}lf(a){let b;try{b=this.type.snapshot(a)}catch(c){return a}J(b==null,"bad_request","Cannot use `set` with an existing value");return a}};var Rd=class extends Pd{insertAfter(a,b){return super.insertAfter(a,this.lf(b))}insertBefore(a,b){return super.insertBefore(a,this.lf(b))}lf(a){let b;try{b=this.type.snapshot(a)}catch(c){return a}J(b==null,"bad_request","Cannot use `insert` with an existing value");return a}};var Su=class extends zd{Ta(a){if(!this.Xh){if(a.type===0)var b=new mu(this.O,a.state.regions);else if(a.type===1){b=new mu(this.O,this.state.regions);for(const c of a.operations)switch(c.op.type){case 2:b.appendText(c.op.jb.text,c.op.jb.formatting);break;case 0:b.formatText(c.op.bounds,c.op.formatting);break;case 1:b.formatParagraph(c.op.bounds,c.op.formatting);break;case 3:b.replaceText(c.op.bounds,c.op.jb.text,c.op.jb.formatting);break;default:throw new L({code:"internal_error",message:"Invalid operation"});
}}else throw new L({code:"internal_error",message:"Invalid delta"});this.state={regions:b.readTextRegions()}}}appendText(a,b){const c=a.length;this.ka({type:1,operations:[{op:{type:2,jb:{text:a,formatting:b}}}]});return{bounds:{index:c,length:a.length}}}formatParagraph(a,b){this.ka({type:1,operations:[{op:{type:1,formatting:b,bounds:a}}]})}formatText(a,b){this.ka({type:1,operations:[{op:{type:0,formatting:b,bounds:a}}]})}readPlaintext(){return this.state.regions.map(a=>a.text).join("")}readTextRegions(){return(new mu(this.O,
this.state.regions)).readTextRegions()}snapshot(){return{regions:this.readTextRegions()}}destroy(a){fb(this.readPlaintext(),a.regions.map(b=>b.text).join(""));return this.Xh=!0}replaceText(a,b,c){this.ka({type:1,operations:[{op:{type:3,jb:{text:b,formatting:c},bounds:a}}]});return{bounds:{index:a.index,length:b.length}}}constructor(a,b){super();this.state=a;this.O=b;this.Xh=!1}},me=class extends rd{Ma(a){return a}V(a){return new Su(a,this.O)}connect(a,b){return this.Ma(a).connect(b)}snapshot(a){return this.Ma(a).snapshot()}destroy(a,
b){this.Ma(a).destroy(b)}constructor(a){super();this.O=a}};var Tu=C(()=>({width:S(1),height:S(2)}));var Uu=C(()=>({id:W(1),version:T(2)}));var Vu=C(()=>({type:v(1,"IMAGE"),media:y(1,Uu),flipX:Y(2),flipY:Y(3)}));var Wu=C(()=>({type:v(2,"VIDEO"),video:W(1),flipX:Y(2),flipY:Y(3)}));var Xu=D(()=>({type:[1,Vu,2,Wu]}),()=>({}));var Uf=C(()=>({type:v(1,"COLOR"),color:W(1)}));var Vf=C(()=>({type:v(2,"GRADIENT")}));var Yu=D(()=>({type:[1,Uf,2,Vf]}),()=>({}));var bg=C(()=>({mediaContainer:z(1,Xu),colorContainer:z(2,Yu)}));var Zu=()=>({top:S(15),left:S(16),width:S(17),height:S(18),rotation:S(19),transparency:S(20),locked:Y(21)});var Xf=C(()=>({weight:S(1),colorContainer:y(2,Yu)}));var cg=C(()=>({...Zu(),type:v(1,"RECT"),fill:y(31,bg),stroke:z(32,Xf)}));var gg=C(()=>({top:S(1),left:S(2),width:S(3),height:S(4)}));var $u=C(()=>({isMediaEditable:Y(3),mediaContainer:z(1,Xu),colorContainer:z(2,Yu)}));var av=C(()=>({d:W(1),fill:y(2,$u),stroke:z(3,Xf)}));var fg=C(()=>({...Zu(),type:v(2,"SHAPE"),viewBox:y(31,gg),paths:A(32,av),zi:Kr(33)}));var og=C(()=>({...Zu(),type:v(3,"GROUP"),contents:A(31,bv),ph:Kr(32)}));var cv=C(()=>({...Zu(),type:v(4,"EMBED"),url:W(31)}));var Le=C(()=>({fontRef:X(1),fontSize:V(2),textAlign:X(3),color:X(4),fontWeight:X(5),fontStyle:X(6),decoration:X(7),strikethrough:X(8),link:X(9),listLevel:V(10),listMarker:X(11)}));var cf=C(()=>({D:W(1),formatting:z(2,Le)}));var kg=C(()=>({...Zu(),type:v(5,"TEXT"),wb:A(31,cf)}));var dv=C(()=>({...Zu(),type:v(6,"UNSUPPORTED")}));var bv=D(()=>({type:[1,cg,2,fg,3,og,4,cv,5,kg,6,dv]}),Zu);var ev=C(()=>({locked:Y(15),type:v(1,"FIXED"),dimensions:z(31,Tu),background:y(32,bg),elements:A(33,bv),nk:Kr(34)}));var fv=C(()=>({locked:Y(15),type:v(2,"UNSUPPORTED")}));var gv=D(()=>({type:[1,ev,2,fv]}),()=>({locked:Y(15)}));var se=C(()=>({N:T(1),ta:T(2)}));var zf=C(()=>({type:v(1,"REPLACE"),oldState:z(1,Xu),newState:z(2,Xu)}));var hv=C(()=>({oldState:Y(1),newState:Y(2)}));var Bf=C(()=>({type:v(1,"IMAGE"),flipX:z(1,hv),flipY:z(2,hv)}));var Cf=C(()=>({type:v(2,"VIDEO"),flipX:z(1,hv),flipY:z(2,hv)}));var iv=D(()=>({type:[1,Bf,2,Cf]}),()=>({}));var Af=C(()=>({type:v(2,"UPDATE"),delta:z(1,iv)}));var jv=D(()=>({type:[1,zf,2,Af]}),()=>({}));var kv=C(()=>({type:v(1,"REPLACE"),oldState:z(1,Yu),newState:z(2,Yu)}));var lv=C(()=>({oldState:W(1),newState:W(2)}));var wf=C(()=>({type:v(1,"COLOR"),color:z(1,lv)}));var mv=C(()=>({type:v(2,"GRADIENT")}));var nv=D(()=>({type:[1,wf,2,mv]}),()=>({}));var vf=C(()=>({type:v(2,"UPDATE"),delta:z(1,nv)}));var ov=D(()=>({type:[1,kv,2,vf]}),()=>({}));var Ef=C(()=>({mediaContainer:z(1,jv),colorContainer:z(2,ov)}));var pv=C(()=>({type:v(1,"RETAIN"),length:T(11)}));var qv=C(()=>({type:v(2,"INSERT"),state:z(11,bv),shift:z(12,se)}));var rv=C(()=>({oldState:S(1),newState:S(2)}));var sv=()=>({top:z(15,rv),left:z(16,rv),width:z(17,rv),height:z(18,rv),rotation:z(19,rv),transparency:z(20,rv),locked:z(21,hv)});var tv=C(()=>({type:v(1,"REPLACE"),oldState:z(1,Xf),newState:z(2,Xf)}));var Jf=C(()=>({weight:z(1,rv),colorContainer:z(2,ov)}));var If=C(()=>({type:v(2,"UPDATE"),delta:z(1,Jf)}));var uv=D(()=>({type:[1,tv,2,If]}),()=>({}));var vv=C(()=>({...sv(),type:v(1,"RECT"),fill:z(31,Ef),stroke:z(32,uv)}));var wv=C(()=>({oldState:y(1,gg),newState:y(2,gg)}));var xv=C(()=>({type:v(1,"RETAIN"),length:T(11)}));var yv=C(()=>({type:v(2,"INSERT"),state:z(11,av),shift:z(12,se)}));var zv=C(()=>({isMediaEditable:z(3,hv),mediaContainer:z(1,jv),colorContainer:z(2,ov)}));var Av=C(()=>({d:z(1,lv),fill:z(2,zv),stroke:z(3,uv)}));var Bv=C(()=>({type:v(3,"UPDATE"),delta:z(11,Av),shift:z(12,se)}));var Cv=C(()=>({type:v(4,"CHANGE"),oldState:z(11,av),newState:z(14,av)}));var Dv=C(()=>({type:v(5,"EXPAND"),length:T(13)}));var Ev=D(()=>({type:[1,xv,2,yv,3,Bv,4,Cv,5,Dv]}),()=>({}));var Fv=C(()=>({H:A(1,Ev)}));var Gv=C(()=>({...sv(),type:v(2,"SHAPE"),viewBox:z(31,wv),paths:z(32,Fv)}));var Iv=C(()=>({...sv(),type:v(3,"GROUP"),contents:z(31,Hv)}));var Jv=C(()=>({...sv(),type:v(4,"EMBED")}));var Kv=C(()=>({index:T(1),length:T(2)}));var Pe=C(()=>({type:v(1,"FORMAT"),bounds:y(1,Kv),formatting:y(2,Le)}));var Oe=C(()=>({type:v(2,"REPLACE"),bounds:y(1,Kv),chunks:A(2,cf)}));var Ne=C(()=>({type:v(3,"APPEND"),chunks:A(1,cf)}));var Qe=C(()=>({type:v(4,"FORMAT_PARAGRAPH"),bounds:y(1,Kv),formatting:y(2,Le)}));var Lv=D(()=>({type:[1,Pe,2,Oe,3,Ne,4,Qe]}),()=>({}));var Mv=C(()=>({...sv(),type:v(5,"TEXT"),operations:A(31,Lv),chunks:A(32,cf)}));var Nv=C(()=>({...sv(),type:v(6,"UNSUPPORTED")}));var Ov=D(()=>({type:[1,vv,2,Gv,3,Iv,4,Jv,5,Mv,6,Nv]}),sv);var Pv=C(()=>({type:v(3,"UPDATE"),delta:z(11,Ov),shift:z(12,se)}));var Qv=C(()=>({type:v(4,"CHANGE"),oldState:z(11,bv)}));var Rv=C(()=>({type:v(5,"EXPAND"),length:T(13)}));var Sv=D(()=>({type:[1,pv,2,qv,3,Pv,4,Qv,5,Rv]}),()=>({}));var Hv=C(()=>({H:A(1,Sv)}));var Tv=C(()=>({oldState:z(1,Tu),newState:z(2,Tu)}));var Uv=C(()=>({type:v(1,"FIXED"),background:z(2,Ef),elements:z(3,Hv),locked:z(4,hv),dimensions:z(5,Tv)}));var Vv=C(()=>({type:v(2,"UNSUPPORTED")}));var Wv=D(()=>({type:[1,Uv,2,Vv]}),()=>({}));var Ce=C(()=>({top:S(1),left:S(2),width:X(3),height:X(4),rotation:Ir(5)}));var Xv=C(()=>({text:W(1),decorative:Z(2)}));var Yv=C(()=>({ref:W(1),altText:z(2,Xv)}));var Zv=C(()=>({ref:W(1),altText:z(2,Xv)}));var $v=C(()=>({dropTarget:Z(1),color:X(2),image:z(3,Yv),video:z(4,Zv)}));var aw=C(()=>({backgroundColor:X(1),fontSize:V(2),textAlign:X(3),color:X(4),fontRef:X(5),fontWeight:X(6),fontStyle:X(7),decoration:X(8)}));var bw=()=>({rowSpan:V(3),colSpan:V(4),attributes:z(5,aw)});var cw=C(()=>({...bw(),type:Pa(6,"EMPTY")}));var dw=C(()=>({...bw(),type:v(7,"STRING"),value:W(101)}));var ew=C(()=>({type:v(11,"RICHTEXT"),chunks:A(12,cf),box:z(13,Ce)}));var fw=C(()=>({type:v(4,"TEXT"),children:Lr(1),fontSize:V(2),textAlign:X(3),color:X(4),fontRef:X(9),fontWeight:X(5),fontStyle:X(6),decoration:X(7),box:z(8,Ce)}));var gw=C(()=>({type:v(1,"IMAGE"),ref:X(1),dataUrl:X(2),box:z(3,Ce),altText:z(104,Xv)}));var hw=C(()=>({type:v(2,"VIDEO"),ref:W(1),box:z(2,Ce),altText:z(103,Xv)}));var iw=C(()=>({type:v(3,"EMBED"),url:W(1),box:z(2,Ce)}));var jw=C(()=>({top:S(1),left:S(2),width:S(3),height:S(4)}));var kw=C(()=>({weight:T(1),color:W(2),strokeAlign:W(3)}));var lw=C(()=>({d:W(1),fill:y(2,$v),stroke:z(3,kw)}));var mw=C(()=>({type:v(5,"SHAPE"),viewBox:y(1,jw),paths:A(2,lw),box:z(3,Ce)}));var nw=D(()=>({type:[6,cw,7,dw]}),bw,{Kf:()=>cw});var ow=C(()=>({cells:A(1,nw)}));var pw=C(()=>({type:v(10,"TABLE"),rows:A(1,ow)}));var rw=D(()=>({type:[1,gw,2,hw,3,iw,4,fw,5,mw,6,qw,10,pw,11,ew]}),()=>({}));var qw=C(()=>({type:v(6,"GROUP"),children:A(1,rw),box:z(2,Ce)}));var Ee=C(()=>({elements:A(1,rw),background:z(2,$v),title:X(3)}));var sw=C(()=>({ref:W(1)}));var tw=C(()=>({id:W(1),version:T(2)}));var uw=C(()=>({linkedMedia:A(1,tw)}));var Je=C(()=>({elementId:X(1),ib:Mr(2),appData:z(6,uw),$a:A(3,rw),placement:z(5,Ce)}));var vw=C(()=>({ib:Mr(1),appData:z(2,uw),$a:A(3,rw),placement:z(5,Ce)}));var ww=C(()=>({ib:Mr(1),appData:z(2,uw),$a:A(3,rw),placement:z(5,Ce),elementId:W(6)}));var xw=C(()=>({code:W(1),message:W(2)}));var Zg=C(()=>({Ek:z(1,xw),Bb:W(5),data:Mr(6)}));var Se=C(()=>({scope:v(1,"TOMBSTONE")}));var Te=C(()=>({scope:v(4,"RICHTEXT"),operations:A(1,Lv),bb:X(5),regions:A(7,cf)}));var Ve=C(()=>({scope:v(3,"IMAGE"),ref:W(1)}));var We=C(()=>({scope:v(2,"PLAINTEXT"),text:W(1)}));var Xe=C(()=>({scope:v(6,"VIDEO"),ref:W(1)}));var yw=D(()=>({scope:[1,Se,2,We,3,Ve,4,Te,6,Xe]}),()=>({}));var Ye=C(()=>({values:A(1,yw)}));var zw=C(()=>({text:W(1)}));var Aw=()=>({Pi:W(3)});var Bw=C(()=>({type:W(1),ref:W(2),altText:z(3,Xv)}));var Cw=C(()=>({id:T(3),fill:y(1,Bw),tombstone:Z(4)}));var Dw=C(()=>({...Aw(),content:v(2,"FILL"),fills:A(31,Cw)}));var Ew=C(()=>({chunks:A(1,cf),tombstone:Z(2)}));var Fw=C(()=>({...Aw(),content:v(1,"RICHTEXT"),ranges:A(1,Ew)}));var ah=C(()=>({id:W(1)}));var Gw=E(()=>[1,2,3,4]);var Hw=C(()=>({Xe:y(1,ah),scope:B(2,Gw),values:A(3,yw)}));var Jg=C(()=>({Xe:y(1,ah),scope:B(2,Gw),count:T(3)}));var fh=C(()=>({id:T(1)}));var ch=C(()=>({scope:B(1,Gw)}));var dh=C(()=>({zd:y(1,fh),mc:y(2,Jg)}));var kf=C(()=>({target:W(1),Ef:X(2)}));var xh=C(()=>({pages:A(1,gv),Pf:y(2,Tu)}));var Og=C(()=>({delta:z(1,Wv)}));var Iw=C(()=>({type:v(1,"GROUP"),Yf:T(31)}));var Jw=C(()=>({type:v(2,"UNGROUP"),An:Kr(32)}));var Kw=D(()=>({type:[1,Iw,2,Jw]}),()=>({}));var Lw=C(()=>({output:y(1,Kw),delta:z(2,Wv)}));var Ge=a=>{var b,c,d;const e=((b=a.asset)===null||b===void 0?0:b.altText)?new Xv(a.asset.altText):void 0;b=((c=a.asset)===null||c===void 0?void 0:c.type)==="image"?new Yv({ref:a.asset.ref,altText:e}):void 0;c=((d=a.asset)===null||d===void 0?void 0:d.type)==="video"?new Zv({ref:a.asset.ref,altText:e}):void 0;return new $v({dropTarget:a.dropTarget,color:a.color,image:b,video:c})},Mw=a=>{if(a==null)return new cw({});const b=a.attributes?new aw(a.attributes):void 0;switch(a.type){case "empty":return new cw({...a,
attributes:b});case "string":return a.value?dw.ue({...a,attributes:b}):new cw({...a,attributes:b});default:throw new L({code:"internal_error",message:`Unsupported element type: '${a}'.`});}},Fe=a=>{switch(a.type){case "richtext":return new ew({chunks:a.range.readTextRegions().map(b=>({D:b.text,formatting:b.formatting&&Me(b.formatting)})),box:De(a)});case "text":return new fw({...a,box:De(a)});case "image":return new gw({...a,altText:a.altText?new Xv(a.altText):void 0,box:De(a)});case "video":return new hw({...a,
altText:a.altText?new Xv(a.altText):void 0,box:De(a)});case "embed":return new iw({...a,box:De(a)});case "shape":return new mw({...a,box:De(a),paths:a.paths.map(b=>new lw({...b,fill:Ge(b.fill),stroke:b.stroke?new kw(b.stroke):void 0}))});case "group":return new qw({...a,box:De(a),children:a.children.map(Fe)});case "table":return pw.ue({rows:a.rows.map(({cells:b})=>({cells:b.map(Mw)}))});default:throw new L({code:"internal_error",message:`Unsupported element type: '${a}'.`});}};var sg=class{constructor(a,b){this.la=a;this.O=b;this.ek=c=>{switch(c.type){case "FIXED":return{key:"absolute",value:this.ak(c)};case "UNSUPPORTED":return{key:"unsupported",value:{}};default:throw new L({code:"internal_error",message:"Unknown page type"});}};this.cn=c=>{switch(c.key){case "absolute":return this.an(c.value);case "unsupported":throw new G({code:"bad_request",message:"Cannot update unsupported pages"});default:throw new L({code:"internal_error",message:"Unknown page type"});}};this.ak=
c=>({background:c.background&&tf(this,c.background),elements:c.elements&&ue(this.la.Bh,this.Ch,c.elements),locked:c.locked&&rf(c.locked),dimensions:c.dimensions&&rf(c.dimensions)});this.an=c=>new Uv({background:c.background&&Ff(this,c.background),elements:c.elements&&te(pv,Rv,qv,Pv,Qv,Hv,this.la.$m,this.Ui,c.elements),locked:xf(c.locked),dimensions:xf(c.dimensions)});this.we=c=>{switch(c.type){case "GROUP":throw new G({code:"internal_error",message:"Received invalid group delta"});case "UNSUPPORTED":case "RECT":case "EMBED":case "TEXT":case "SHAPE":return c=
this.Ch(c),J(c.key!=="group","internal_error","Cannot nest groups"),c;default:throw new L({code:"internal_error",message:"Unknown element type"});}};this.Ye=c=>this.Ui(c);this.Ch=c=>{const d={top:c.top&&rf(c.top),left:c.left&&rf(c.left),locked:void 0,height:c.height&&rf(c.height),width:c.width&&rf(c.width),rotation:c.rotation&&rf(c.rotation),transparency:c.transparency&&rf(c.transparency)};switch(c.type){case "EMBED":return{key:"embed",value:{...d}};case "RECT":return{key:"rect",value:{...d,fill:c.fill&&
tf(this,c.fill),stroke:c.stroke&&Hf(this,c.stroke)}};case "GROUP":return{key:"group",value:{...d,contents:c.contents&&ue(this.la.we,this.we,c.contents)}};case "UNSUPPORTED":return{key:"unsupported",value:{...d}};case "SHAPE":var e=c.paths&&ue(this.la.Dh,this.fk,c.paths),f;if(f=c.viewBox)c=c.viewBox,f={type:1,oldState:c.oldState,newState:c.newState};return{key:"shape",value:{...d,paths:e,viewBox:f}};case "TEXT":return{key:"text",value:{...d,text:(c.operations||c.chunks)&&Mf(this,c.operations,c.chunks)}};
default:throw new L({code:"internal_error",message:"Unknown element type"});}};this.Ui=c=>{const d={top:c.value.top&&xf(c.value.top),left:c.value.left&&xf(c.value.left),locked:void 0,height:c.value.height&&xf(c.value.height),width:c.value.width&&xf(c.value.width),rotation:c.value.rotation&&xf(c.value.rotation),transparency:c.value.transparency&&xf(c.value.transparency)};switch(c.key){case "unsupported":throw new G({code:"internal_error",message:"Cannot update unsupported elements"});case "embed":return new Jv(d);
case "text":return new Mv({...d,...(c.value.text?Pf(c.value.text):void 0)});case "shape":var e;if(e=c.value.viewBox){if(e.type===0)throw new G({code:"internal_error",message:"Cannot update viewbox, must replace instead."});e=new wv({oldState:e.oldState,newState:e.newState})}else e=void 0;return new Gv({...d,viewBox:e,paths:c.value.paths&&te(xv,Dv,yv,Bv,Cv,Fv,this.la.Vi,this.dn,c.value.paths)});case "rect":return new vv({...d,stroke:c.value.stroke&&Kf(c.value.stroke),fill:c.value.fill&&Ff(this,c.value.fill)});
case "group":return new Iv({...d,contents:c.value.contents&&te(pv,Rv,qv,Pv,Qv,Hv,this.la.Ye,this.Ye,c.value.contents)});default:throw new L({code:"internal_error",message:"Unknown element type"});}};this.fk=c=>{var d;if(d=c.fill)d=c.fill,d={isMediaEditable:d.isMediaEditable&&rf(d.isMediaEditable),colorContainer:pf(this,d.colorContainer),mediaContainer:sf(this,d.mediaContainer)};return{fill:d,stroke:c.stroke&&Hf(this,c.stroke),d:c.d&&rf(c.d)}};this.dn=c=>{J(c.d==null,"bad_request","Cannot edit the d attribute of an existing path");
var d;if(d=c.fill)d=c.fill,d=new zv({isMediaEditable:xf(d.isMediaEditable),colorContainer:yf(d.colorContainer),mediaContainer:Df(this,d.mediaContainer)});return new Av({fill:d,stroke:c.stroke&&Kf(c.stroke)})};this.Nf=c=>({text:c.D,formatting:c.formatting&&Nc($e(c.formatting))})}};var Qf=Object.freeze({width:-1,height:-1});var ig=class extends mu{get operations(){return[...this._operations]}readTextRegions(){return this.deleted?[]:super.readTextRegions()}formatText(a,b){this.deleted||(b=Pc({type:"format",bounds:a,formatting:b}),this._operations.push(b),super.formatText(a,Sf(b.formatting)))}formatParagraph(a,b){this.deleted||(b=Pc({type:"formatParagraph",bounds:a,formatting:b}),this._operations.push(b),super.formatParagraph(a,Sf(b.formatting)))}appendText(a,b){if(this.deleted)return{bounds:{index:0,length:0}};this._operations.push(Pc({type:"append",
Sb:{text:a,formatting:b}}));return super.appendText(a,b)}replaceText(a,b,c){if(this.deleted)return{bounds:{index:0,length:0}};this._operations.push(Pc({type:"replace",bounds:a,wb:[{text:b,formatting:c}]}));return super.replaceText(a,b,c)}constructor(a,b,c){super(b,c);this.Uk=a;this.O=b;this.regions=c;this._operations=[];this.deleted=!1}};new bg({});new Tu({width:0,height:0});
var rg=class{zb(){return{type:"unsupported"}}constructor(a){this.O=a;this.gk=(b,c,d)=>({type:"video",videoRef:this.hk(b.video),flipX:c,flipY:d});this.hk=b=>b;this.gn=b=>new Wu({video:b.videoRef,flipX:b.flipX,flipY:b.flipY});this.ck=b=>{var c=b.media;return{type:"image",imageRef:[c.id,c.version].join(":"),flipX:b.flipX,flipY:b.flipY}};this.bn=b=>{const [c,d]=b.imageRef.split(":");var e=new Uu({id:c,version:parseInt(d,10)});return new Vu({media:e,flipX:b.flipX,flipY:b.flipY})};this.bk=()=>this.zb();
this.Ze=b=>{if(b!=null)switch(b.type){case "image":return this.bn(b);case "video":return this.gn(b);default:throw new L({code:"internal_error",message:"Unknown media fill type"});}};this.Dh=b=>{var c=b.d;var d=b.fill;d={isMediaEditable:d.isMediaEditable,mediaContainer:qf(this,d.mediaContainer),colorContainer:nf(this,d.colorContainer)};return{d:c,fill:d,stroke:b.stroke&&Gf(this,b.stroke)}};this.Vi=b=>{var c=b.d;var d=b.fill;d=new $u({isMediaEditable:d.isMediaEditable,colorContainer:uf(d.colorContainer),
mediaContainer:this.Ze(d.mediaContainer)});return new av({d:c,fill:d,stroke:b.stroke&&Yf(b.stroke)})};this.we=b=>{switch(b.type){case "RECT":return ag(this,b);case "SHAPE":return eg(this,b);case "EMBED":return{type:"embed",...Zf(b),url:b.url};case "TEXT":return jg(this,b);case "UNSUPPORTED":return mg(this,b);default:throw new L({code:"internal_error",message:"deserializeGroupContentElement() received an invalid element type"});}};this.Ye=b=>{switch(b.type){case "rect":return dg(this,b);case "shape":return hg(this,
b);case "embed":return new cv({...$f(b),url:b.url});case "text":return lg(b);case "unsupported":return new dv($f(b));default:throw new L({code:"internal_error",message:"serializeGroupContentElement() received an invalid element type"});}};this.Bh=b=>{switch(b.type){case "RECT":return ag(this,b);case "SHAPE":return eg(this,b);case "GROUP":return ng(this,b);case "EMBED":return{type:"embed",...Zf(b),url:b.url};case "TEXT":return jg(this,b);case "UNSUPPORTED":return mg(this,b);default:throw new L({code:"internal_error",
message:"deserializeElement() received an invalid element type"});}};this.$m=b=>{switch(b.type){case "rect":return dg(this,b);case "shape":return hg(this,b);case "group":return pg(this,b);case "embed":return new cv({...$f(b),url:b.url});case "text":return lg(b);case "unsupported":return new dv($f(b));default:throw new L({code:"internal_error",message:"serializeElement() received an invalid element type"});}};this.dk=(b,c)=>{switch(b.type){case "FIXED":return qg(this,b,c);case "UNSUPPORTED":return this.zb();
default:throw new L({code:"internal_error",message:"deserializePage() received an invalid element type"});}}}};var Eg=new WeakMap,Nw=new WeakMap,Ow=new WeakMap,zg=new WeakMap,Cg=new WeakMap,Pw=new WeakMap,Qw=new WeakMap,Rw=new WeakMap,Sw=new WeakSet,Tw=new WeakSet,vg=class{get page(){return yg(this,Rw).mutable}buffer(a){try{J(!yg(this,Ow),"bad_request","Cannot make changes while a sync is in progress"),yg(this,zg).push(a)}catch(b){throw kr(this,Tw,Fg).call(this),b;}}async sync(){if(yg(this,Ow))throw new G({message:"Cannot save design. There is a sync in progress",code:"bad_request"});Ag(this,Ow,!0);if(!yg(this,
Cg))throw new G({message:"Cannot save design. Transaction has been closed",code:"bad_request"});const a=await Pg(yg(this,Eg),{Lf:kr(this,Sw,Bg).call(this)});a.delta&&yg(this,Rw).apply(a.delta);Ag(this,Ow,!1)}constructor(a,b,c,d){lr(this,Sw);lr(this,Tw);mr(this,Eg,{writable:!0,value:void 0});mr(this,Nw,{writable:!0,value:void 0});mr(this,Ow,{writable:!0,value:void 0});mr(this,zg,{writable:!0,value:void 0});mr(this,Cg,{writable:!0,value:void 0});mr(this,Pw,{writable:!0,value:void 0});mr(this,Qw,{writable:!0,
value:void 0});mr(this,Rw,{writable:!0,value:void 0});Ag(this,Ow,!1);Ag(this,zg,[]);Ag(this,Cg,!0);Ag(this,Qw,b);Ag(this,Eg,c);Ag(this,Pw,d);Ag(this,Rw,a);Ag(this,Nw,new lu(this.page,async e=>{J(!yg(this,Ow),"bad_request","Cannot make changes while a sync is in progress");Ag(this,Ow,!0);const {output:f,delta:g}=await yg(this,Eg).Pe({input:e,Lf:kr(this,Sw,Bg).call(this)});g&&yg(this,Rw).apply(g);Ag(this,Ow,!1);return f}));this.helpers={snapshot:()=>{yg(this,Pw).Ad("preview","openDesign","snapshot");
return yg(this,Rw).snapshot()},elementStateBuilder:yg(this,Qw),group:yg(this,Nw).group,ungroup:yg(this,Nw).ungroup}}};var hh=(a,b)=>["<MULTI_SEGMENT>",a,b],Ej=a=>Array.isArray(a)&&a.length===3&&a[0]==="<MULTI_SEGMENT>";var Gg=C(()=>({data:Mr(1),appData:z(3,uw),version:T(2),id:X(4)}));var Uw=E(()=>[1,2],1);var Vw=C(()=>({ref:W(1),width:T(2),height:T(3),type:B(4,Uw)}));var Ww=C(()=>({source:X(1)}));var Hg=C(()=>({Hj:W(1),Jj:y(2,Vw),Ij:z(3,Ww)}));var Ig=C(()=>({data:Mr(1),version:T(2),mediaRef:y(3,tw),appData:z(4,uw)}));var Kg=C(()=>({id:W(1),canOpen:Y(2),reason:X(3)}));var Xw=C(()=>({token:W(1)}));var Yw=C(()=>({width:S(1),height:S(2)}));var Zw=C(()=>({dimensions:z(1,Yw)}));var $w=C(()=>({title:X(1),defaultPageDimensions:z(2,Yw),pageMetadata:A(3,Zw),durationInSeconds:S(4)}));var ax=C(()=>({dimensions:z(1,Yw)}));var bx=C(()=>({dimensions:z(1,Yw)}));var Sg=C(()=>({elementId:X(1)}));var Vg=C(()=>({elementId:X(1),bi:Z(2)}));var ih=C(()=>({appProcessId:W(1)}));var cx=C(()=>({Xe:y(1,ah),Np:A(3,Lv),bb:W(4)}));var kh=C(()=>({target:W(1)}));var lh=C(()=>({zd:T(1),mc:y(2,Kg)}));var nh=C(()=>({zd:T(1)}));var dx=C(()=>({context:v(1,"CURRENT")}));var ex=C(()=>({context:v(2,"SINGLE"),Pp:W(1)}));var fx=C(()=>({context:v(3,"PAGE_LIST"),Qp:Lr(1)}));var gx=C(()=>({context:v(4,"ALL_PAGES")}));var hx=D(()=>({context:[1,dx,2,ex,3,fx,4,gx]}),()=>({}));var ix=()=>({Ei:y(3,hx)});var jx=C(()=>({...ix(),contentType:v(1,"RICHTEXT")}));var kx=C(()=>({...ix(),contentType:v(2,"FILL")}));var ph=D(()=>({contentType:[1,jx,2,kx]}),ix);var qh=D(()=>({content:[1,Fw,2,Dw]}),Aw);var lx=C(()=>({operations:A(1,Lv)}));var mx=C(()=>({id:W(3),content:v(1,"RICHTEXT"),operations:A(1,lx)}));var nx=C(()=>({Pk:T(1),fill:y(2,Bw)}));var ox=C(()=>({id:W(3),content:v(2,"FILL"),Dn:A(31,nx)}));var sh=D(()=>({content:[1,mx,2,ox]}),()=>({id:W(3)}));var px=C(()=>({id:W(1),contentType:Pa(2,"RICHTEXT")}));var qx=C(()=>({id:W(1),contentType:v(3,"FILL")}));var uh=D(()=>({contentType:[2,px,3,qx]}),()=>({id:W(1)}),{Kf:()=>px});var wh=C(()=>({}));var Mg=C(()=>({Lf:A(1,Wv)}));var Qg=C(()=>({}));var Rg=C(()=>({}));var rx=C(()=>({type:v(1,"GROUP"),mk:Kr(31)}));var sx=C(()=>({type:v(2,"UNGROUP"),Yf:T(32)}));var tx=D(()=>({type:[1,rx,2,sx]}),()=>({}));var ux=C(()=>({input:y(1,tx),Lf:A(2,Wv)}));var vx=class{async addNativeElement(a){a=await this.l.request("DI_V1_ADD_NATIVE_ELEMENT",rw.C(a));if(!a.ok)throw Xg(a.error,"Encountered an error while adding native element");}async addElementAtPoint(a){a=await this.l.request("DI_V2_ADD_ELEMENT_AT_POINT",rw.C(a));if(!a.ok)throw Xg(a.error,"Encountered an error while adding element at point");}async addElementAtCursor(a){a=await this.l.request("DI_V2_ADD_ELEMENT_AT_CURSOR",rw.C(a));if(!a.ok)throw Xg(a.error,"Encountered an error while adding element at cursor");
}async setCurrentPageBackground(a){a=await this.l.request("DI_V1_SET_CURRENT_PAGE_BACKGROUND",$v.C(a));if(!a.ok)throw Xg(a.error,"Encountered an error while setting page background");}async addPage(a){a=await this.l.request("DI_V1_ADD_PAGE",Ee.C(a));if(!a.ok)throw Xg(a.error,"Encountered an error while adding page");}async getDesignToken(){var a=await this.l.request("DI_V1_GET_DESIGN_TOKEN");a=Ng(a,"DI_V1_GET_DESIGN_TOKEN","Encountered an error while trying to retrieve design token.");return Xw.F(a)}async getDesignMetadata(){var a=
await this.l.request("DI_V1_GET_DESIGN_METADATA");a=Ng(a,"DI_V1_GET_DESIGN_METADATA","Encountered an error while trying to retrieve the design metadata.");return $w.F(a)}async getDefaultPageDimensions(){var a=await this.l.request("DI_V1_GET_DEFAULT_PAGE_DIMENSIONS");a=Ng(a,"DI_V1_GET_DEFAULT_PAGE_DIMENSIONS","Encountered an error while trying to read default page dimensions.");return ax.F(a)}async getCurrentPageContext(){var a=await this.l.request("DI_V1_GET_CURRENT_PAGE_CONTEXT");a=Ng(a,"DI_V1_GET_CURRENT_PAGE_CONTEXT",
"Could not retrieve current page context");return bx.F(a)}async addAudioTrack(a){a=await this.l.request("DI_V1_ADD_AUDIO_TRACK",sw.C(a));if(!a.ok)throw Xg(a.error,"Encountered an error while adding audio track");}async setAppElementData(a){a=await this.l.request("DI_V1_SET_APP_ELEMENT_DATA",Je.C(a));if(!a.ok)throw Xg(a.error,"Encountered an error while setting app element data");}async addAppElement(a){await this.l.request("DI_V1_ADD_APP_ELEMENT",vw.C(a))}async updateAppElement(a){await this.l.request("DI_V1_UPDATE_APP_ELEMENT",
ww.C(a))}registerRenderAppElement(){this.l.request("DI_V1_REGISTER_RENDER_APP_ELEMENT")}async Xg(a){a=await this.l.request("DI_V1_UPDATE_SELECTION_CONTENT",Hw.C(a));if(!a.ok)throw Xg(a.error,"Could not save selection content.");}async readPlaintext(a){a=await this.l.request("DI_V1_READ_PLAINTEXT",cx.C(a));a=Ng(a,"DI_V1_READ_PLAINTEXT","Encountered an error while reading text");return zw.F(a)}async Pe(a){const b=await this.l.request("DI_V1_PERFORM_ASYNC_OPERATION",ux.C(a));a=Ng(b,"DI_V1_PERFORM_ASYNC_OPERATION",
`Encountered an error while performing async operation ${a.input.type}`);return Lw.F(a)}constructor(a){this.l=a}};var zh=class{get canOpen(){return this.Cc&&this.dg.canOpen&&!this.rf}get reason(){if(!this.canOpen){if(!this.Cc)return"Overlay can not be opened on stale event";J(this.dg.canOpen===!1,"internal_error","Invalid state.");return this.dg.reason}}constructor(a){this.dg=a;this.Cc=!0;this.rf=!1}};var wx=class{constructor(a){this.A=a;this.Ri=new Map}};var xx,yx=class{registerOnCanOpen({target:a,onCanOpen:b}){this.Bj("registerOnOverlayCanOpen");switch(a){case "image_selection":return Ah(this.Qi,b);default:throw new G({code:"bad_request",message:"Invalid overlay target."});}}async Mg(a){a=jf(a);Bh(this.Qi,a)}constructor(a,b){this.Bj=a;xx(this);this.Qi=new wx(b)}};({e:[xx]}=jr(yx,[[M("design.v2.registerOnOverlayCanOpen"),2,"registerOnCanOpen"]],[]));var zx=class{async save(){if(this.Ph)throw new G({code:"bad_request",message:"Attempted to save a new change on an outdated draft. To make another change, read a fresh draft from the selection event."});if(!this.Al())throw new G({code:"bad_request",message:"Attempted to save a change on a selection event which has been disposed of"});var a=[],b=this.contents,c=0;for(let l=0;l<this.si.length;l++){var d=this.si[l];if(d==null)a.push(void 0);else{var e=b[c++],f=a,g=f.push;a:{var h=this.scope;switch(h){case "plaintext":h=
d.text!==e.text;break a;case "image":h=d.ref!==e.ref;break a;case "video":h=d.ref!==e.ref;break a;case "richtext":h=!0;break a;default:throw new G({code:"bad_request",message:`${h} is not a supported selection scope.`});}}if(h)a:switch(h=this.scope,d=this.O,h){case "image":e=nd(d,e,"image");break a;case "plaintext":e=nd(d,e,"plaintext");break a;case "video":e=nd(d,e,"video");break a;case "richtext":e=nd(d,{bb:e.Uk,operations:e.operations,regions:e.readTextRegions()},"richtext");break a;default:throw new L({code:"internal_error",
message:`Unknown scope: ${h}`});}else e=void 0;g.call(f,e)}}this.Ph=!0;b=this.Xg;c=this.scope;f=this.id;a=Ze(a,c);a=new Hw({Xe:new ah({id:f}),scope:ff(c),values:a.values});await b.call(this,a)}constructor(a,b,c,d,e,f){this.id=a;this.scope=b;this.si=c;this.Xg=d;this.Al=e;this.O=f;this.Ph=!1;this.contents=Object.freeze(c.filter(g=>g!=null).map(g=>{if(b==="richtext")g=new ig(g.bb,this.O,g.regions);else if(b==="plaintext"||b==="image"||b==="video")g={...g};else throw new L({code:"internal_error",message:`Unknown scope: ${b}`});
return g}))}};var Ax,Bx,Cx,Dx,Ex,Fx,Gx,Hx,Ix,Jx,Kx,Lx,Mx=["plaintext","image","video","richtext"];Ax=M("design.v2.createRichtextRange");Bx=M("design.v2.editContent");Cx=M("design.v2.registerOnSelectionChange");Dx=M("design.v2.registerRenderAppElement");Ex=M("design.v2.onAppElementChange");Fx=M("design.v2.getCurrentPageContext");Gx=M("design.v2.getDefaultPageDimensions");Hx=M("design.v2.addAppElement");Ix=M("design.v2.updateAppElement");Jx=M("design.v2.setAppElementData");Kx=M("design.v2.setCurrentPageBackground");
var hj=class{createRichtextRange(){return new mu(this.O,[])}async editContent(a,b){a.contentType==="fill"&&this.Y.Ad("preview","EditContent","fill");switch(a.target){case "current_page":var c=new dx;break;default:throw new L({code:"internal_error",message:`Unknown edit target: ${a.target}`});}const d=a.contentType;switch(d){case "richtext":c=new jx({Ei:c});break;case "fill":c=new kx({Ei:c});break;default:throw new L({code:"internal_error",message:`Unknown content type: ${d}`});}c=af(await rh(this.A,
c));try{switch(c.type){case "richtext":await b(Ch(this,c));break;case "fill":a.contentType==="fill"&&await b(Dh(this,c));break;default:throw new L({code:"internal_error",message:`Unknown edit target: ${c}`});}}finally{await vh(this.A,d==="richtext"?new px({id:c.id}):qx.ue({id:c.id}))}}Ji({scope:a,onChange:b}){this.B("registerOnSelectionChange");a==="richtext"&&this.Y.Ad("preview","Richtext Selection");if(!Mx.includes(a))throw new G({code:"bad_request",message:`${a} is not a valid selection scope.`});
let c=()=>Promise.resolve();eh(this.A,new ch({scope:ff(a)})).then(d=>{const {id:e,mc:f}={id:d.zd.id,mc:hf(d.mc)};c=async()=>{await gh(this.A,new fh({id:e}));this.We.delete(e)};const g=h=>{h.scope===a&&b({count:h.count,scope:a,read:async()=>{const l=await bh(this.A,new ah({id:h.id}));return new zx(h.id,a,ef(l),n=>this.A.Xg(n),()=>this.We.has(e),this.O)}})};this.We.set(e,h=>{g(h)});g(f)});return()=>{c()}}registerRenderAppElement(a){this.B("registerRenderAppElement");this.vc=a;this.A.registerRenderAppElement()}onAppElementChange(a){this.B("onAppElementChange");
this.Gj=a;Yg(this.A)}async getCurrentPageContext(){this.B("getCurrentPageContext");return this.A.getCurrentPageContext().catch(a=>{if(a instanceof G)throw a;throw new G({code:"internal_error",message:`Encountered an error while trying to read current page context: ${a instanceof Error?a.message:a}`});})}async getDefaultPageDimensions(){this.B("getDefaultPageDimensions");Ck(this.Y,{Hb:"method",Ib:"getDefaultPageDimensions",Ob:"getDesignMetadata"});const {dimensions:a}=await this.A.getDefaultPageDimensions();
return a}async addAppElement(a){this.B("addAppElement");const b=a.data;a=a.placement;if(!this.vc)throw new G({code:"failed_precondition",message:"You've tried calling the 'addAppElement' method without using initAppElement"});try{a!=null&&ed(a),await this.A.addAppElement(new vw(Ie({ib:md(b),$a:Eh(this,b),placement:a})))}catch(c){throw c instanceof G&&Fh(this,{error:c,Bb:"setAppElementData",data:hc(b)}),c;}}async updateAppElement(a){this.B("updateAppElement");const b=a.data,c=a.placement;a=a.elementId;
if(!this.vc)throw new G({code:"failed_precondition",message:"You've tried calling the 'updateAppElement' method without using initAppElement"});try{c!=null&&ed(c);var d=this.A,e=d.updateAppElement,f={ib:md(b),$a:Eh(this,b),placement:c,elementId:a};var g=new ww({...Ie(f),elementId:f.elementId});await e.call(d,g)}catch(h){throw h instanceof G&&Fh(this,{error:h,Bb:"setAppElementData",data:hc(b)}),h;}}async setAppElementData(a,b){this.B("setAppElementData");let c,d,e;try{typeof a==="function"?(c=await Tg(this.A),
await Wg(this.A,{elementId:c===null||c===void 0?void 0:c.elementId,bi:!0}),{appElementData:d,placement:b,appData:e}=await a(),await Wg(this.A,{elementId:c===null||c===void 0?void 0:c.elementId,bi:!1})):d=a;if(!this.vc)throw new G({code:"failed_precondition",message:"You've tried calling the 'setAppElementData' method without registering a callback with the 'registerRenderAppElement' method.\nThis doesn't work because setting the app element's data triggers the callback, so the callback needs to be registered first.\n\nPlease register a callback with 'registerRenderAppElement' before calling the 'setAppElementData' method."});
try{b!=null&&ed(b),await this.A.setAppElementData(Ke({ib:md(d),appData:e,$a:Eh(this,d),placement:b,Qj:c===null||c===void 0?void 0:c.elementId}))}catch(f){throw f instanceof G&&Fh(this,{error:f,Bb:"setAppElementData",data:hc(d)}),f;}}finally{c&&await Ug(this.A,c)}}setCurrentPageBackground({color:a,asset:b}){this.B("setCurrentPageBackground");a==null&&b==null&&(a="#ffffff");if(a!=null&&b!=null)throw new G({code:"bad_request",message:"Only 1 of color or asset can be defined."});a=$c(this.O,{color:a,
asset:b});return this.A.setCurrentPageBackground(Ge(a))}async addNativeElement(a){this.B("addElementAtPoint");Ck(this.Y,{Hb:"method",Ib:"addNativeElement",Ob:"addElementAtPoint or addElementAtCursor"});try{const b=await Gh(this,a);return this.A.addNativeElement(b)}catch(b){b instanceof G&&Fh(this,{error:b,Bb:"addElementAtPoint"});if(b instanceof G)throw b;throw new G({code:"internal_error",message:`Encountered an error while adding native element: ${b instanceof Error?b.message:b}`});}}async addElementAtPoint(a){this.B("addElementAtPoint");
try{const b=await Gh(this,a);return this.A.addElementAtPoint(b)}catch(b){b instanceof G&&Fh(this,{error:b,Bb:"addElementAtPoint"});if(b instanceof G)throw b;throw new G({code:"internal_error",message:`Encountered an error while adding element at point: ${b instanceof Error?b.message:b}`});}}async addElementAtCursor(a){this.B("addElementAtCursor");try{switch(a.type){case "embed":case "image":case "text":case "video":case "richtext":case "table":break;default:throw new L({code:"bad_request",message:`Invalid element type: ${a}`});
}const b=await Gh(this,a);return this.A.addElementAtCursor(b)}catch(b){b instanceof G&&Fh(this,{error:b,Bb:"addElementAtCursor"});if(b instanceof G)throw b;throw new G({code:"internal_error",message:`Encountered an error while adding element at cursor: ${b instanceof Error?b.message:b}`});}}async addAudioTrack(a){this.B("addAudioTrack");try{Q(a!=null,"audio track must exist","invalid_element_state"),Q(ru.test(a.ref),"Invalid audio reference","invalid_element_state"),await this.A.addAudioTrack(new sw({ref:a.ref}))}catch(b){if(b instanceof
G)throw new G({code:b.code,message:`${"Encountered an error while adding audio track"}: ${b.rawMessage}`});throw new G({code:"internal_error",message:`${"Encountered an error while adding audio track"}: ${b instanceof Error?b.message:b}`});}}async addPage(a){var b;this.B("addPage");const c=a===null||a===void 0?void 0:(b=a.elements)===null||b===void 0?void 0:b.map(d=>Uc(this.O,d));b=(a===null||a===void 0?void 0:a.background)&&$c(this.O,a.background);a=(a===null||a===void 0?void 0:a.title)&&kd(a.title);
await this.A.addPage(He({elements:c,background:b,title:a}))}getDesignToken(){this.B("getDesignToken");return this.A.getDesignToken()}async getDesignMetadata(){this.B("getDesignMetadata");return this.A.getDesignMetadata()}Og(){Lg(this.kb,{Vm:async a=>{var b;(b=this.Gj)===null||b===void 0||b.call(this,a?{data:ic(a.data),appData:a.appData,version:a.version,update:c=>{if(!a.id)throw new G({code:"bad_request",message:"App element id is required to update the app element"});return this.updateAppElement({...c,
elementId:a.id})}}:void 0)},Um:async a=>{Hh(this,"onCreateFromPreset","onAppElementCreateFromPreset");if(!this.fh)throw new G({code:"internal_error",message:"Unexpected create event"});var b=a.Jj;b=b.type===1?{type:"image",ref:b.ref,dimensions:{width:b.width,height:b.height}}:{type:"video",ref:b.ref,dimensions:{width:b.width,height:b.height}};var c=(c=a.Ij)?{source:c.source}:void 0;const {appElementData:d,appData:e}=this.fh(a.Hj,b,c);a=md(d);b=Eh(this,d);return Ke({ib:a,appData:e,$a:b})},Wm:async a=>
{Hh(this,"onDrop","onAppElementDrop");if(!this.gh)throw new G({code:"internal_error",message:"Unexpected drop event"});var b=a.mediaRef;const c=a.version,{appElementData:d,appData:e}=await this.gh({data:ic(a.data),version:c},{mediaRef:b});a=md(d);b=Eh(this,d);return Ke({ib:a,appData:e,$a:b})},Ym:async a=>{const b=hf(a);this.We.forEach(c=>c(b))},Mg:a=>this.wi.Mg(a)})}initAppElement({render:a}){this.B("initAppElement");if(this.vc!=null)throw new G({code:"bad_request",message:"'initAppElement' can only be invoked once."});
this.registerRenderAppElement(a);return{addOrUpdateElement:(...b)=>this.setAppElementData(...b),registerOnElementChange:(...b)=>this.onAppElementChange(...b),addElement:b=>this.addAppElement(b)}}async openDesign(a,b){try{const c=await yh(this.A),d=c.pages[0];if(d.type==="UNSUPPORTED"){const f=Object.freeze({type:"unsupported"});a=()=>{throw new G({code:"unsupported_page_type",message:"This method is not applicable to this page type."});};return b({sync:()=>Promise.resolve(),page:f,helpers:{group:a,
ungroup:a,snapshot:a,elementStateBuilder:new wg(this.O)}})}const e=xg(d,c.Pf,this.O,this.A,this.Y);await b(e)}finally{await Dg(this.A)}}constructor(a,b,c,d="REAL",e){this.kb=a;this.Y=b;this.j=c;this.We=(Lx(this),new Map);this.selection={registerOnChange:this.Ji};this.onAppElementCreateFromPreset=f=>{this.fh=f};this.onAppElementDrop=f=>{this.gh=f};this.B=f=>{this.j.B(st({namespace:"design",client:"DesignInteraction",method:f}))};this.Og();this.A=new vx(this.kb);this.O=e||new su(this.Y,d);this.wi=new yx(this.B,
this.A);this.overlay={registerOnCanOpen:this.wi.registerOnCanOpen}}};
({e:[Lx]}=jr(hj,[[Ax,2,"createRichtextRange"],[Bx,2,"editContent"],[Cx,2,"Ji"],[Dx,2,"registerRenderAppElement"],[Ex,2,"onAppElementChange"],[Fx,2,"getCurrentPageContext"],[Gx,2,"getDefaultPageDimensions"],[Hx,2,"addAppElement"],[Ix,2,"updateAppElement"],[Jx,2,"setAppElementData"],[Kx,2,"setCurrentPageBackground"],[M("design.v2.addNativeElement"),2,"addNativeElement"],[M("design.v2.addElementAtPoint"),2,"addElementAtPoint"],[M("design.v2.addElementAtCursor"),2,"addElementAtCursor"],[M("design.v2.addAudioTrack"),
2,"addAudioTrack"],[M("design.v2.addPage"),2,"addPage"],[M("design.v2.getDesignToken"),2,"getDesignToken"],[M("design.v2.getDesignMetadata"),2,"getDesignMetadata"],[M("design.v2.initAppElement"),2,"initAppElement"],[M("design.v2.openDesign"),2,"openDesign"]],[]));Sb(hj.prototype);var Ph=new Set(["IMAGE"]),Xh={type:a=>R(a,Qh,"'type' is not a valid drag type"),fullSizeSrc:a=>R(a,Ih,"'fullSizeSrc' must be a jpg or png data url"),previewSize:a=>R(a,Th,"'previewSize' must be an object containing only a positive numeric width and height")},$h={type:a=>Vh(a,["IMAGE"],"type"),previewSrc:a=>R(a,Lh,"'previewSrc' must be a url"),resolveImageRef:a=>R(a,Mh,"'resolveImageRef' must be a function"),previewSize:a=>R(a,Th,"'previewSize' must be an object containing only a positive numeric width and height"),
fullSize:a=>R(a,Th,"'fullSize' must be an object containing only a positive numeric width and height")},Yh={fullSize:a=>R(a,Th,"'fullSize' must be an object containing only a positive numeric width and height or undefined",!0),previewSrc:a=>R(a,Ih,"'previewSrc' must be a jpg or png data url or undefined",!0)},ei={type:a=>Vh(a,["VIDEO"],"type"),previewSrc:a=>R(a,Lh,"'previewSrc' must be a url"),resolveVideoRef:a=>R(a,Mh,"'resolveVideoRef' must be a function"),previewSize:a=>R(a,Th,"'previewSize' must be an object containing only a positive numeric width and height"),
fullSize:a=>R(a,Th,"'fullSize' must be an object containing only a positive numeric width and height")},gi={type:a=>Vh(a,["AUDIO"],"type"),title:a=>R(a,Nh,"'title' must be supplied"),resolveAudioRef:a=>R(a,Mh,"'resolveAudioRef' must be a function"),durationMs:a=>R(a,Oh,"'durationMs' must be a number greater than 0")};var qi=new Set(["image"]),vi={type:a=>si(a,["image"],"type"),previewUrl:a=>ui(a,ji,"'previewUrl' must be a url"),resolveImageRef:a=>ui(a,ki,"'resolveImageRef' must be a function"),previewSize:a=>ui(a,pi,"'previewSize' must be an object containing only a positive numeric width and height"),fullSize:a=>ui(a,pi,"'fullSize' must be an object containing only a positive numeric width and height")},yi={type:a=>si(a,["video"],"type"),previewUrl:a=>ui(a,ji,"'previewUrl' must be a url"),resolveVideoRef:a=>
ui(a,ki,"'resolveVideoRef' must be a function"),previewSize:a=>ui(a,pi,"'previewSize' must be an object containing only a positive numeric width and height"),fullSize:a=>ui(a,pi,"'fullSize' must be an object containing only a positive numeric width and height")},Bi={type:a=>si(a,["audio"],"type"),title:a=>ui(a,li,"'title' must be supplied"),resolveAudioRef:a=>ui(a,ki,"'resolveAudioRef' must be a function"),durationMs:a=>ui(a,mi,"'durationMs' must be a number greater than 0")};var Nx=class{kc({dragData:a}){if((a===null||a===void 0?void 0:a.type)!=="AUDIO")throw new G({code:"bad_request",message:`Invalid drag type. Expected 'AUDIO' received '${a===null||a===void 0?void 0:a.type}'`});if(!hi(a))throw new G({code:"bad_request",message:"invalid drag data"});return()=>a}fc(a){if(!Ci(a))throw new G({code:"bad_request",message:"invalid drag data"});return a}};var Di=C(()=>({ref:W(1)}));var Ei=C(()=>({ref:W(1)}));var Fi=C(()=>({ref:W(1)}));var Ox=C(()=>({x:T(1),y:T(2)}));var Px=C(()=>({width:T(1),height:T(2)}));var Wi=C(()=>({type:v(1,"IMAGE"),$b:y(1,Ox),wc:y(2,Ox),ec:y(3,Px),fullSizeSrc:W(4),previewSize:y(5,Px),fullSize:z(6,Px),previewSrc:X(7)}));var Xi=C(()=>({type:v(2,"TEXT"),$b:y(1,Ox),wc:y(2,Ox),ec:y(3,Px),children:Lr(4),fontRef:X(10),fontSize:V(5),fontWeight:X(6),fontStyle:X(7),decoration:X(8),textAlign:X(9)}));var Vi=C(()=>({type:v(3,"EXTERNAL_IMAGE"),$b:y(1,Ox),wc:y(2,Ox),ec:y(3,Px),previewSize:y(4,Px),previewSrc:W(5)}));var Yi=C(()=>({type:v(4,"VIDEO"),$b:y(1,Ox),wc:y(2,Ox),ec:y(3,Px),previewSize:y(5,Px),fullSize:z(6,Px),previewSrc:W(7)}));var Zi=C(()=>({type:v(5,"AUDIO"),$b:y(1,Ox),wc:y(2,Ox),ec:y(3,Px),title:W(5),durationMs:T(6)}));var Qx=C(()=>({type:v(6,"EMBED"),$b:y(1,Ox),wc:y(2,Ox),ec:y(3,Px),previewSize:y(4,Px),previewSrc:W(5),embedUrl:W(6)}));var Hi=D(()=>({type:[1,Wi,2,Xi,3,Vi,4,Yi,5,Zi,6,Qx]}),()=>({}));var Ji=C(()=>({x:T(1),y:T(2),timestamp:Hr(3),sn:W(4)}));var Rx=class{async startDrag(a){a=await this.l.request("DND_V1_START_DRAG",Hi.C(a));if(!a.ok)throw a.error;}async startDragToPoint(a){a=await this.l.request("DND_V2_START_DRAG_TO_POINT",Hi.C(a));if(!a.ok)throw a.error;}async startDragToCursor(a){a=await this.l.request("DND_V2_START_DRAG_TO_CURSOR",Hi.C(a));if(!a.ok)throw a.error;}constructor(a){this.l=a}};var Sx={now:()=>Date.now()},Tx=class{constructor(a,b){this.node=a;this.startDrag=b;this.se=Sx;this.Gd=!1;this.init=()=>{this.dj();this.node.addEventListener("mouseup",this.onMouseUp);this.node.addEventListener("mousedown",this.onMouseDown);this.node.addEventListener("mousemove",this.onMouseMove);this.node.addEventListener("mouseleave",this.onMouseLeave)};this.dj=()=>{this.node.removeEventListener("mouseup",this.onMouseUp);this.node.removeEventListener("mousedown",this.onMouseDown);this.node.removeEventListener("mousemove",
this.onMouseMove);this.node.removeEventListener("mouseleave",this.onMouseLeave)};this.onMouseDown=c=>{c.preventDefault();c.stopPropagation();this.Gd=!0;this.Sc={coords:{x:c.clientX,y:c.clientY},timestamp:this.se.now()};return!1};this.onMouseUp=()=>{this.Gd=!1;this.Sc=void 0;return!1};this.onMouseMove=c=>{if(this.Gd&&this.$k(c))return this.Th(c),!1};this.onMouseLeave=c=>{this.Gd&&this.Th(c)};this.Th=c=>{this.Gd=!1;this.Sc=void 0;c={x:c.clientX,y:c.clientY};const {top:d,left:e,width:f,height:g}=this.node.getBoundingClientRect();
this.startDrag({$b:c,wc:{x:e,y:d},ec:{width:f,height:g}})};this.$k=c=>{if(this.Sc==null)return!0;var d=c.clientX,e=c.clientY;c=this.Sc.timestamp>this.se.now()-100;d=Math.abs(this.Sc.coords.x-d)<10;e=Math.abs(this.Sc.coords.y-e)<10;return!(c&&d&&e)}}};var Ux=class{Xf({node:a,dragData:b}){return()=>{a.nodeName.toLowerCase()==="img"&&(b={fullSize:{width:a.naturalWidth||a.width,height:a.naturalHeight||a.height},previewSrc:a.src,previewSize:{width:a.width,height:a.height},...b});ai(b);return Promise.resolve(b)}}kc({node:a,dragData:b}){if(Li(b))return this.Xf({node:a,dragData:b});a.nodeName.toLowerCase()==="img"?bi({fullSizeSrc:a.src,...b}):Zh(b);if((b===null||b===void 0?0:b.type)&&b.type!=="IMAGE")throw new G({code:"bad_request",message:`Invalid drag type. Expected 'IMAGE' received '${b.type}'`});
return async()=>{var c=a.nodeName.toLowerCase()==="img"?a:void 0;c={type:"IMAGE",...(c&&{fullSizeSrc:c.src,fullSize:{width:c.naturalWidth,height:c.naturalHeight},previewSize:{width:c.width,height:c.height}}),...b};if(!Zh(c))throw new G({code:"bad_request",message:"Invalid image data"});await Mi(c);return c}}async fc(a,b){var c={...b};a.nodeName.toLowerCase()==="img"&&(c={fullSize:{width:a.naturalWidth||a.width,height:a.naturalHeight||a.height},previewSize:{width:a.width,height:a.height}},a.src&&(c.previewUrl=
a.src),c={...c,...b});wi(c);return Promise.resolve(c)}};var Ui=(a,b)=>{switch(a.type){case "text":return new Xi({...a,...b});case "audio":return new Zi({...a,...b});case "embed":return{...b,...Vx(a,["previewUrl"]),previewSrc:a.previewUrl,type:"EMBED"};case "video":return new Yi({...b,...Vx(a,["previewUrl"]),previewSrc:a.previewUrl});case "image":return new Vi({...b,...Vx(a,["previewUrl","fullSize"]),previewSrc:a.previewUrl});default:throw new L({code:"internal_error",message:`Unsupported drag type: '${a}'.`});}},Vx=(a,b)=>Object.keys(a).filter(c=>!b.includes(c)).reduce((c,
d)=>({...c,[d]:a[d]}),{});var Xx=class{kc(a){return()=>{var b=this.Dc.getComputedStyle(a.node),c=a.dragData&&Object.fromEntries(Object.entries(a.dragData).filter(([,d])=>d!=null));c={fontStyle:b.fontStyle==="italic"?"italic":"normal",decoration:b.textDecoration.includes("underline")?"underline":"none",fontWeight:parseInt(b.fontWeight,10)>=600?"bold":"normal",textAlign:Ni(b.textAlign),children:[a.node.innerText],...c,type:"TEXT"};di(c);if(b=parseFloat(b.fontSize))c.fontSize=b;return Promise.resolve(c)}}async fc(a,b){var c=
Wx(a);c=this.Dc.getComputedStyle(c);b=b&&Object.fromEntries(Object.entries(b).filter(([,d])=>d!=null));a={fontStyle:c.fontStyle==="italic"?"italic":"normal",decoration:c.textDecoration.includes("underline")?"underline":"none",fontWeight:parseInt(c.fontWeight,10)>=600?"bold":"normal",textAlign:Ni(c.textAlign),children:a instanceof HTMLElement?[a.innerText]:[],...b,type:"text"};xi(a);if(c=parseFloat(c.fontSize))a.fontSize=c;return Promise.resolve(a)}constructor(){this.Dc=window}},Wx=a=>{var b;if(a.nodeType===
Node.TEXT_NODE||((b=a.firstChild)===null||b===void 0?void 0:b.nodeType)===Node.TEXT_NODE)return a;b=[...a.querySelectorAll("*")].filter(c=>{var d;return((d=c.firstChild)===null||d===void 0?void 0:d.nodeType)===Node.TEXT_NODE});return b.length>0?b[0]:a};var Yx=class{Xf({node:a,dragData:b}){return()=>{a.nodeName.toLowerCase()==="img"&&(b={fullSize:{width:a.naturalWidth||a.width,height:a.naturalHeight||a.height},previewSrc:a.src,previewSize:{width:a.width,height:a.height},...b});if(!fi(b))throw new G({code:"bad_request",message:"invalid drag data"});return Promise.resolve(b)}}kc({node:a,dragData:b}){a.nodeName.toLowerCase()==="img"?ii({previewSrc:a.src,...b}):fi(b);if((b===null||b===void 0?void 0:b.type)!=="VIDEO")throw new G({code:"bad_request",message:`Invalid drag type. Expected 'Video' received '${b===
null||b===void 0?void 0:b.type}'`});return this.Xf({node:a,dragData:b})}async fc(a,b){a.nodeName.toLowerCase()==="img"?Ai({previewUrl:a.src,...b}):zi(b);let c={...b};a.nodeName.toLowerCase()==="img"&&(c={fullSize:{width:a.naturalWidth||a.width,height:a.naturalHeight||a.height},previewUrl:a.src,previewSize:{width:a.width,height:a.height},...b});if(!zi(c))throw new G({code:"bad_request",message:"invalid drag data"});return Promise.resolve(c)}};var Zx,Ti=["video","image","text","audio","embed"],$x=(a,b)=>{a=new Tx(a,b);a.init();return a},fj=class{async startDrag(a,b){this.B("startDrag");Ck(this.Y,{Hb:"method",Ib:"startDrag",Ob:"startDragToPoint or startDragToCursor"});return(a=await Pi(this,a,b))?Qi(this,a.zg,a.onDragEnd):void 0}async startDragToPoint(a,b){this.B("startDragToPoint");return(a=await Pi(this,a,b))?Ri(this,a.zg,a.onDragEnd):void 0}async startDragToCursor(a,b){this.B("startDragToCursor");switch(b.type){case "embed":case "image":case "video":break;
default:throw new G({code:"bad_request",message:`Invalid drag type: ${b}`});}return(a=await Pi(this,a,b))?Si(this,a.zg,a.onDragEnd):void 0}Fg(){return K(this.Nj,"bad_request","'resolveAudioRef' could not be found. Please confirm that it has been supplied in 'dragData'")()}Gg(){return K(this.bg,"bad_request","resolveImageRef could not be found. Please confirm that it has been supplied in dragData")()}B(a){this.j.B(st({namespace:"design",client:"DragAndDrop",method:a}))}constructor(a,b,c,d,e=$x,f=new Ux,
g=new Xx,h=new Yx,l=new Nx){this.Jb=b;this.Y=c;this.j=d;this.lk=e;this.Rh=f;this.ej=g;this.sj=h;this.kh=l;this.Rf=(Zx(this),new Map);this.Im=n=>{const r=this.Rf.get(n);if(r)try{r.dj()}finally{this.Rf.delete(n)}};this.Il=n=>({onDragStart:r=>{n.onDragStart(r)},onDragEnd:r=>{n.onDragEnd(r)}});this.Gm=(n,r,t)=>{this.Im(n);this.Rf.set(n,this.lk(n,$i(this,n,this.Il(r),t)))};this.Yi=n=>{this.bg=n};this.Zi=n=>{this.Kn=n};this.Wi=n=>{this.Nj=n};this.A=new Rx(a);Gi(a,{Gg:()=>this.Gg(),Om:()=>K(this.Kn,"bad_request",
"resolveVideoRef could not be found. Please confirm that it has been supplied in dragData")(),Fg:()=>this.Fg()})}};({e:[Zx]}=jr(fj,[[M("design.v1.ui.startDrag"),2,"startDrag"],[M("design.v2.ui.startDragToPoint"),2,"startDragToPoint"],[M("design.v2.ui.startDragToCursor"),2,"startDragToCursor"]],[]));Sb(fj.prototype);var gj=class{start(){this.B("start");this.stop();this.addEventListener("mousemove",this.ni);this.addEventListener("mouseup",this.onDragEnd)}stop(){this.B("stop");this.removeEventListener("mousemove",this.ni);this.removeEventListener("mouseup",this.onDragEnd)}B(a){this.j.B(st({namespace:"design",client:"DragSync",method:a}))}constructor(a,b,c=f=>window.requestAnimationFrame(f),d=(f,g)=>window.addEventListener(f,g),e=(f,g)=>window.removeEventListener(f,g)){this.l=a;this.j=b;this.requestAnimationFrame=
c;this.addEventListener=d;this.removeEventListener=e;this.timestamp=0;this.rh=g=>async({clientX:h,clientY:l})=>{await Ki(this.A,{sn:g,timestamp:this.timestamp,x:h,y:l})};this.A=new Rx(a);const f=this.rh("mousemove");this.ni=g=>{this.requestAnimationFrame(h=>{if(!(h<=this.timestamp))return this.timestamp=h,f(g)})};this.onDragEnd=this.rh("mouseup")}};var ay=C(()=>({bleedMicrons:T(1),resizeBleedBackground:Y(2)}));var by=C(()=>({crops:Z(1),bleed:z(2,ay)}));var cy=C(()=>({zk:Z(1),Yj:X(2),Ak:Z(3),enablePageSelect:Z(4)}));var dy=C(()=>({channels:V(1),sampleRateHz:V(2)}));var ey=C(()=>({fps:V(1),minBitrateKbps:V(2),maxFileSizeKb:V(3),durationInSeconds:V(4),audio:z(5,dy)}));var fy=C(()=>({In:z(1,ey)}));var gy=C(()=>({acceptedFileTypes:Lr(1),Jm:z(2,by),zn:z(3,cy),jm:z(4,fy)}));var hy=C(()=>({url:W(1)}));var iy=C(()=>({exportBlobs:A(1,hy),status:W(2),title:X(3)}));var jy=class{async requestExport(a){a=gy.C(a);a=await this.l.request("EXPORT_V1_REQUEST_EXPORT",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"EXPORT_V1_REQUEST_EXPORT: Response cannot be empty"});return iy.F(a.value)}constructor(a){this.l=a}};var ky=a=>{var b,c,d,e,f,g;const h=a.acceptedFileTypes.find(x=>typeof x!=="string"&&x.type==="pdf_hq"),l=a.acceptedFileTypes.find(x=>typeof x!=="string"&&x.type==="video"),n={crops:h===null||h===void 0?void 0:(b=h.cropsAndBleed)===null||b===void 0?void 0:b.crops,bleed:h===null||h===void 0?void 0:(c=h.cropsAndBleed)===null||c===void 0?void 0:c.bleed};b=new ey({fps:l===null||l===void 0?void 0:l.fps,minBitrateKbps:l===null||l===void 0?void 0:l.minBitrateKbps,maxFileSizeKb:l===null||l===void 0?void 0:
l.maxFileSizeKb,durationInSeconds:l===null||l===void 0?void 0:l.durationInSeconds,audio:(l===null||l===void 0?0:l.audio)?new dy(l.audio):void 0});var r,t,w;c={zk:(h===null||h===void 0?void 0:(d=h.cropsAndBleed)===null||d===void 0?void 0:d.bleed)!==void 0||(h===null||h===void 0?void 0:(e=h.cropsAndBleed)===null||e===void 0?void 0:e.crops)!==void 0?!1:!0,Yj:(r=h===null||h===void 0?void 0:(f=h.colorModel)===null||f===void 0?void 0:f.value)!==null&&r!==void 0?r:"RGB",Ak:(t=h===null||h===void 0?void 0:
(g=h.pdfNotes)===null||g===void 0?void 0:g.allowUserEdit)!==null&&t!==void 0?t:!0,enablePageSelect:(w=a===null||a===void 0?void 0:a.enablePageSelect)!==null&&w!==void 0?w:!0};return new gy({acceptedFileTypes:[...(new Set(a.acceptedFileTypes.map(x=>typeof x==="string"?x:x.type)))],Jm:n,zn:c,jm:{In:b}})};var ly=new Set("png jpg pdf_standard pdf_hq video gif pptx svg".split(" ")),my=a=>{eb(typeof a==="object"&&a!=null,"bad_request","options passed to requestExport is not an object");eb(a.acceptedFileTypes!=null,"bad_request","`acceptedFileTypes` must be passed");eb(Array.isArray(a.acceptedFileTypes),"bad_request","`acceptedFileTypes` should be an array");eb(a.acceptedFileTypes.length>0,"bad_request","`acceptedFileTypes` requires at least one file type specified in the options");a=a.acceptedFileTypes.filter(b=>
!(b&&typeof b==="object"||typeof b==="string"&&ly.has(b)));eb(a.length===0,"bad_request",`Invalid file type(s) passed to requestExport: ${a.join(", ")}`)};var ny,ij=class{async queueDocument(a){this.B("queueDocument");return this.requestExport(a)}async requestExport(a){this.B("requestExport");my(a);a=await this.A.requestExport(ky(a));a:switch(a.status){case "completed":a={...a,exportBlobs:[...a.exportBlobs],status:"completed"};break a;case "aborted":a={...a,status:"aborted"};break a;default:throw new G({code:"internal_error",message:"Invalid export response."});}return a}B(a){this.j.B(st({namespace:"design",client:"Export",method:a}))}constructor(a,
b){this.j=b;ny(this);this.A=new jy(a)}};({e:[ny]}=jr(ij,[[M("design.v2.requestExport"),2,"queueDocument"],[M("design.v2.requestExport"),2,"requestExport"]],[]));Sb(ij.prototype);var jj=class{get createRichtextRange(){return this.P.createRichtextRange}get selection(){return this.P.selection}get overlay(){return this.P.overlay}get onAppElementChange(){return this.P.onAppElementChange}get getCurrentPageContext(){return this.P.getCurrentPageContext}get getDefaultPageDimensions(){return this.P.getDefaultPageDimensions}async setAppElementData(a,b){return this.P.setAppElementData(a,b)}addNativeElement(a){return this.P.addNativeElement(cj(a))}async addAudioTrack(a){return this.P.addAudioTrack(a)}get getDesignToken(){return this.P.getDesignToken}initAppElement({render:a}){this.P.B("initAppElement");
this.registerRenderAppElement(a);return{addOrUpdateElement:(...b)=>this.setAppElementData(...b),registerOnElementChange:(...b)=>this.onAppElementChange(...b)}}async openDesign(a,b){return this.P.openDesign(a,b)}constructor(a){this.P=a;this.registerRenderAppElement=b=>{this.P.registerRenderAppElement(function(c){return b(c).map(d=>cj(d))})};this.setCurrentPageBackground=b=>this.P.setCurrentPageBackground(bj(b));this.addPage=async b=>{if(!b)return this.P.addPage();const c=b.elements?b.elements.map(e=>
cj(e)):void 0,d=b.background?bj(b.background):void 0;return this.P.addPage({...b,elements:c,background:d})}}};var kj=class{makeDraggable(a){var b=this.P;b.B("makeDraggable");Ck(b.Y,{Hb:"method",Ib:"makeDraggable",Ob:"startDrag"});const c={onDragStart:a.onDragStart,onDragEnd:a.onDragEnd};let d;try{var e;const f=(e=a.dragData)===null||e===void 0?void 0:e.type;switch(f){case void 0:case "IMAGE":d=b.Rh.kc(a);break;case "TEXT":d=b.ej.kc(a);break;case "VIDEO":d=b.sj.kc(a);break;case "AUDIO":d=b.kh.kc(a);break;default:throw new L({code:"bad_request",message:`Unsupported and/or invalid drag data type: '${f}'`});
}b.Gm(a.node,c,d)}catch(f){if(f instanceof G)throw new G({code:f.code,message:`Encountered an error while trying to make node draggable: ${f.rawMessage}`});throw new G({code:"internal_error",message:`Encountered an error while trying to make node draggable: ${f instanceof Error?f.message:f}`});}}async startDrag(a,b){return this.P.startDrag(a,function(){const c=b.type;switch(c){case "TEXT":return{...b,type:"text"};case "AUDIO":return{...b,type:"audio"};case "EMBED":return{...b,type:"embed"};case "VIDEO":return{...b,
type:"video"};case "IMAGE":return{...b,type:"image"};default:throw new L({code:"bad_request",message:`Invalid drag type: ${c}`});}}())}constructor(a){this.P=a}};var lj=class{async queueDocument(a){return dj(await this.P.queueDocument(ej(a)))}async requestExport(a){return dj(await this.P.requestExport(ej(a)))}constructor(a){this.P=a}};var oj=C(()=>({Qg:V(1),Pg:V(2)}));var oy=class{constructor(a){this.l=a}};var ro=class{B(a){this.j.B(st({namespace:"dev_toolkit",client:"DevToolKit",method:a}))}constructor(a,b){this.l=a;this.j=b;this.Yh=!1;this.Jc=new Set;this.hg={Pg:void 0,Qg:void 0};this.ma=new oy(a);sj(this,c=>{this.hg=c})}};var tj={failed_precondition:"FAILED_PRECONDITION",bad_external_service_response:"BAD_EXTERNAL_SERVICE_RESPONSE",bad_request:"BAD_REQUEST",internal_error:"INTERNAL_ERROR",quota_exceeded:"QUOTA_EXCEEDED",rate_limited:"RATE_LIMITED",permission_denied:"PERMISSION_DENIED",missing_permission:"PERMISSION_DENIED",unsupported_surface:"UNSUPPORTED_SURFACE",unsupported_page_type:"BAD_REQUEST",user_offline:"USER_OFFLINE",not_found:"NOT_FOUND",not_allowed:"NOT_ALLOWED",timeout:"TIMEOUT"};var py=E(()=>[1,2]);var qy=C(()=>({feature:B(1,py)}));var ry=C(()=>({status:v(1,"COMPLETED")}));var sy=C(()=>({status:v(2,"ABANDONED")}));var ty=C(()=>({status:v(3,"UNAVAILABLE")}));var uy=D(()=>({status:[1,ry,2,sy,3,ty]}),()=>({}));var vy=C(()=>({requestId:W(1)}));var wy=C(()=>({status:v(1,"COMPLETED")}));var xy=C(()=>({status:v(2,"ABANDONED")}));var yy=D(()=>({status:[1,wy,2,xy]}),()=>({}));var zy=C(()=>({feature:B(1,py)}));var Ay=C(()=>({limit:V(1),usage:T(2),resetsAt:Jr(3),canUpgrade:Y(4)}));var By=C(()=>({type:v(1,"IMAGEN"),prompt:W(1)}));var Cy=C(()=>({type:v(2,"DALLE"),prompt:W(1)}));var Dy=D(()=>({type:[1,By,2,Cy]}),()=>({}));var Ey=C(()=>({url:W(1),thumbnailUrl:X(2)}));var Fy=C(()=>({type:v(1,"SUCCESS"),images:A(1,Ey),requestId:W(2)}));var Gy=E(()=>[1,2,3]);var Hy=C(()=>({type:v(2,"FAILURE"),reason:B(1,Gy)}));var Iy=D(()=>({type:[1,Fy,2,Hy]}),()=>({}));var Jy=class{async requestUpgrade(a){a=qy.C(a);a=await this.l.request("GENERATION_V1_REQUEST_UPGRADE",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"GENERATION_V1_GET_QUOTA: Response cannot be empty"});return uy.F(a.value)}async requestReportContent(a){a=vy.C(a);a=await this.l.request("GENERATION_V1_REQUEST_REPORT",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"GENERATION_V1_GET_QUOTA: Response cannot be empty"});
return yy.F(a.value)}async getQuota(a){a=zy.C(a);a=await this.l.request("GENERATION_V1_GET_QUOTA",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"GENERATION_V1_GET_QUOTA: Response cannot be empty"});return Ay.F(a.value)}async generateImages(a){a=Dy.C(a);a=await this.l.request("GENERATION_V1_GENERATE",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"GENERATION_V1_GENERATE: Response cannot be empty"});return Iy.F(a.value)}constructor(a){this.l=
a}};var Ky,so=class{async requestReportContent(a){this.B("requestReportContent");return{status:(await this.A.requestReportContent(a)).status}}async generateImages(a){this.B("generateImages");if(!["DALLE","IMAGEN"].includes(a.type))throw new G({code:"bad_request",message:`Request type must be one of "DALLE" or "IMAGEN". Received ${a.type}`});if(!a.prompt||a.prompt.length===0)throw new G({code:"bad_request",message:"Request requires a non-empty prompt"});a=await this.A.generateImages({type:a.type,prompt:a.prompt});
if(a.type==="FAILURE"){switch(a.reason){case 1:a="QUOTA_EXCEEDED";break;case 2:a="INTERNAL_ERROR";break;case 3:a="UNSAFE_CONTENT";break;default:throw new L({code:"internal_error",message:`Unknown image failure response reason ${a.reason}`});}return{status:"FAILURE",reason:a}}return{status:"SUCCESS",images:a.images,requestId:a.requestId}}async getQuota(a){this.B("getQuota");switch(a.feature){case "DALLE":a=2;break;case "IMAGEN":a=1;break;default:throw new G({code:"internal_error",message:`Unknown feature ${a.feature}`});
}a=await this.A.getQuota({feature:a});return{limit:a.limit,usage:a.usage,resetsAt:a.resetsAt!=null?new Date(a.resetsAt):void 0,canUpgrade:a.canUpgrade}}B(a){this.j.B(st({namespace:"generation",client:"Generation",method:a}))}constructor(a,b){this.j=b;this.requestUpgrade=(Ky(this),async c=>{this.B("requestUpgrade");switch(c.feature){case "DALLE":c=2;break;case "IMAGEN":c=1;break;default:throw new G({code:"internal_error",message:`Unknown feature ${c.feature}`});}return{status:(await this.A.requestUpgrade({feature:c})).status}});
this.A=new Jy(a)}};({e:[Ky]}=jr(so,[[M("generation.v2.requestReportContent"),2,"requestReportContent"],[M("generation.v2.generateImages"),2,"generateImages"],[M("generation.v2.getQuota"),2,"getQuota"]],[]));var vo=class{async getUiContext(){this.B("getUiContext");const a=await this.ma.getUiContext();this.pk();if(a.theme!=="light"&&a.theme!=="dark")throw new G({code:"internal_error",message:`Invalid theme: ${a.theme}. Expected 'light' or 'dark'.`});if(a.direction!=="ltr"&&a.direction!=="rtl")throw new G({code:"internal_error",message:`Invalid direction: ${a.direction}. Expected 'ltr' or 'rtl'.`});return{theme:a.theme,direction:a.direction}}onUiContextChange(a){this.Jc.add(a);xj(this);return()=>this.Jc.delete(a)}registerAppUiKitVersion(a){return this.ma.registerAppUiKitVersion(a)}Ng(a){this.Jc.forEach(b=>
b(a))}B(a){this.j.B(st({namespace:"ui_kit",client:"UiKit",method:a}))}constructor(a,b){this.l=a;this.j=b;this.$h=!1;this.Jc=new Set;this.pk=()=>{window.document.documentElement.classList.add("cc24")};this.ma=new Rk(a)}};var Ly=C(()=>({url:W(1)}));var My=C(()=>({status:v(1,"COMPLETED")}));var Ny=C(()=>({status:v(2,"ABORTED")}));var Oy=D(()=>({status:[1,My,2,Ny]}),()=>({}));var Py=class{async requestOpenExternalUrl(a){a=Ly.C(a);a=await this.l.request("PLATFORM_V1_REQUEST_OPEN_EXTERNAL_URL",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"PLATFORM_V1_REQUEST_OPEN_EXTERNAL_URL: Response cannot be empty"});return Oy.F(a.value)}constructor(a){this.l=a}};var Qy,lk=class{async requestOpenExternalUrl(a){this.B("requestOpenExternalUrl");if(typeof a!=="object"||a==null)throw new G({code:"bad_request",message:'Invalid request object. Expected an object of type `OpenExternalUrlRequest`, such as "{ url: "https://canva.com" }", but received a non-object value.'});if(a.url==null)throw new G({code:"bad_request",message:'Invalid request object. Expected an object of type `OpenExternalUrlRequest` with a `url` property, such as "{ url: "https://canva.com" }", but received an object with an empty or undefined `url` property.'});
if(typeof a.url!=="string")throw new G({code:"bad_request",message:"Invalid url type. Expected a string, but received a non-string value."});let b;try{b=new URL(a.url)}catch(c){throw new G({code:"bad_request",message:`The url provided in the request is not a valid URL. Received the following error when trying to parse the URL: ${c}.`});}if(b.protocol.toLowerCase()!=="https:")throw new G({code:"bad_request",message:`Received a request to open an external URL with '${b.protocol}' protocol. Only URLs with '${"https:"}' protocol are supported.`});
a:switch((await this.A.requestOpenExternalUrl(a)).status){case "COMPLETED":a={status:"completed"};break a;case "ABORTED":a={status:"aborted"};break a;default:throw new L({code:"internal_error",message:"Invalid response status"});}return a}getPlatformInfo(){this.B("getPlatformInfo");return this.info}B(a){this.j.B(st({namespace:"platform",client:"Platform",method:a}))}constructor(a,b,c){this.info=b;this.j=c;Qy(this);this.A=new Py(a)}};
({e:[Qy]}=jr(lk,[[M("platform.v2.requestOpenExternalUrl"),2,"requestOpenExternalUrl"],[M("platform.v2.getPlatformInfo"),2,"getPlatformInfo"]],[]));var Ry=E(()=>[1,2,3,4,{Tb:!0},5,{Tb:!0},6,7]);var Sy=C(()=>({surface:B(1,Ry),processId:W(2)}));var Ty=E(()=>[1,2]);var Uy=C(()=>({reason:B(1,Ty)}));var Vy=C(()=>({params:y(1,Uy),cj:W(2)}));var Wy=()=>({Rg:W(1)});var Xy=C(()=>({...Wy(),type:v(2,"CLOSING"),params:y(2,Uy)}));var Gj=D(()=>({type:[2,Xy]}),Wy);var Hj=C(()=>({surface:B(1,Ry),processId:W(2)}));var Yy=()=>({Rg:W(1)});var Zy=C(()=>({...Yy(),type:v(2,"OPENING")}));var $y=C(()=>({...Yy(),type:v(3,"OPEN")}));var az=C(()=>({...Yy(),type:v(4,"CLOSING"),params:y(2,Uy)}));var bz=C(()=>({...Yy(),type:v(5,"CLOSED")}));var cz=C(()=>({...Yy(),type:v(6,"SUSPENDED")}));var Fj=D(()=>({type:[2,Zy,3,$y,4,az,5,bz,6,cz]}),Yy);var Aj=C(()=>({yc:Y(1)}));var yj=C(()=>({processId:W(1),yc:Y(2)}));var dz=E(()=>[1,2,3,4,5,{Tb:!0}]);var Cj=C(()=>({processId:W(1),Ki:Y(2),state:B(3,dz)}));var Oj=class{async requestClose(a){a=hh(Vy.C(a[0]),a[1]);a=await this.l.request("APP_PROCESS_V1_REQUEST_CLOSE",a);if(!a.ok)throw a.error;}async getInfo(){var a=await this.l.request("APP_PROCESS_V1_GET_INFO");if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"APP_PROCESS_V1_GET_INFO: Response cannot be empty"});var b=a.value;if(!Ej(b))throw new G({code:"internal_error",message:"Could not convert object into GetInfoResponse"});a=b[1];b=b[2];if(a===void 0)throw new G({code:"internal_error",
message:"Missing AppProcessInfo in GetInfoResponse"});return[Sy.F(a),b]}async broadcastMessage(a){a=hh(...a);a=await this.l.request("APP_PROCESS_V1_BROADCAST_MESSAGE",a);if(!a.ok)throw a.error;}constructor(a){this.l=a}};var Pj=class{B(a){this.j.B(st({namespace:"platform",client:"AppProcess",method:a}))}constructor(a,b,c,d){this.La=b;this.Y=c;this.j=d;this.tg=new Map;this.ug=new Set;this.pg=new Set;this.current={getInfo:()=>{this.B("current.getInfo");return this.La},requestClose:async e=>{this.B("current.requestClose");if(this.La.surface!=="selected_image_overlay")throw new G({code:"bad_request",message:`requestClose is not implemented for surface ${this.La.surface}`});await this.A.requestClose([{params:{reason:Mj(e.reason)},
cj:this.La.processId},e])},setOnDispose:e=>{this.B("current.setOnDispose");if(this.La.surface!=="selected_image_overlay")throw new G({code:"bad_request",message:`setOnDispose is not implemented for surface ${this.La.surface}`});this.mi=Nj(e);Dj(this.A,{processId:this.La.processId,state:3,Ki:!0});return()=>new Promise(async f=>{this.mi=void 0;await Dj(this.A,{processId:this.La.processId,state:3,Ki:!1});f()})},Hm:e=>{this.B("current.registerOnStateChangeInternal");const f=this.La.processId;this.ug.add(e);
zj(this.A,{processId:f,yc:!0});return()=>new Promise(g=>{this.ug.delete(e);zj(this.A,{processId:f,yc:!1});g()})}};this.requestClose=async(e,f)=>{this.B("requestClose");await this.A.requestClose([{params:{reason:Mj(f.reason)},cj:e},f])};this.registerOnStateChange=(e,f)=>{this.B("registerOnStateChange");if(typeof e!=="string")throw new G({code:"bad_request",message:"Invalid target process"});if(e===this.La.processId)throw new G({code:"bad_request",message:"Cannot subscribe to state changes of the current process"});
const g=Nj(f);let h=this.tg.get(e);h||(h=new Set,this.tg.set(e,h));h.add(g);zj(this.A,{processId:e,yc:!0});return()=>new Promise(l=>{h.delete(g);zj(this.A,{processId:e,yc:!1});l()})};this.registerOnMessage=e=>{this.B("registerOnMessage");const f=Nj(e);this.pg.add(f);Bj(this.A,{yc:!0});return()=>new Promise(g=>{this.pg.delete(f);Bj(this.A,{yc:!1});g()})};this.broadcastMessage=e=>{this.B("broadcastMessage");this.A.broadcastMessage([void 0,e])};this.A=new Oj(a);Ij(a,{Vl:async e=>{const f=e[0],g=this.tg.get(f.Rg);
g===null||g===void 0||g.forEach(h=>{f.type!=="SUSPENDED"&&h({state:Jj(e)})});this.ug.forEach(h=>{h({state:e[0].type==="SUSPENDED"?"suspended":Jj(e)})})},Tm:async([e,f])=>{var g;if(e.type==="CLOSING"&&e.Rg===this.La.processId){if((g=this.mi)===null||g===void 0)f=void 0;else{var h=g.call;a:switch(e=e.params.reason,e){case 1:e="completed";break a;case 2:e="aborted";break a;default:throw new L({code:"bad_request",message:`Unknown proto close reason: ${e}`});}f=h.call(g,this,{...f,reason:e})}await f}},
Sm:async e=>{const [f,g]=e;this.pg.forEach(h=>{h({appProcessId:f.processId,surface:Kj(f.surface)},g)})}})}};var Sj=C(()=>({features:Lr(1)}));var ez=C(()=>({methods:Lr(1),Cj:Z(2),error:X(3),errorMessage:X(4)}));var fz=class{async hf(a){await this.l.request("FEATURE_SUPPORT_V1_TRACK_FEATURE_INSPECT_ATTEMPTED",ez.C(a))}constructor(a){this.l=a}};var Yj=class{hf(a,b,c){this.ma.hf({methods:a,Cj:b,error:c===null||c===void 0?void 0:c.code,errorMessage:c===null||c===void 0?void 0:c.message})}Og(){Rj(this.kb,{Zm:async()=>{await Xj(this);this.Tg.forEach(a=>a())}})}constructor(a){this.kb=a;this.Tg=new Set;this.oj=new Set;this.isSupported=(...b)=>{try{Wj(b);const c=b.map(Rb).filter(Hd),d=c.every(e=>!this.oj.has(e));this.hf(c,d);return d}catch(c){throw c instanceof G&&this.hf([],void 0,c),c;}};this.registerOnSupportChange=b=>{eb(typeof b==="function",
"bad_request","Argument to registerOnSupportChange must be a function.");Vj(this.ma);this.Tg.add(b);b();return()=>this.Tg.delete(b)};this.Og();this.ma=new fz(this.kb);Uj(this.ma)}};var gz={a:"a\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5\u0101\u0103\u0105".split(""),A:"A\u00c0\u00c1\u00c2\u00c3\u00c4\u00c5\u0100\u0102\u0104".split(""),e:"e\u00e8\u00e9\u00ea\u00eb\u0113\u0115\u0117\u0119\u011b".split(""),E:"E\u00c8\u00c9\u00ca\u00cb\u0112\u0114\u0116\u0118\u011a".split(""),i:"i\u00ec\u00ed\u00ee\u00ef\u0129\u012b\u012d\u012f".split(""),I:"I\u00cc\u00cd\u00ce\u00cf\u0128\u012a\u012c\u012e\u0130".split(""),o:"o\u00f2\u00f3\u00f4\u00f5\u00f6\u014d\u014f\u0151".split(""),O:"O\u00d2\u00d3\u00d4\u00d5\u00d6\u014c\u014e\u0150".split(""),
u:"u\u00f9\u00fa\u00fb\u00fc\u0169\u016b\u016d\u016f\u0171\u0173".split(""),U:"U\u00d9\u00da\u00db\u00dc\u0168\u016a\u016c\u016e\u0170\u0172".split(""),y:["\u1e99","\u00fd","\u00ff","\u0177"],Y:["\u024e","\u00dd","\u0176","\u0178"]},fk=(a,b)=>{const c=b+a.length;return[...a].map((d,e)=>/[aeiouy]/i.test(d)?gz[d][(c+e)%gz[d].length]:d).join("")},hz=a=>a.replace(/[aeiou]/gi,b=>b.repeat(2)),gk=(a,b=ck(a.length))=>{if(b<=1)throw Error("Expansion rate must be above 1.0");return/[a-z]/gi.test(a)?hz(a):a},
iz=a=>{a=jk(a);return or(a)};var ok=class{getLocalizedMessages(){this.B("getLocalizedMessages");if(this.i18n==null)throw new G({code:"internal_error",message:"Failed to load localized messages for the app"});return this.i18n.Hl}pseudolocalize(a){this.B("pseudolocalize");let b=a;try{b=this.zm(a,!1)}catch(c){this.j.G(c),console.error(`Failed to pseudolocalize the string '${a}'. Error: `,c)}return b}B(a){this.j.B(st({namespace:"platform",client:"I18n",method:a}))}constructor(a,b){this.i18n=a;this.j=b;this.zm=iz}};var jz=C(()=>({messageText:W(1),timeoutMs:V(2),yl:Z(3)}));var kz=C(()=>({status:v(1,"COMPLETED")}));var lz=D(()=>({status:[1,kz]}),()=>({}));var mz=class{async addToast(a){return hb(this.l,"PLATFORM_V1_NOTIFICATION_ADD_TOAST",jz,a,lz)}constructor(a){this.l=a}};var nz,mk=class{async addToast(a){this.B("addToast");if(!a.messageText)throw new G({code:"bad_request",message:"Message text is required"});a:switch((await this.A.addToast(new jz({...a,timeoutMs:a.timeoutMs==="infinite"?void 0:a.timeoutMs,yl:a.timeoutMs==="infinite"}))).status){case "COMPLETED":a={status:"completed"};break a;default:throw new L({code:"internal_error",message:"Invalid response status"});}return a}B(a){this.j.B(st({namespace:"platform",client:"Notification",method:a}))}constructor(a,
b){this.j=b;nz(this);this.A=new mz(a)}};({e:[nz]}=jr(mk,[[M("platform.v2.notification.addToast"),2,"addToast"]],[]));var nk=class{constructor(a){this.client=a;this.requestOpenExternalUrl=async b=>{b=(await this.client.requestOpenExternalUrl(b)).status;switch(b){case "completed":return{status:"COMPLETED"};case "aborted":return{status:"ABORTED"};default:throw new L({code:"internal_error",message:`Unknown open external url status: ${b}`});}};this.getPlatformInfo=()=>this.client.getPlatformInfo()}};var oz=C(()=>({name:W(1),version:W(2),Eg:W(3)}));var pz=class{async registerPackageVersion(a,b,c){await hb(this.l,"SDK_REGISTRATION_V1_REGISTER_PACKAGE_VERSION",oz,new oz({name:a,version:b,Eg:c}))}constructor(a){this.l=a}};var wo=class{registerPackageVersion(a,b,c){qk(b).major>=2&&(uo=d=>d);rk(this,a,b,c)}constructor(a,b){this.j=a;this.A=new pz(b)}};var qz=C(()=>({}));var rz=C(()=>({status:v(1,"COMPLETED")}));var sz=C(()=>({status:v(2,"ABORTED")}));var tz=D(()=>({status:[1,rz,2,sz]}),()=>({}));var uz=C(()=>({token:W(1)}));var vz=class{async requestOauth(a){a=a?qz.C(a):void 0;a=await this.l.request("TEMP_GOOGLE_ADS_REQUEST_OAUTH_V1",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"TEMP_GOOGLE_ADS_REQUEST_OAUTH_V1: Response cannot be empty"});return tz.F(a.value)}async getOauthToken(){const a=await this.l.request("TEMP_GOOGLE_ADS_GET_OAUTH_TOKEN_V1");if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"TEMP_GOOGLE_ADS_REQUEST_OAUTH_V1: Response cannot be empty"});
return uz.F(a.value)}constructor(a){this.l=a}};var sk=class{B(a){this.j.B(st({namespace:"tmp_google_ads_auth",client:"TmpGoogleAdsAuth",method:a}))}constructor(a,b){this.j=b;this.requestOauth=async c=>{this.B("requestOauth");try{return await this.A.requestOauth(c)}catch(d){if(d instanceof G)throw d;throw new G({code:"internal_error",message:"Something unexpected happened during oauth"});}};this.getOauthToken=async()=>{this.B("getOauthToken");try{const c=await this.A.getOauthToken();return c===null||c===void 0?void 0:c.token}catch(c){if(c instanceof
G)throw c;throw new G({code:"internal_error",message:"Something unexpected happened during while requesting an OAuth token"});}};this.A=new vz(a)}};var wz=C(()=>({key:W(1),value:W(2)}));var xz=C(()=>({scope:Lr(1)}));var yz=C(()=>({queryParams:A(1,wz),scope:z(2,xz),skipConnectionScreen:Z(3)}));var zz=C(()=>({status:v(1,"SUCCESS"),scope:Lr(1)}));var Az=C(()=>({status:v(2,"ABORTED")}));var Bz=E(()=>[1,2,3,4,5,6,7,8,9,10,11,12,13]);var Cz=C(()=>({status:v(3,"ERROR"),code:B(1,Bz),message:X(2),uri:X(3)}));var Dz=D(()=>({status:[1,zz,2,Az,3,Cz]}),()=>({}));var Ez=C(()=>({forceRefresh:Z(1),scope:z(2,xz)}));var Fz=C(()=>({status:v(1,"SUCCESS"),dh:X(1),scope:z(2,xz)}));var Gz=C(()=>({status:v(2,"ERROR"),code:B(1,Bz),message:X(2),uri:X(3)}));var Hz=D(()=>({status:[1,Fz,2,Gz]}),()=>({}));var Iz=class{async authorize(a){a=yz.C(a);a=await this.l.request("AUTH_V1_OAUTH_AUTHORIZE",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"AUTH_V1_OAUTH_AUTHORIZE: Response cannot be empty"});return Dz.F(a.value)}async getAccessToken(a){a=Ez.C(a);a=await this.l.request("AUTH_V1_OAUTH_GET_ACCESS_TOKEN",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"AUTH_V1_OAUTH_GET_ACCESS_TOKEN: Response cannot be empty"});return Hz.F(a.value)}async deauthorize(){const a=
await this.l.request("AUTH_V1_OAUTH_DEAUTHORIZE");if(!a.ok)throw a.error;}constructor(a){this.l=a}};var Jz={invalid_request:"The request is missing a required parameter, includes an invalid parameter value, includes a parameter more than once, or is otherwise malformed.",access_denied:"The resource owner or authorization server denied the request.",unauthorized_client:"The client is not authorized to request an authorization code using this method.",invalid_client:"Client authentication failed (e.g., unknown client, no client authentication included, or unsupported authentication method).",invalid_scope:"The requested scope is invalid, unknown, or malformed.",
invalid_grant:"The provided authorization grant or refresh token is invalid, expired, revoked, does not match the redirection URI used in the authorization request, or was issued to another client.",unsupported_response_type:"The authorization server does not support obtaining an authorization code using this method.",unsupported_grant_type:"The authorization grant type is not supported by the authorization server.",unsupported_token_type:"The authorization server does not support the requested token type.",
server_error:"The authorization server encountered an unexpected condition that prevented it from fulfilling the request.",temporarily_unavailable:"The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server.",bad_server_response:"The authorization server returned an invalid response.",other_error:"An error occurred during the OAuth flow."},Uk=class extends G{constructor(a,b,c){var d=uk(a);const e=b!==null&&b!==void 0?b:Jz[a],f=c?
`${e.endsWith(".")?"":"."} See ${c} for more info.`:"";super({code:d,message:`[${a}]: ${e}${f}`});this.uri=c;this.rawMessage=b!==null&&b!==void 0?b:Jz[a];this.name="OauthError";Object.setPrototypeOf(this,Uk.prototype)}};var xk=new Set("client_id redirect_uri scope state response_type code_challenge code_challenge_method client_secret".split(" ")),Kz=class{B(a){this.j.B(st({namespace:"user",client:"Authentication",method:a}))}async authorize(a){return this.requestAuthorization(a)}async requestAuthorization(a={}){this.B("authorize");if(!vk(a))throw new G({code:"bad_request",message:"Invalid parameters"});const {scope:b,queryParams:c={},skipConnectionScreen:d}=a;if(!(b==null||b instanceof Set))throw new G({code:"bad_request",
message:"Invalid scope"});if(!vk(c)||!wk(c))throw new G({code:"bad_request",message:"Invalid query parameters"});a=Object.keys(c).filter(yk);if(a.length>0)throw new G({code:"bad_request",message:`Forbidden keys in query parameters: ${a.join(", ")}`});try{const e=await this.A.authorize(new yz({queryParams:zk(c),scope:b?{scope:[...b.values()]}:void 0,skipConnectionScreen:d}));switch(e.status){case "ABORTED":return{status:"aborted"};case "SUCCESS":return{scope:new Set(e.scope),status:"completed"};case "ERROR":const f=
Ak(e.code);throw new Uk(f,e.message,e.uri);default:throw new L({code:"internal_error",message:"Invalid response status"});}}catch(e){if(e instanceof G||e instanceof Uk)throw e;throw new G({code:"internal_error",message:`Something unexpected happened while calling authorize: ${e instanceof Error?e.message:e}`});}}async getAccessToken({forceRefresh:a=!1,scope:b}={}){this.B("getAccessToken");if(!(b==null||b instanceof Set))throw new G({code:"bad_request",message:"Invalid scope"});if(a!=null&&typeof a!==
"boolean")throw new G({code:"bad_request",message:"Invalid force refresh parameter"});try{const e=await this.A.getAccessToken({forceRefresh:a,scope:b?{scope:[...b.values()]}:void 0});switch(e.status){case "SUCCESS":var c;if(!e.dh)return null;var d;return{scope:new Set((d=(c=e.scope)===null||c===void 0?void 0:c.scope)!==null&&d!==void 0?d:[]),token:e.dh};case "ERROR":const f=Ak(e.code);throw new Uk(f,e.message,e.uri);default:throw new L({code:"internal_error",message:"Invalid response status"});}}catch(e){if(e instanceof
G||e instanceof Uk)throw e;throw new G({code:"internal_error",message:`Something unexpected happened while calling getAccessToken: ${e instanceof Error?e.message:e}`});}}async deauthorize(){this.B("deauthorize");try{await this.A.deauthorize()}catch(a){if(a instanceof G)throw a;throw new G({code:"internal_error",message:`Something unexpected happened while calling deauthorize: ${a instanceof Error?a.message:a}`});}}constructor(a,b){this.j=a;this.kb=b;this.A=new Iz(b)}};var Dk=C(()=>({context:X(1)}));var Lz=C(()=>({type:v(1,"AUTHENTICATED")}));var Mz=C(()=>({type:v(2,"CANCELED")}));var Nz=C(()=>({type:v(3,"DENIED"),details:Lr(1)}));var Oz=C(()=>({type:v(4,"FAILED"),tc:W(1),Cm:Lr(2)}));var Pz=D(()=>({type:[1,Lz,2,Mz,3,Nz,4,Oz]}),()=>({}));var Qz=C(()=>({token:W(1)}));var Rz=C(()=>({token:W(1)}));var Sz=class{async authenticate(a){a=Dk.C(a);a=await this.l.request("AUTH_V1_AUTHENTICATE",a);if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"AUTH_V1_AUTHENTICATE: Response cannot be empty"});return Pz.F(a.value)}async requestUpgrade(){const a=await this.l.request("AUTH_V1_REQUEST_UPGRADE");if(!a.ok)throw a.error;}async getUserCapabilitiesToken(){const a=await this.l.request("AUTH_V1_GET_USER_CAPABILITIES_TOKEN");if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",
message:"AUTH_V1_GET_USER_CAPABILITIES_TOKEN: Response cannot be empty"});return Qz.F(a.value)}async getCanvaUserToken(){const a=await this.l.request("AUTH_V1_GET_CANVA_USER_TOKEN");if(!a.ok)throw a.error;if(a.value===void 0)throw new G({code:"internal_error",message:"AUTH_V1_GET_CANVA_USER_TOKEN: Response cannot be empty"});return Rz.F(a.value)}constructor(a){this.l=a}};var Tz,Sk=class{getUserInfo(){this.B("getUserInfo");return this.info}async authenticate(a={}){this.B("authenticate");Ck(this.Y,{Hb:"method",Ib:"authenticate",Ob:"requestAuthentication"});try{const b=await this.A.authenticate(new Dk(a));return Bk(b)}catch(b){if(b instanceof G)throw b;throw new G({code:"internal_error",message:`Something unexpected happened while authenticating: ${b instanceof Error?b.message:b}`});}}async getCanvaUserToken(){this.B("getCanvaUserToken");try{return(await this.A.getCanvaUserToken()).token}catch(a){if(a instanceof
G)throw a;throw new G({code:"internal_error",message:`Something unexpected happened while retrieving the Canva Token: ${a instanceof Error?a.message:a}`});}}async getUserCapabilitiesToken(){this.B("getUserCapabilitiesToken");try{return(await this.A.getUserCapabilitiesToken()).token}catch(a){if(a instanceof G)throw a;throw new G({code:"internal_error",message:`Something unexpected happened while retrieving the User Capabilities Token: ${a instanceof Error?a.message:a}`});}}async requestUpgrade(){this.B("requestUpgrade");
try{return await this.A.requestUpgrade()}catch(a){if(a instanceof G)throw a;throw new G({code:"internal_error",message:`Something unexpected happened while requesting to upgrade: ${a instanceof Error?a.message:a}`});}}initOauth(){return new Kz(this.j,this.kb)}B(a){this.j.B(st({namespace:"user",client:"Authentication",method:a}))}constructor(a,b,c,d){this.kb=a;this.info=b;this.Y=c;this.j=d;Tz(this);this.A=new Sz(a)}};
({e:[Tz]}=jr(Sk,[[M("user.v2.auth.getUserInfo"),2,"getUserInfo"],[M("user.v2.auth.getCanvaUserToken"),2,"getCanvaUserToken"],[M("user.v2.auth.getUserCapabilitiesToken"),2,"getUserCapabilitiesToken"],[M("user.v2.auth.requestUpgrade"),2,"requestUpgrade"],[M("user.v2.auth.initOauth"),2,"initOauth"]],[]));Sb(Sk.prototype);var Uz=E(()=>[1,2,3,4,5,6,7,8,9,10,11,12]);var Gk=C(()=>({action:B(1,Uz)}));var Hk=C(()=>({xb:W(1)}));var Ik=C(()=>({xb:W(1)}));var Jk=C(()=>({xb:W(1)}));var Kk=C(()=>({xb:W(1)}));var Lk=C(()=>({}));var Mk=C(()=>({action:B(1,Uz)}));var Nk=C(()=>({enabled:Y(1)}));var Ok=C(()=>({action:B(1,Uz)}));var Vz=C(()=>({status:v(1,"GRANTED")}));var Wz=C(()=>({status:v(2,"DENIED")}));var Pk=D(()=>({status:[1,Vz,2,Wz]}),()=>({}));var Xz,Tk=class{async isEnabled(a){Xk(this.Y,"isEnabled");return(await this.A.isEnabled(new Mk({action:Fk(a)}))).enabled}async openTrackingSession(a){this.B("openTrackingSession");Xk(this.Y,"openTrackingSession");const b=c=>async()=>{await this.A.closeTrackingSession(new Kk({xb:c}))};if(a.id!=null)return a=await this.A.Pm(new Ik({xb:a.id})),{id:a.xb,closeTrackingSession:b(a.xb)};a=await this.A.rn(new Gk({action:Fk(a.action)}));return{id:a.xb,closeTrackingSession:b(a.xb)}}async requestEnableBillableAction(a){this.B("requestEnableBillableAction");
Xk(this.Y,"requestEnableBillableAction");a:switch(a=(await this.A.requestEnableBillableAction(new Ok({action:Fk(a)}))).status,a){case "GRANTED":a={status:"granted"};break a;case "DENIED":a={status:"denied"};break a;default:throw new L({code:"bad_request",message:`Invalid enable billable action status ${a}`});}return a}B(a){this.j.B(st({namespace:"user",client:"Monetization",method:a}))}constructor(a,b,c){this.kb=a;this.Y=b;this.j=c;Xz(this);this.A=Qk(a)}};
({e:[Xz]}=jr(Tk,[[M("user.v2.monetization.isEnabled"),2,"isEnabled"],[M("user.v2.monetization.openTrackingSession"),2,"openTrackingSession"],[M("user.v2.monetization.requestEnableBillableAction"),2,"requestEnableBillableAction"]],[]));var Vk=class{async authenticate(a={}){return this.P.authenticate(a)}async requestAuthentication(a={}){return Ek(this.P,a)}async getCanvaUserToken(){return this.P.getCanvaUserToken()}async getUserCapabilitiesToken(){return this.P.getUserCapabilitiesToken()}async requestUpgrade(){return this.P.requestUpgrade()}initOauth(){return this.P.initOauth()}constructor(a){this.P=a;this.getUserInfo=()=>this.P.getUserInfo()}};var qo=class{constructor(a,b){this.Ee=a;this.j=b;this.Ad=(c,d,e)=>{console.warn(`${"Apps SDK"}: ${e!=null?`The property "${e}" in the options for "${d}"`:`The method ${d}`} is currently ${c==="preview"?"in "+c:c} and cannot be used in production code. While you can experiment with it in your apps, please note that apps using ${c} methods cannot be submitted for review until a stable version is released.`);wb(this.Ee,new vb({Eg:c,methodName:d,propertyName:e})).catch(f=>this.j.G(`Encountered an error while registering unstable api usage: ${f}`))}}};var Yk=C(()=>({Li:A(1,ol)}));var Yz=()=>({Ka:W(1)});var gl=C(()=>({...Yz(),type:v(2,"ERROR")}));var fl=C(()=>({...Yz(),type:v(3,"SUCCESS"),sb:X(4)}));var Zk=D(()=>({type:[2,gl,3,fl]}),Yz);var dl=C(()=>({Ka:W(1)}));var el=C(()=>({Ka:W(1),Aj:W(2),xj:W(3),sb:X(4)}));var ll=C(()=>({Ka:W(1),ji:W(2),sb:X(3)}));var ml=C(()=>({Ka:W(1),sb:X(2)}));var il=class{async Qc(a,b){try{const c=this.kl[a],d=this.ll[a]||{},e=bl(b,d.cb),f=await c(e);return al(f,d.eb)}catch(c){throw this.j.G(c,{L:"Error handling incoming message",tags:new Map([["message",String(a)]])}),c;}}connect(a){J(!this.l,"internal_error","IntentMessenger is already connected");this.l=a}disconnect(){this.l=void 0}constructor(a,b,c,d){this.im=a;this.ll=b;this.kl=c;this.j=d}};var to=class{registerActivity(a,b){this.Fc[a]=b}constructor(a,b,c,d){var e=Zz;this.ih=a;this.j=b;this.xf=d;this.Fc={};this.hh=$k(c);kl(c,this,e,b)}};var $z=E(()=>[1,2,3,4]);var aA=C(()=>({search:X(1),include:Ra($z)}));var sl=C(()=>({type:v(1,"CONTAINER"),id:W(31),name:W(32)}));var tl=C(()=>({type:v(2,"IMAGE"),name:W(31),url:W(32),mimeType:W(33),thumbnailUrl:W(34),parentRef:X(35)}));var ul=C(()=>({type:v(3,"VIDEO"),name:W(31),url:W(32),mimeType:W(33),thumbnailImageUrl:W(34),parentRef:X(35)}));var vl=C(()=>({type:v(4,"AUDIO"),name:W(31),url:W(32),mimeType:W(33)}));var bA=D(()=>({type:[1,sl,2,tl,3,ul,4,vl]}),()=>({}));var cA=C(()=>({type:v(1,"COMPLETED"),results:A(31,bA),continuation:X(32)}));var dA=C(()=>({type:v(2,"AUTHENTICATION_REQUEST_FAILED_ERROR")}));var eA=C(()=>({type:v(3,"APP_ERROR"),message:X(31)}));var fA=C(()=>({type:v(4,"INTERNAL_ERROR")}));var gA=rl()("asset_picker",{getAssets:{cb:C(()=>({query:y(1,aA),limit:Hr(2),containerId:X(3),continuation:X(4)})),eb:D(()=>({type:[1,cA,2,dA,3,eA,4,fA]}),()=>({})),Mb:{},Eb:{}}});var hA=ql()("asset_picker",gA,{getAssets:async(a,{params:b},c)=>{try{var d=b.query;var e={search:d.search,include:d.include.map(xl)};const g=await a({query:e,limit:b.limit,containerId:b.containerId,continuation:b.continuation});a:switch(g.status){case "completed":var f=new cA({results:g.results.map(wl),continuation:g.continuation});break a;case "authentication_request_failed":f=new dA;break a;case "app_error":f=new eA({message:g.message});break a;default:throw new m(g);}c(p(f))}catch(g){c(p(new fA))}}});var iA={size:204800,number:{min:Number.MIN_SAFE_INTEGER,max:Number.MAX_SAFE_INTEGER},string:{max:1E4},media:{hi:40,qh:20}},Bn={description:255,providerInfo:{name:128,url:2048}};var kA=class{map(a,b,c,d){return new jA(this,a,b,c,d)}},jA=class extends kA{isIdentity(a){return this.component.isIdentity(this.Bc(a))}transform(a,b){a=this.component.transform(this.Bc(a),this.Bc(b));return zl(a,c=>this.Dd(c))}identity(a){return this.Dd(this.component.identity(this.yb(a)))}apply(a,b){const c=this.yb(a);b=this.component.apply(c,this.Bc(b));return c===b?a:this.Ed(b)}ga(a){return this.Ed(this.component.ga(this.yb(a)))}ja(a,b){return a===b||this.component.ja(this.yb(a),this.yb(b))}equals(a){return this===
a}constructor(a,b,c,d,e){super();this.component=a;this.Dd=b;this.Bc=c;this.Ed=d;this.yb=e}},yl=class{constructor(a,b,c,d){this.le=a;this.Ve=b;this.Db=c;this.Rb=d}},lA=class{build(a,b){return new yl(a,b,this.Db,this.Rb)}constructor(){this.Rb=this.Db=!1}};var mA=class extends kA{isIdentity(){return!0}transform(){return Al()}identity(){}apply(a){return a}ga(a){return this.Wj(a)}ja(a,b){return this.xa(a,b)}equals(a){return this===a}constructor(a,b){super();this.xa=a;this.Wj=b}};var nA={next:()=>{},error:()=>{}},oA=class{next(a){this.closed||this.o.next(this.f(a))}constructor(a,b){this.o=a;this.f=b;this.closed=!1}},pA=class extends oA{error(a){this.closed||(this.closed=!0,this.o.error(a))}constructor(a,b){super(a,b);this.o=a;this.f=b}},qA=class extends oA{complete(){this.closed||(this.closed=!0,this.o.complete())}constructor(a,b){super(a,b);this.o=a;this.f=b}},rA=class{next(a){this.rc.call(this.Ra,a)}error(a){this.onError.call(this.Ra,a)}constructor(a,b,c){this.Ra=a;this.rc=
b;this.onError=c}},sA=class{next(a){this.rc.call(this.Ra,a)}complete(){this.ng.call(this.Ra)}constructor(a,b,c){this.Ra=a;this.rc=b;this.ng=c}};var tA=class{connect(a){ia(this.S==null);this.S=a;return new sA(this,this.og,this.complete)}og(a){this.S&&this.Lb(a)}snapshot(){return this.ke()}complete(){this.S&&(this.S=void 0,El(this,"mutable disconnected"))}error(a){this.S&&(this.S.error(a),this.S=void 0,El(this,"mutable failure"))}Kb(a){this.jc||(this.jc=new rA(this,this.mg,this.error));return new pA(this.jc,a)}mg(a){this.S&&(this.sf&&this.sf.reportChanged(),Fl(this,a),this.S.next(a))}Lb(a){ia(this.S!=null,"mutable not connected");try{this.Ta(a),
this.domain.isIdentity(a)||this.sf&&this.sf.reportChanged()}catch(b){throw this.error(b),b;}Fl(this,a)}ka(a){var b;this.Lb(a);this.domain.isIdentity(a)||(b=this.S)===null||b===void 0||b.next(a)}constructor(a){this.context=a;this.clients=this.jc=this.S=void 0}};var Gl=class{get mutable(){this.Gb.Oh||(this.Me=this.Gb.nn,this.Gb=new uA(this.context,this.type,this.Gb.state,this));return this.Gb.mutable}snapshot(){return this.Gb.snapshot()}Lb(a){Jl(this);this.Gb.Lb(a)}destroy(a){var b;this.Gb.destroy(a);(b=this.context.metrics)===null||b===void 0||b.Dl.Xj()}next(a){Jl(this);this.Xa.next(a)}error(a){this.Xa.error(a)}constructor(a,b,c,d){var e;this.context=a;this.type=b;this.Xa=d;this.Me=void 0;this.Gb=new vA(b.domain,c);(e=a.metrics)===null||e===void 0||e.Dl.il()}},
wA=class{snapshot(){return this.type.snapshot(this.mutable)}Lb(a){this.gb.next(a)}destroy(a){var b,c=this.gb;this.type.destroy(this.mutable,a);c.complete();(b=this.metric())===null||b===void 0||b.Xj()}constructor(a,b,c,d){var e;this.context=a;this.type=b;this.Xa=d;b=this.type;d=this.Xa;a=b.V(a,c);c=b.connect(a,d);this.mutable=a;this.gb=c;(e=this.metric())===null||e===void 0||e.il()}},Hl=class extends wA{metric(){return this.context.metrics&&this.context.metrics.zo}},uA=class extends wA{metric(){return this.context.metrics&&
this.context.metrics.vp}constructor(...a){super(...a);this.Oh=!0}},vA=class{snapshot(){this.ba||!qr()?this.ba&&this.ba.reportObserved():(this.ba=tr(""),this.ba.reportObserved());return this.Ud}get state(){return this.Ud}get nn(){return this.ba}Lb(a){this.domain.isIdentity(a)||(this.Ud=this.domain.apply(this.Ud,a),this.ba&&this.ba.reportChanged())}destroy(a){var b=this.Ud;k(this.domain.ja(b,a),"{} != {}",b,a)}constructor(a,b){this.domain=a;this.Oh=!1;this.ba=void 0;this.Ud=b}};var xA=class{get(){this.reportObserved();return this.value}reportObserved(){this.ba||!qr()?this.ba&&this.ba.reportObserved():(this.ba=tr(""),this.ba.reportObserved(),wr(this.ba,()=>this.ba=void 0))}set(a){rr.identity(this.value,a)||(this.value=a,this.ba&&this.ba.reportChanged())}constructor(a){this.value=a;this.ba=tr("")}};var yA=class extends kA{isIdentity(a){return a==null||this.component.isIdentity(a)}transform(a,b){k(a==null===(b==null));return a!=null&&b!=null?this.component.transform(a,b):Al(b,a)}identity(a){return a!=null?this.component.identity(a):void 0}apply(a,b){k(a==null===(b==null));return a!=null&&b!=null?this.component.apply(a,b):void 0}ga(a){return a!=null?this.component.ga(a):void 0}ja(a,b){return a===b||a!=null&&b!=null&&this.component.ja(a,b)}equals(a){return this===a||a instanceof yA&&this.component.equals(a.component)}constructor(a){super();
this.component=a;k(!(a instanceof yA))}};var Nl=Object.freeze({C:a=>a,F:a=>a}),zA=Object.freeze({C(){throw Error("serialization not implemented");},F(){throw Error("serialization not implemented");}}),Ol=class{C(a){return this.b.C(this.a.C(a))}F(a){return this.a.F(this.b.F(a))}constructor(a,b){this.a=a;this.b=b}},AA=class{C(a){return a.map(b=>this.serializer.C(b))}F(a){return a.map(b=>this.serializer.F(b))}constructor(a){this.serializer=a}};
Object.freeze({C(a){let b=0,c=0;const d=Ll(a),e=[];a.forEach((f,g)=>{if(f=g-c)b&&(e.push(b),b=0),e.push(-f);b++;c=g+1});return[d,e]},F([a,b]){const c=[];let d=0;for(const e of b)e<0?d+=-e:e>0&&(a.slice(0,e).forEach(f=>c[d++]=f),a=a.slice(e));a.length&&a.forEach(e=>c[d++]=e);return c}});var Vl=class{C(a){return a!=null?this.serializer.C(a):this.defaultValue}F(a){return a!==this.defaultValue?this.serializer.F(a):void 0}constructor(a,b){this.serializer=a;this.defaultValue=b}};
Object.freeze({C:a=>a,F:a=>new Fd(a.delta)});Object.freeze({C:a=>a,F:a=>new Ju(a.oldState,a.newState)});Object.freeze({C:a=>({H:a}),F:a=>a.H});var BA=Symbol();var CA=class{create(a,b=yr,c=nA){a=this.V({[BA]:BA,metrics:{}.metrics},a);b.subscribe(this.connect(a,c));return a}ga(a){return this.domain.ga(a)}},EA=class extends CA{map(a,b,c,d,e,f){c=Rl(c);d=Rl(d);return new DA(this,a,b,c,d,e,f,Pl({C:b,F:a},this.Ah),Pl({C:d,F:c},this.bj))}constructor(a,b){super();this.Ah=a;this.bj=b}},DA=class extends EA{V(a,b){return this.Jl(this.component.V(a,this.yb(b)))}connect(a,b){b=new pA(b,this.Dd);a=this.component.connect(this.Wg(a),b);return new qA(a,this.Bc)}snapshot(a){return this.Ed(this.component.snapshot(this.Wg(a)))}destroy(a,
b){return this.component.destroy(this.Wg(a),this.yb(b))}constructor(a,b,c,d,e,f,g,h,l){super(h,l);this.component=a;this.Dd=b;this.Bc=c;this.Ed=d;this.yb=e;this.Jl=f;this.Wg=g;this.domain=this.component.domain.map(this.Dd,this.Bc,this.Ed,this.yb)}};var Ul=class{kd(a){k(this.Fa(a),"invalid value: {}",a);return a}pe(a,b){if(!this.xa(a,b))throw Error(`Invalid argument: ${this.stringify(a)} != ${this.stringify(b)}`);}constructor(a){this.serializer=a}},FA=class extends Ul{xa(a,b){return a===b}ga(a){return a}stringify(a){return JSON.stringify(a)}},Sl=class extends FA{constructor(a){super(Nl);this.Fa=a}},GA=new Sl(a=>typeof a==="boolean"),HA=new Sl(a=>typeof a==="string"),IA=Tl(-2147483648,2147483647),JA=new Sl(a=>Number.isSafeInteger(a)),KA=Tl(0,
2147483647);Tl(1,2147483647);var LA=Tl(0,Number.MAX_SAFE_INTEGER),MA=new Sl(a=>Number.isFinite(a)),NA=function(a,b){k(Number.isFinite(a)&&Number.isFinite(b)&&a<=b);return new Sl(c=>Number.isFinite(c)&&a<=c&&c<=b)}(0,Number.MAX_VALUE);Ql(AA,NA.serializer);Ql(AA,HA.serializer);var OA={next:a=>k(a==null),complete:()=>{}},Wl=class extends EA{V(a,b){return b!=null?this.type.V(a,b):void 0}connect(a,b){if(a==null)return OA;a=this.type.connect(a,b);return new qA(a,ma)}snapshot(a){return a!=null?this.type.snapshot(a):void 0}destroy(a,b){if(a!=null&&b!=null)this.type.destroy(a,b);else if(a!=null||b!=null)throw Error(`${this.snapshot(a)} != ${b}`);}constructor(a,b,c){super(b,c);this.type=a;this.domain=new yA(this.type.domain)}};Xl(HA);Xl(GA);Xl(IA);Xl(JA);Xl(MA);Xl(KA);Xl(LA);Xl(NA);Xl(HA);Xl(GA);Xl(MA);Xl(KA);Xl(LA);Xl(NA);var PA=class extends kA{increment(a){return a}isIdentity(a){return a===0}transform(a,b){return Al(b,a)}identity(){return 0}apply(a,b){return a+b}ga(a){return a}ja(a,b){return a===b}},QA=class extends PA{equals(a){return this===a||a instanceof QA}},RA=class extends PA{increment(a){k(a>=0);return super.increment(a)}transform(a,b){k(a>=0);k(b>=0);return super.transform(a,b)}apply(a,b){k(b>=0);return super.apply(a,b)}equals(a){return this===a||a instanceof RA}},SA=new QA,TA=new RA;var UA=class extends tA{Ta(a){this._value.set(this.domain.apply(this._value.get(),a))}get value(){return this._value.get()}increment(a){this.ka(this.domain.increment(a))}ke(){return this.value}constructor(a,b,c){super(a);this.domain=b;this._value=new xA(c)}},VA=class extends EA{V(a,b){return new UA(a,this.domain,b)}connect(a,b){return a.connect(b)}snapshot(a){return a.snapshot()}destroy(a,b){a=a.value;k(this.domain.ja(a,b),"{} != {}",a,b)}},WA=class extends VA{constructor(){super(Nl,Nl);this.domain=
SA}},XA=class extends VA{constructor(){super(Nl,Nl);this.domain=TA}};new WA;new XA;var Yl=new WeakMap,Zl=class extends Error{constructor(a){super(a);this.name="MakeObservableError";Object.setPrototypeOf(this,Zl.prototype)}};var YA=class extends kA{isIdentity(a){throw new m(a);}transform(a){throw new m(a);}identity(a){throw new m(a);}apply(a){throw new m(a);}ga(a){throw new m(a);}ja(a){throw new m(a);}equals(a){return this===a||a instanceof YA}},ZA=new YA;var $A=class{},aB=class extends $A{get length(){return this.state.length}$g(a){gm(this,a);return this.state.charAt(a)}tb(a){hm(this,a);return[new aB(this.state.substring(0,a)),new aB(this.state.substring(a))]}nb(){return this}toString(){return this.state}constructor(a){super();this.state=a;this.type=0;k(!!a)}},qm=class extends $A{get length(){return 1}$g(a){gm(this,a);return this.state}tb(a){hm(this,a);throw Error();}nb(a){return new qm(a(this.state))}toString(){return`[${this.state}]`}constructor(a){super();
this.state=a;this.type=1}},bB=class extends $A{get length(){return this.state}$g(a){gm(this,a)}tb(a){hm(this,a);return[new bB(a),new bB(this.state-a)]}nb(){return this}toString(){return this.state<=7?"\u00b7".repeat(this.state):`\u00b7\u00b7(${this.state})\u00b7\u00b7`}constructor(a){super();this.state=a;this.type=2;k(!!a)}},eB=class{get length(){return this.nh+this.ci+this.fj}R(a){return new cB(this,a)}cursor(a,b){return new dB(this,a,b)}nb(a){const b=this.regions.map(c=>c.nb(a));return new eB(b,
this.nh,this.ci,this.fj)}D(){return this.regions.map(a=>a.type===0?a.state:"").join("")}forEach(a,b){for(const c of this.regions)switch(c.type){case 0:b.D&&b.D(c.state);break;case 1:b.item(c.state);break;case 2:b.Z&&b.Z(c.state);break;default:throw new m(c);}(a=Math.max(0,a-this.length))&&b.Z&&b.Z(a)}map(a,b){const c=this.regions.map(d=>{switch(d.type){case 0:return b.D(d.state);case 1:return b.item(d.state);case 2:return b.Z(d.state);default:throw new m(d);}});(a=Math.max(0,a-this.length))&&c.push(b.Z(a));
return c}reduce(a,b){return this.regions.reduce((c,d)=>{switch(d.type){case 0:return a.D(c,d.state);case 1:return a.item(c,d.state);case 2:return a.Z?a.Z(c,d.state):c;default:throw new m(d);}},b)}slice(a,b){k(0<=a&&a<=b,"invalid range: [{}, {})",a,b);var c=this.length;if(0===a&&b>=c)return this;if(a===b||a>=c)return fB;const d=new gB;c=this.cursor(b);lm(c,a);lm(c,b-a,{item:e=>d.item(e),D:e=>im(d,e),Z:e=>jm(d,e)});return d.build()}toString(){return this.regions.join("")}constructor(a,b,c,d){this.regions=
a;this.nh=b;this.ci=c;this.fj=d;a=a.length?a[a.length-1]:void 0;k(!a||a.type!==2)}},fB=new eB([],0,0,0),gB=class{fb(a){this.mode!==a&&(this.flush(),this.mode=a)}flush(){if(this.mode!=null){switch(this.mode){case 0:this.regions.push(new aB(this.Od));this.ne+=this.Od.length;this.Od="";break;case 2:this.regions.push(new bB(this.Pd));this.ff+=this.Pd;this.Pd=0;break;default:throw new m(this.mode);}this.mode=void 0}}region(a){switch(a.type){case 0:return im(this,a.state);case 1:return this.item(a.state);
case 2:return jm(this,a.state);default:throw new m(a);}}item(a){this.flush();this.regions.push(new qm(a));this.eg++;return this}append(a,b=0){a.forEach(b,{D:c=>im(this,c),item:c=>this.item(c),Z:c=>jm(this,c)});return this}get length(){return this.ne+this.eg+this.ff}build(){this.mode!==2&&this.flush();return this.length?new eB(this.regions,this.ne,this.eg,this.ff):fB}constructor(){this.regions=[];this.mode=void 0;this.Od="";this.ff=this.eg=this.ne=this.Pd=0}},cB=class{get head(){return this.U}get prevValue(){return this.Nd&&
this.Nd.$g(this.Nd.length-1)}ac(a){const b=ma(this.U),c=b.length;k(0<a&&a<=c,"{} \u2209 (0, {}]",a,c);if(a<c)return a=b.tb(a),this.U=a[1],this.Nd=a[0];this.U=this.regions[this.i++];return this.Nd=b}finish(){ia(this.U==null,"unconsumed reader head: {}",this.U)}constructor(a,b=0){this.i=0;this.Nd=void 0;this.regions=(b=Math.max(0,b-a.length))?[...a.regions,new bB(b)]:a.regions;this.U=this.regions.length?this.regions[this.i++]:void 0}},dB=class{get prevValue(){return this.R.prevValue}move(a,b,c){for(c=
km(this.He,c);a;){var d=this.R.head;if(d)switch(d=this.R.ac(b||d.type!==2?Math.min(d.length,a):d.length),d.type){case 0:c&&c.D&&c.D(d.state);a-=d.length;break;case 1:c&&c.item&&c.item(d.state);a-=d.length;break;case 2:c&&c.Z&&c.Z(d.state);b&&(a-=d.length);break;default:throw new m(d);}else k(b,"not enough characters or items: {}",a),c&&c.Z&&c.Z(a),a-=a}}moveBefore(a,b){la(a.length,1);b=km(this.He,b);let c=!1;for(;!c;){var d=this.R.head;if(!d)break;const e=d.type===0?d.state.indexOf(a):-1;if(d=(c=
e!==-1)?e:d.length)switch(d=this.R.ac(d),d.type){case 0:b&&b.D&&b.D(d.state);break;case 1:b&&b.item&&b.item(d.state);break;case 2:b&&b.Z&&b.Z(d.state);break;default:throw new m(d);}}return c}finish(){this.R.finish()}constructor(a,b,c){this.He=c;this.R=a.R(b)}},hB=class{},iB=class extends hB{get ob(){return this.length}get Nb(){return this.length}bf(a){mm(this,a);return this.tb(a)}tb(a){return[new iB(a),new iB(this.length-a)]}map(){return this}toString(){return`R${this.length}`}constructor(a){super();
this.length=a;this.type=0}},jB=class extends hB{get ob(){return 1}get Nb(){return 1}bf(a){mm(this,a);throw Error();}map(a){return new jB(a(this.delta))}toString(){return`U[${this.delta}]`}constructor(a){super();this.delta=a;this.type=1}},kB=class extends hB{get ob(){return 0}get Nb(){return this.state.length}bf(a){mm(this,a);throw Error();}map(a,b){return new kB(this.state.nb(b))}toString(){switch(this.state.type){case 0:case 1:return`I${this.state}`;case 2:return`X${this.state.length}`;default:throw new m(this.state);
}}constructor(a){super();this.state=a;this.type=2}},lB=class extends hB{get ob(){return this.oldState.length}get Nb(){return this.newState.length}bf(a){mm(this,a);return this.tb(a)}tb(a){const [b,c]=this.oldState.tb(a),[d,e]=this.newState.tb(a);return[new lB(b,d),new lB(c,e)]}map(a,b){return new lB(this.oldState.nb(b),this.newState.nb(b))}toString(){return this.oldState.type===2?this.newState.type===2?`\u25e0${this.oldState.state}`:`\u2191${this.newState}`:this.newState.type===2?`\u2193${this.oldState}`:
`\u25e1[${this.oldState}|${this.newState}]`}constructor(a,b){super();this.oldState=a;this.newState=b;this.type=3;la(a.length,b.length)}},nB=class{R(a,b){return new mB(this,a,b)}forEach(a,b=this.pre,c=this.post){for(const d of this.H)switch(d.type){case 0:a.I&&a.I(d.length);break;case 1:a.update&&a.update(d.delta);break;case 2:a.insert&&a.insert(d.state);break;case 3:a.Cb&&a.Cb(d.oldState,d.newState);break;default:throw new m(d);}(b=Math.max(0,b-this.pre,c-this.post))&&a.I&&a.I(b)}map(a){return this.H.map(b=>
{switch(b.type){case 0:return a.I(b.length);case 1:return a.update(b.delta);case 2:return a.insert(b.state);case 3:return a.Cb(b.oldState,b.newState);default:throw new m(b);}})}nb(a){const b=this.H.map(c=>c.map(a,void 0));return new nB(b,this.pre,this.post)}toString(){return`[${this.H.toString()}]`}constructor(a,b,c){this.H=a;this.pre=b;this.post=c}},oB=new nB([],0,0),pB=class{fb(a,b,c){if(this.Aa!==a||this.kg!==b||this.ig!==c)switch(this.flush(),this.Aa=a,this.kg=b,this.ig=c,a){case 0:break;case 2:c===
0&&(this.va="");break;case 3:b===0&&(this.Pb="");c===0&&(this.va="");break;default:throw new m(a);}}flush(){if(this.Aa!=null){switch(this.Aa){case 0:this.push(new iB(this.acc));this.acc=0;break;case 2:var a=this.va!=null?new aB(this.va):new bB(this.acc);this.push(new kB(a));this.va=void 0;this.acc=0;break;case 3:a=this.Pb!=null?new aB(this.Pb):new bB(this.acc);const b=this.va!=null?new aB(this.va):new bB(this.acc);this.push(new lB(a,b));this.va=this.Pb=void 0;this.acc=0;break;default:throw new m(this.Aa);
}this.ig=this.kg=this.Aa=void 0}}push(a){this.H.push(a);this.pre+=a.ob;this.post+=a.Nb}op(a){switch(a.type){case 0:return this.I(a.length);case 1:return this.update(a.delta);case 2:a:switch(a=a.state,a.type){case 0:a=this.insert(a.state);break a;case 1:a=this.insert(a.state);break a;case 2:a=this.expand(a.state);break a;default:throw new m(a);}return a;case 3:return nm(this,a.oldState,a.newState);default:throw new m(a);}}I(a){k(a>=0);a&&(this.fb(0),this.acc+=a);return this}update(a){if(this.isIdentity(a))return this.I(1);
this.flush();this.H.push(new jB(a));this.pre++;this.post++;return this}expand(a){k(a>=0);a&&(this.fb(2,void 0,2),this.acc+=a);return this}insert(a){typeof a==="string"?a&&(this.fb(2,void 0,0),this.va+=a):(this.flush(),this.push(new kB(new qm(a))));return this}pj(a){typeof a==="string"?a&&(this.fb(3,2,0),this.acc+=a.length,this.va+=a):(this.flush(),this.push(new lB(new bB(1),new qm(a))));return this}Ae(a){typeof a==="string"?a&&(this.fb(3,0,2),this.acc+=a.length,this.Pb+=a):(this.flush(),this.push(new lB(new qm(a),
new bB(1))));return this}Cb(a,b){typeof a==="string"?typeof b==="string"?(la(a.length,b.length),a&&(this.fb(3,0,0),this.Pb+=a,this.va+=b)):(la(a.length,1),this.flush(),this.push(new lB(new aB(a),new qm(b)))):typeof b==="string"?(la(1,b.length),this.flush(),this.push(new lB(new qm(a),new aB(b)))):(this.flush(),this.push(new lB(new qm(a),new qm(b))));return this}build(){this.Aa!==0&&this.flush();return new nB(this.H,this.pre,this.post)}constructor(a){this.isIdentity=a;this.H=[];this.post=this.pre=0;
this.ig=this.kg=this.Aa=void 0;this.acc=0;this.va=this.Pb=void 0}},mB=class{get head(){return this.U}finish(){ia(this.U==null)}constructor(a,b=0,c=0){this.H=(b=Math.max(0,b-a.pre,c-a.post))?[...a.H,new iB(b)]:a.H;this.i=0;this.U=this.H[this.i++]}},qB=class extends kA{dc(){return new pB(a=>this.component.isIdentity(a))}cf(){return new gB}id(){return oB}isIdentity(a){return!a.H.length||a.H.every(b=>b.type===0)}transform(a,b){if(!a.H.length||!b.H.length)return Al(b,a);const c=this.dc(),d=this.dc(),e=
a.R(b.pre,0),f=b.R(a.pre,0),g=new lA;for(;;){var h=e.head,l=f.head;if(!h&&!l)break;h&&h.type===2?(h=om(e),l=void 0):l&&l.type===2?(h=void 0,l=om(f)):h&&l&&(l=Math.min(h.ob,l.ob),h=pm(e,l),l=pm(f,l));if(h&&h.type===2)d.I(h.Nb),c.op(h);else if(l&&l.type===2)d.op(l),c.I(l.Nb);else if(h&&l)h.type===0||l.type===0?(d.op(l),c.op(h)):h.type===3?(d.I(h.Nb),nm(c,sm(this,h.oldState,l),h.newState),Cl(g,l.type===3?!rm(this,h.newState,l.newState):!this.component.isIdentity(l.delta))):l.type===3?(nm(d,sm(this,l.oldState,
h),l.newState),c.I(l.Nb),Dl(g,!this.component.isIdentity(h.delta))):(h=Bl(g,this.component.transform(h.delta,l.delta)),d.update(h.le),c.update(h.Ve));else throw Error(`length mismatch (${a} x ${b})`);}e.finish();f.finish();return g.build(d.build(),c.build())}identity(){return oB}apply(a,b){const c=this.cf(),d=a.R(b.pre);for(a=b.R(a.length,0);;){b=d.head;var e=a.head;if(!e)break;e.type===2?(b=void 0,e=om(a)):b&&(e=Math.min(b.length,e.ob),b=d.ac(e),e=pm(a,e));if(e.type===2)c.region(e.state);else if(b)c.region(sm(this,
b,e));else break}d.finish();a.finish();return c.build()}ga(a){return this.component===ZA&&a instanceof eB?a:a.nb(b=>this.component.ga(b))}ja(a,b){if(a===b)return!0;if(a.length!==b.length)return!1;a=a.R();b=b.R();let c=a.head,d=b.head;for(;c||d;){if(!c||!d||!rm(this,c,d))return!1;a.ac(c.length);b.ac(d.length);c=a.head;d=b.head}return!0}equals(a){return this===a||a instanceof qB&&this.component.equals(a.component)}constructor(){super();this.component=ZA}},tm=new qB,um={item:a=>{throw new m(a);}};var rB=class{forEach(a,b=this.pre,c=this.post){this.H.forEach(d=>{switch(d.type){case 0:a.I&&a.I(d.D);break;case 2:a.insert&&a.insert(d.D);break;case 1:a.delete&&a.delete(d.D);break;default:throw new m(d);}});(b=Math.max(0,b-this.pre,c-this.post))&&a.I&&a.I(b)}constructor(a,b,c){this.pre=a;this.post=b;this.H=c}},wm=class{I(a){k(a>=0);a>0&&(this.ub(0),this.Wc+=a);return this}insert(a){a.length>0&&(this.ub(2),this.ud+=a);return this}delete(a){a>0&&(this.ub(1),this.Oc+=a);return this}ub(a){if(this.mode!==
a){switch(this.mode){case 0:var b=this.H,c=b.push,d=this.Wc;k(d>0);c.call(b,{type:0,D:d});this.pre+=this.Wc;this.post+=this.Wc;this.Wc=0;break;case 2:b=this.H;c=b.push;d=this.ud;k(d.length>0);c.call(b,{type:2,D:d});this.post+=this.ud.length;this.ud="";break;case 1:b=this.H;c=b.push;d=this.Oc;k(d>0);c.call(b,{type:1,D:d});this.pre+=this.Oc;this.post+=this.Oc;this.Oc=0;break;case void 0:break;default:throw new m(this.mode);}this.mode=a}}build(){this.mode!==0&&this.ub();return new rB(this.pre,this.post,
this.H)}constructor(){this.H=[];this.post=this.pre=0;this.mode=void 0;this.Wc=0;this.ud="";this.Oc=0}};var sB=class extends tA{get D(){return this.state.get().D()}insert(a,b){var c=this.ka,d=this.state.get();a=(new wm).I(a).insert(b).build();c.call(this,vm(d,a))}delete(a,b){var c=this.ka,d=this.state.get();a=(new wm).I(a).delete(b).build();c.call(this,vm(d,a))}Ta(a){const b=xm(this.state.get(),a);this.state.set(tm.apply(this.state.get(),a));this.subject.next(b)}ke(){return this.state.get()}destroy(a){k(tm.ja(this.state.get(),a))}constructor(a,b,c){super(a);this.domain=b;bm(this,{D:sr});this.state=
void 0;this.subject=new xr;this.state=new xA(c)}},tB=class extends CA{Ma(a){return a}V(a,b){return new sB(a,this.domain,b)}connect(a,b){return this.Ma(a).connect(b)}snapshot(a){return this.Ma(a).snapshot()}destroy(a,b){this.Ma(a).destroy(b)}constructor(){super();this.domain=tm}};new tB;var zm=class extends kA{update(a,b){const c={};ma(this.ya[a]).isIdentity(b)||(c[a]=b);return c}identity(){return this.id}isIdentity(a){return a===this.id||Object.entries(a).every(([b,c])=>c==null||this.ya[b].isIdentity(c))}transform(a,b){const c={},d={};var e=Object.keys(a),f=Object.keys(b);if(!e.length||!f.length)return Al(b,a);const g=new lA;for(const h of new Set([...e,...f])){f=a[h];const l=b[h];f!=null&&l!=null?(e=this.ya[h],f=Bl(g,e.transform(f,l)),e.isIdentity(f.Ve)||(c[h]=f.Ve),e.isIdentity(f.le)||
(d[h]=f.le)):f!=null?c[h]=f:l!=null&&(d[h]=l)}return g.build(d,c)}apply(a,b){var c=Object.keys(b);if(!c.length)return a;const d={...a};for(const e of c)c=b[e],c!=null&&(d[e]=this.ya[e].apply(a[e],c));return d}ga(a){return Object.freeze(ym(this.ya,(b,c)=>b.ga(a[c])))}ja(a,b){return a===b||Object.keys(this.ya).every(c=>this.ya[c].ja(a[c],b[c]))}equals(a){return this===a?!0:a instanceof zm?Object.keys(this.ya).length===Object.keys(a.ya).length&&Object.keys(this.ya).every(b=>b in a.ya&&this.ya[b].equals(a.ya[b])):
!1}constructor(a){super();this.ya=a;this.id={}}};var vB=class extends tA{ke(){const a=this.Xd,b=this.uc,c=this.Xb,d={};for(const e in a)d[e]=this.values[e];for(const e in b)d[e]=this.J[e].snapshot();for(const e in c)d[e]=this.attributes[e].snapshot();return d}destroy(a){const b=this.Xd,c=this.uc,d=this.Xb,e=this.Va;for(const f in b)b[f].pe(this.values[f],a[f]);for(const f in c)this.J[f].destroy(a[f]);for(const f in d)this.attributes[f].destroy(a[f]);if(e&&e.Tc)try{e.Tc()}catch(f){Promise.reject(f)}}Ta(a){for(const b in a)a[b]!=null&&(b in this.uc?
this.J[b].Lb(a[b]):b in this.Xb&&this.attributes[b].Lb(a[b]))}getAttribute(a){return this.attributes[a].snapshot()}setAttribute(a,b){this.attributes[a].mutable.value=b}Jf(a){const b={...this.values};Object.defineProperties(b,a);Object.defineProperty(b,uB,{enumerable:!1,writable:!1,value:this});return b}constructor(a,b,c,d,e,f,g,h,l){super(a);this.domain=b;this.Xd=c;this.uc=d;this.Xb=e;this.computed=f;this.Cg=g;this.zf=h;this.Va=void 0;this.values=Ml(c,(n,r)=>n.kd(l[r]));this.J=Ml(d,(n,r)=>Il(this.context,
n,l[r],this.Kb(this.Cg[r])));this.attributes=Ml(e,(n,r)=>Il(this.context,n,l[r],this.Kb(this.zf[r])))}},uB=Symbol("$impl"),wB=class extends EA{},xB=class extends wB{V(a,b){return(new vB(a,this.domain,this.values,this.J,this.attributes,this.computed,this.Cg,this.zf,b)).Jf(this.yg)}Ac(a){return a[uB]}connect(a,b){return this.Ac(a).connect(b)}snapshot(a){return this.Ac(a).snapshot()}destroy(a,b){this.Ac(a).destroy(b)}Wa({values:a={},J:b={},attributes:c={},computed:d}){return new xB({...this.values,...a},
{...this.J,...b},{...this.attributes,...c},Dm(this.computed,d))}constructor(a,b,c,d){super(zA,zA);this.values=a;this.J=b;this.attributes=c;this.computed=d;this.domain=Am(Ml(this.values,e=>new mA((f,g)=>e.xa(f,g),f=>e.ga(f))),Ml(this.J,e=>e.domain),Ml(this.attributes,e=>e.domain));this.Cg=Ml(this.J,(e,f)=>g=>({[f]:g}));this.zf=Ml(this.attributes,(e,f)=>g=>({[f]:g}));Bm(a,{...b,...(d===null||d===void 0?void 0:d.J)},{...c,...(d===null||d===void 0?void 0:d.attributes)});a=Ml(b,(e,f)=>({enumerable:!0,
configurable:!0,get(){return this[uB].J[f].mutable}}));c=Ml(c,(e,f)=>({enumerable:!0,configurable:!0,get(){return this[uB].getAttribute(f)},set(g){this[uB].setAttribute(f,g)}}));b=Ml((d===null||d===void 0?void 0:d.J)||{},(e,f)=>({enumerable:!0,configurable:!0,get(){var g=this[uB];g.Va==null&&(g.Va=Cm(g));return g.Va.J[f]}}));d=Ml((d===null||d===void 0?void 0:d.attributes)||{},(e,f)=>({enumerable:!0,configurable:!0,get(){var g=this[uB];g.Va==null&&(g.Va=Cm(g));return g.Va.attributes[f].value},set(g){var h=
this[uB];h.Va==null&&(h.Va=Cm(h));h.Va.attributes[f].value=g}}));this.yg={...a,...b,...c,...d}}};new xB({},{},{});var Hm=Fm({},{}),CB=class{R(a){return new yB(this,a)}cursor(a,b){return new zB(this,a,b)}forEach(a,{grad:b,Lc:c}){for(const d of this.items)switch(d.type){case 0:b&&b(d.ha,d.ua);break;case 1:c&&c(d.length);break;default:throw new m(d);}(a=Math.max(0,a-this.length))&&c&&c(a)}map(a,{grad:b,Lc:c}){const d=this.items.map(e=>{switch(e.type){case 0:return b(e.ha,e.ua);case 1:return c(e.length);default:throw new m(e);}});(a=Math.max(0,a-this.length))&&d.push(c(a));return d}reduce({grad:a,Lc:b},c){return this.items.reduce((d,
e)=>{switch(e.type){case 0:return a?a(d,e.ha,e.ua):d;case 1:return b?b(d,e.length):d;default:throw new m(e);}},c)}slice(a,b){k(0<=a&&a<=b,"invalid range: [{}, {})",a,b);var c=this.length;if(0===a&&b>=c)return this;if(a===b||a>=c)return AB;const d=new BB;c=this.cursor(b);c.move(a);d.attrs(c.Qe,c.Re);c.move(b-a,{cells:(e,f,g,h)=>d.attrs(f,h).Lc(e)});return d.build()}toString(){return`${this.items.map(a=>{switch(a.type){case 0:const b=[];for(const [c,d]of Object.entries(a.ua))b.push(`${c}:${d!=null?
`<${d}|`:""}`);return`G{${b.join(",")}}`;case 1:return`R${a.length}`;default:throw new m(a);}}).join("")}`}constructor(a,b,c={}){this.items=a;this.length=b;this.attributes=c;a=a.length?a[a.length-1]:void 0;k(!a||a.type!==1)}},AB=new CB([],0),yB=class{get head(){return this.U}get Qe(){return this.qf}get Re(){return this.tf}ac(a){var b=this.U;if(!b||b.type!==1)throw Error(`expected cell, found: ${b&&b.type}`);b=b.length;a=Math.min(a,b);this.U=a<b?Gm(b-a):this.input[this.i++];return a}apply(a){Em(a.ha,
a.ua,(b,c,d)=>{c!=null&&d!=null?(this.qf[b]=c,this.tf[b]=d):(delete this.qf[b],delete this.tf[b])})}finish(){ia(!this.U)}constructor(a,b=0){this.i=0;this.qf={};this.tf={};b=Math.max(0,b-a.length);this.length=a.length+b;this.input=b?[...a.items,Gm(b)]:a.items;this.U=this.input.length?this.input[this.i++]:void 0}},zB=class{get Qe(){return this.R.Qe}get Re(){return this.R.Re}move(a,b){var c=this.He;b=c?b?{cells:fm(c.cells,b.cells)}:c:b;k(a>=0,"{} < 0",a);a=this.ed+a;for(k(a<=this.R.length,"{} > {}",
a,this.R.length);this.ed<a;){c=Im(this.R);const d=this.R.ac(a-this.ed);this.ed+=d;b&&b.cells&&b.cells(d,c.ha,this.Qe,c.ua,this.Re)}}finish(){Im(this.R);this.R.finish()}constructor(a,b,c){this.He=c;this.ed=0;this.R=new yB(a,b)}},BB=class{fa(a,b,c){this.Sg[a]!==c?(this.ha[a]=b,this.ua[a]=c):(delete this.ha[a],delete this.ua[a]);return this}attrs(a,b){Em(a,b,(c,d,e)=>this.fa(c,d,e));return this}Lc(a){a>0&&(Object.keys(this.ha).length&&(this.length&&(this.items.push(Gm(this.length)),this.length=0),this.items.push(Fm(this.ha,
this.ua)),Em(this.ha,this.ua,(b,c,d)=>{if(c!=null){this.as[b]=c;this.Sg[b]=d;var e;((e=this.attributes[b])!==null&&e!==void 0?e:this.attributes[b]=new Set).add(c)}else delete this.as[b],delete this.Sg[b]}),this.ha={},this.ua={}),this.length+=a,this.Vd+=a);return this}append(a,b=0){a.forEach(b,{grad:(c,d)=>this.attrs(c,d),Lc:c=>this.Lc(c)});return this}build(){for(const a of Object.keys(this.as))this.fa(a,void 0,void 0);for(const a of Object.keys(this.ha))this.fa(a,void 0,void 0);Object.keys(this.ha).length?
(ia(!!this.length,"attributes still open: {}",this.ha),this.items.push(Gm(this.length)),this.items.push(Fm(this.ha,this.ua)),this.length=0,this.ha={},this.ua={}):this.Vd-=this.length;return new CB(this.items,this.Vd,this.attributes)}constructor(){this.items=[];this.attributes={};this.as={};this.Sg={};this.length=this.Vd=0;this.ha={};this.ua={}}};var Jm=class{toString(){return`[${this.from},${this.to}]`}constructor(a,b){this.from=a;this.to=b}},DB=class{get isEmpty(){return!this.ranges.size}slice(a,b){k(0<=a&&a<=b,"invalid range: [{}, {})",a,b);const c=new Map;for(const [e,f]of this.ranges){var d=b<f.from||f.to<a?void 0:new Jm(Math.max(f.from,a)-a,Math.min(f.to,b)-a);d&&c.set(e,d)}return new DB(c)}toString(){return[...this.ranges].map(([a,b])=>`"${a}":${b}`).join(",")}constructor(a=new Map){this.ranges=a}},EB=new DB,FB=class{range(a,b){b?this.fd.set(a,
Km(b)):this.fd.delete(a);return this}ranges(a){a.forEach((b,c)=>this.fd.set(c,Km(b)));return this}build(){return this.fd.size?new DB(this.fd):EB}constructor(){this.fd=new Map}},Sm=class{toString(){return`${this.Kd||"_"}->${this.Hd||"_"}`}constructor(a,b){this.Kd=a;this.Hd=b}},Om=class{toString(){return`${GB[this.type]}${this.length}`}constructor(a,b){this.type=a;this.length=b}},GB={[0]:"R",[1]:"I"},IB=class{R(a,b){return new HB(this,a,b)}toString(){const a=this.jd.join(""),b=[...this.ranges].map(([c,
d])=>`"${c}":${d}`).join(",");return`{${a}|${b}}`}constructor(a,b,c,d){this.jd=a;this.ranges=b;this.pre=c;this.post=d}},JB=new IB([],new Map,0,0),KB=class{append(a,b){k(b>=0,"{} < 0",b);if(!b)return this;this.Aa===a?this.length+=b:(this.Aa!=null&&this.H.push(new Om(this.Aa,this.length)),this.Aa=a,this.length=b);switch(a){case 0:this.pre+=b;this.post+=b;break;case 1:this.post+=b;break;default:throw new m(a);}return this}I(a){return this.append(0,a)}insert(a){return this.append(1,a)}createRange(a,b){b=
new Sm(void 0,b&&Km(b));this.ranges.set(a,b);return this}build(){const a=this.Aa,b=this.length;a===0?(this.pre-=b,this.post-=b):a!=null&&this.H.push(new Om(a,b));return this.H.length||this.ranges.size?new IB(this.H,this.ranges,this.pre,this.post):JB}constructor(){this.H=[];this.Aa=void 0;this.post=this.pre=this.length=0;this.ranges=new Map}},HB=class{get next(){return this._next}get Ci(){return this.be}get xg(){return this.Ab}get vd(){return this.Ab-this.be}finish(){ia(!this._next)}constructor(a,
b=0,c=0){this.Ab=this.be=this.i=0;this.input=(b=Math.max(0,b-a.pre,c-a.post))?[...a.jd,new Om(0,b)]:a.jd;this._next=this.i<this.input.length?this.input[this.i++]:void 0}},LB=class extends kA{cf(){return new FB}dc(){return new KB}isIdentity(a){return!a.jd.length&&!a.ranges.size}transform(a,b){if(this.isIdentity(a)||this.isIdentity(b))return Al(b,a);var c=new Map,d=new Map;const e=new Map,f=new lA;for(var g of Um(a.ranges,b.ranges)){var h=a.ranges.get(g),l=b.ranges.get(g);h&&l?(k(Lm(h.Kd,l.Kd)),e.set(g,
new Sm(l.Hd,h.Hd)),Cl(f)):h?c.set(g,h):l&&d.set(g,l)}h=a.R(b.pre,0);l=b.R(a.pre,0);g=this.dc();const n=this.dc();var r=h.next;let t=l.next;for(;r||t;){if(r&&r.type===1)r=r.length,Tm(d,l.Ci+h.vd,l.xg+h.vd,r),Pm(h,1,r),h.Ab+=r,n.I(r),g.insert(r);else if(t&&t.type===1)r=t.length,Tm(c,h.Ci+l.vd,h.xg+l.vd,r),Tm(e,void 0,h.xg+l.vd,r),Pm(l,1,r),l.Ab+=r,n.insert(r),g.I(r);else if(r&&t)r=Math.min(r.length,t.length),Qm(h,r),Qm(l,r),n.I(r),g.I(r);else throw Error(`unreachable case: ${r} x ${t}`);r=h.next;t=
l.next}h.finish();l.finish();d=Nm(n,d).build();c=Nm(Nm(g,c),e).build();la(d.post-d.pre,b.post-b.pre);la(c.post-c.pre,a.post-a.pre);return f.build(d,c)}id(){return JB}identity(){return JB}apply(a,b){if(this.isIdentity(b)||!a.ranges.size&&!b.ranges.size)return a;const c=this.cf(),d=new Map(a.ranges);for(const [e,f]of b.ranges)k(Lm(a.ranges.get(e),f.Kd)),d.delete(e),c.range(e,f.Hd);Mm(b,{insert:(e,f,g)=>{for(const [h,l]of d)f=Rm(l,g,e),f!==l&&d.set(h,f)}});return c.ranges(d).build()}ga(a){if(a instanceof
DB)return a;const b=this.cf();for(const [c,d]of a.ranges)b.range(c,[d.from,d.to]);return b.build()}ja(a,b){const c=a.ranges,d=b.ranges;return a===b||c===d?!0:c.size===d.size&&[...c.keys()].every(e=>Lm(c.get(e),d.get(e)))}equals(a){return this===a||a instanceof LB}constructor(){super()}};new LB;var MB=class extends kA{isIdentity(){return!0}transform(){return Al(1,1)}identity(){return 1}apply(){return 1}ga(){return 1}ja(){return!0}equals(a){return this===a||a instanceof MB}constructor(){super();this.unit=1}},NB=new MB;var OB=class extends EA{V(a,b){return b}connect(){return{next:()=>{},complete:()=>{}}}snapshot(a){return a}destroy(){}constructor(){super(Nl,Nl);this.domain=NB}};new OB;var PB=new Map,QB=class extends kA{isIdentity(a){return!a.size||Array.from(a.values()).every(b=>b===0)}transform(a,b){return Al(b,a)}identity(){return PB}apply(a,b){if(a.size){if(b.size){var c=new Map;for(const [e,f]of a){var d=b.get(e)||0;(d=f+d)&&c.set(e,d)}for(const [e,f]of b)a.has(e)||c.set(e,f);a=c}}else a=b;return a}ga(a){return new Map(a)}ja(a,b){return Vm(a,b)}equals(a){return this===a||a instanceof QB}};var RB;RB=Symbol.iterator;
var SB=class extends tA{Ta(a){for(const [b,c]of a)(a=(this.map.get(b)||0)+c)?this.map.set(b,a):this.map.delete(b)}ke(){return new Map(this.map)}add(a){const b=this.map.get(a)||0;b>0||this.ka(new Map([[a,-b+1]]))}delete(a){const b=this.map.get(a)||0;b&&this.ka(new Map([[a,-b]]))}has(a){return(this.map.get(a)||0)>0}get values(){return[...Wm(this.map,a=>a>0).keys()]}[RB](){return this.values[Symbol.iterator]()}constructor(a,b,c){super(a);this.domain=b;bm(this,{values:sr.struct});this.map=void 0;this.map=
new vr(c)}},TB=class extends EA{V(a,b){return new SB(a,this.domain,b)}connect(a,b){return a.connect(b)}snapshot(a){return a.snapshot()}destroy(a,b){k(this.domain.ja(a.snapshot(),b))}constructor(){super(zA,zA);this.domain=new QB}};new TB;var UB=C(()=>({source:W(1),title:X(2)}));var VB=C(()=>({row:T(1),column:T(2)}));var ln=C(()=>({formatting:X(1)}));var mn=C(()=>({type:v(1,"NUMBER"),value:Ir(31),metadata:z(32,ln)}));var nn=C(()=>({type:v(2,"STRING"),value:X(31)}));var on=C(()=>({type:v(3,"BOOLEAN"),value:Z(31)}));var kn=C(()=>({type:v(4,"DATE"),value:Jr(31)}));var WB=C(()=>({type:v(1,"IMAGE"),ref:W(31)}));var qn=C(()=>({type:v(2,"IMAGE_UPLOAD"),thumbnailUrl:W(31),url:W(32),width:Ir(33),height:Ir(34),mimeType:W(35)}));var XB=C(()=>({type:v(3,"VIDEO"),ref:W(36)}));var rn=C(()=>({type:v(4,"VIDEO_UPLOAD"),url:W(32),width:Ir(33),height:Ir(34),mimeType:W(35),thumbnailImageUrl:W(37),thumbnailVideoUrl:X(38)}));var YB=D(()=>({type:[1,WB,2,qn,3,XB,4,rn]}),()=>({}));var pn=C(()=>({type:v(5,"MEDIA"),value:A(31,YB)}));var ZB=D(()=>({type:[1,mn,2,nn,3,on,4,kn,5,pn]}),()=>({}));var $B=C(()=>({cells:A(1,ZB)}));var jn=C(()=>({name:X(1),type:W(2,"variant")}));var aC=C(()=>({rows:A(2,$B),Tj:A(3,jn)}));var bC=C(()=>({name:W(1),url:X(2)}));var an=C(()=>({description:X(1),providerInfo:z(2,bC)}));var Zm=C(()=>({type:v(1,"COMPLETED"),dataTable:y(31,aC),metadata:z(32,an)}));var en=C(()=>({type:v(2,"APP_ERROR"),message:X(31)}));var cC=C(()=>({type:v(3,"INTERNAL_ERROR")}));var cn=C(()=>({type:v(4,"OUTDATED_REF")}));var dn=C(()=>({type:v(5,"REQUEST_FAILED")}));var dC=C(()=>({type:v(6,"LIMIT_EXCEEDED")}));var bn=C(()=>({type:v(7,"INVALID_FORMAT")}));var eC=C(()=>({type:v(8,"FETCH_ERROR")}));var fC=C(()=>({type:v(9,"INVALID_METADATA")}));var gC=C(()=>({type:v(1,"DATA_SELECTION"),dataSourceRef:z(31,UB)}));var hC=C(()=>({type:v(3,"OUTDATED_SOURCE_REF"),dataSourceRef:z(31,UB)}));var iC=C(()=>({type:v(4,"APP_ERROR"),message:X(31),dataSourceRef:z(32,UB)}));var jC=D(()=>({type:[1,gC,3,hC,4,iC]}),()=>({}));var kC=C(()=>({type:v(1,"COMPLETED")}));var lC=C(()=>({type:v(2,"APP_ERROR"),message:X(31)}));var mC=C(()=>({type:v(3,"INTERNAL_ERROR")}));var nC=C(()=>({type:v(4,"OUTDATED_REF")}));var oC=C(()=>({type:v(5,"REQUEST_FAILED")}));var pC=C(()=>({type:v(6,"LIMIT_EXCEEDED")}));var qC=C(()=>({type:v(7,"INVALID_FORMAT")}));var rC=C(()=>({type:v(8,"FETCH_ERROR")}));var sC=C(()=>({type:v(9,"ABORTED")}));var tC=C(()=>({type:v(10,"INVALID_METADATA")}));var uC=rl()("connect_data",{fetchDataTable:{cb:C(()=>({dataSourceRef:y(1,UB),limit:y(2,VB)})),eb:D(()=>({type:[1,Zm,2,en,3,cC,4,cn,5,dn,6,dC,7,bn,8,eC,9,fC]}),()=>({})),Mb:{},Eb:{}},renderDataTableSelectionUI:{cb:C(()=>({invocationContext:y(1,jC),limit:y(2,VB)})),Mb:{},Eb:{connect_data_v1_update_data_ref:{cb:C(()=>({dataSourceRef:y(1,UB)})),eb:D(()=>({type:[1,kC,2,lC,3,mC,4,nC,5,oC,6,pC,7,qC,8,rC,9,sC,10,tC]}),()=>({}))}}}});var sn=/^(?:xn--)?[a-zA-Z0-9]+$/i,tn=/^(?!:\/\/)([a-zA-Z0-9]([a-zA-Z0-9-_]*[a-zA-Z0-9])?)$/i,En=/^(tel|sms|mailto|shortcuts):/i,Cn=/^(https?|ftp|tel|sms|mailto|shortcuts):(\/\/|[^/])[^ ]+(\/|$)|^[^: ]+(\/|$)|^[\w.]+:\d+(\/|$)/i,Dn=[/<script\b[^>]*>/i,/<img[^>]+\bsrc\s*=\s*[^>]+\bonerror\b/i,/<iframe[^>]+\bsrc\b/i,/<object[^>]+\bdata\b/i,/<embed[^>]+\bsrc\b/i,/<svg[^>]*>[^<]*<script/i,/javascript\s*:/i,/data\s*:/i,/vbscript\s*:/i,/on\w+\s*=\s*["']/i,/\beval\s*\(/i,/\bdocument\.cookie/i,/\bdocument\.location/i,
/\balert\s*\(/i,/\bprompt\s*\(/i,/\bconfirm\s*\(/i,/\bdocument\.write/i,/\bdocument\.domain/i,/\bwindow\.\w+/i,/\bparent\.\w+/i,/\btop\.\w+/i];var vC=ql()("connect_data",uC,{fetchDataTable:async(a,{params:b,j:c,signal:d},e)=>{let f;try{f=await a({signal:d,limit:b.limit,dataSourceRef:b.dataSourceRef})}catch(g){c.G(g,{L:"Error fetching data table"});e(p(new cC));return}try{if(f.status==="completed"){const g=zn(f.dataTable,{...iA,...b.limit});if(!g.ok)switch(console.error(`Data table failed validation with reason "${g.error.reason}"`),g.error.code){case "exceeded_limit":return e(p(new dC));case "invalid_format":return e(p(new bn));default:throw new m(g.error.code);
}if(f.metadata){const h=Fn(f.metadata);if(!h.ok)return console.error(`Metadata failed validation with reason "${h.error.reason}"`),e(p(fC.ue()))}}e(p(fn(f)))}catch(g){c.G(g,{L:"Error processing fetch data table result"}),e(p(new cC))}},renderDataTableSelectionUI:async(a,{params:b,Hf:c})=>{const d=c({});c=gn(b.invocationContext);a({limit:b.limit,invocationContext:c,updateDataRef:async e=>{try{var f=wn(e)<=5120}catch(g){f=!1}if(!f)throw new G({code:"bad_request",message:"data_source_ref_limit_exceeded"});
if(e.title&&!Ym(e.title,{max:255}))throw new G({code:"bad_request",message:"data_source_title_length_limit_exceeded"});e=await cl(d,"connect_data_v1_update_data_ref",{dataSourceRef:{source:e.source,title:e.title}});return hn(e)}})}});var wC=rl()("edit_design",{render:{Mb:{},Eb:{}}});var xC=ql()("edit_design",wC,{render:async a=>a()});var yC=C(()=>({publishRef:X(1)}));var zC=C(()=>({type:v(1,"COMPLETED")}));var AC=C(()=>({rb:v(1,"IMAGE_LOADING"),id:W(1),widthPx:T(2),heightPx:T(3)}));var BC=C(()=>({type:v(1,"PNG")}));var CC=C(()=>({type:v(2,"JPG")}));var DC=D(()=>({type:[1,BC,2,CC]}),()=>({}));var EC=C(()=>({rb:v(2,"IMAGE_READY"),id:W(1),widthPx:T(2),heightPx:T(3),format:y(4,DC),url:W(5)}));var FC=C(()=>({rb:v(3,"IMAGE_ERROR"),id:W(1),widthPx:T(2),heightPx:T(3)}));var GC=C(()=>({rb:v(4,"VIDEO_LOADING"),id:W(1),widthPx:T(2),heightPx:T(3)}));var HC=C(()=>({rb:v(5,"VIDEO_THUMBNAIL"),id:W(1),widthPx:T(2),heightPx:T(3),thumbnailFormat:y(4,DC),thumbnailUrl:W(5)}));var IC=C(()=>({rb:v(6,"VIDEO_UPGRADING"),id:W(1),widthPx:T(2),heightPx:T(3),thumbnailFormat:y(4,DC),thumbnailUrl:W(5)}));var JC=C(()=>({type:v(1,"MP4")}));var KC=D(()=>({type:[1,JC]}),()=>({}));var LC=C(()=>({rb:v(7,"VIDEO_READY"),id:W(1),widthPx:T(2),heightPx:T(3),format:y(4,KC),url:W(5),thumbnailFormat:y(6,DC),thumbnailUrl:W(7)}));var MC=C(()=>({rb:v(8,"VIDEO_ERROR"),id:W(1),widthPx:T(2),heightPx:T(3)}));var NC=D(()=>({rb:[1,AC,2,EC,3,FC,4,GC,5,HC,6,IC,7,LC,8,MC]}),()=>({}));var OC=C(()=>({mediaSlotId:W(1),previews:A(2,NC)}));var PC=C(()=>({type:v(1,"EXACT"),value:T(1)}));var QC=C(()=>({exact:y(1,PC)}));var RC=C(()=>({format:y(1,DC),maxFileSizeMb:V(2),aspectRatio:z(3,QC)}));var SC=C(()=>({type:v(2,"MIN"),value:T(1)}));var TC=C(()=>({type:v(3,"MAX"),value:T(1)}));var UC=C(()=>({type:v(4,"MIN_MAX"),min:T(1),max:T(2)}));var VC=D(()=>({type:[1,PC,2,SC,3,TC,4,UC]}),()=>({}));var WC=C(()=>({format:y(1,KC),maxFileSizeMb:V(2),aspectRatio:z(3,VC),duration:z(4,VC)}));var XC=C(()=>({id:W(1),displayName:W(2),required:Y(3),maxFileCount:T(4),hl:z(5,RC),Jn:z(6,WC)}));var YC=C(()=>({id:W(1),displayName:W(2),mediaSlots:A(3,XC)}));var ZC=C(()=>({type:v(1,"COMPLETED"),outputTypes:A(1,YC)}));var $C=C(()=>({type:v(2,"APP_ERROR"),message:X(31)}));var aD=C(()=>({type:v(3,"INTERNAL_ERROR")}));var bD=C(()=>({type:v(1,"IMAGE"),format:y(1,DC),url:W(2),widthPx:T(3),heightPx:T(4)}));var cD=C(()=>({type:v(2,"VIDEO"),format:y(1,KC),url:W(2),widthPx:T(3),heightPx:T(4)}));var dD=D(()=>({type:[1,bD,2,cD]}),()=>({}));var eD=C(()=>({mediaSlotId:W(1),files:A(2,dD)}));var fD=C(()=>({type:v(1,"REDIRECT"),url:W(1)}));var gD=D(()=>({type:[1,fD]}),()=>({}));var hD=C(()=>({type:v(1,"COMPLETED"),externalId:X(31),externalUrl:X(32),postPublishAction:z(33,gD)}));var iD=C(()=>({type:v(2,"APP_ERROR"),message:X(31)}));var jD=C(()=>({type:v(3,"REMOTE_REQUEST_FAILED")}));var kD=C(()=>({type:v(4,"INTERNAL_ERROR")}));var lD=rl()("design_publisher",{renderSettingsUi:{Mb:{},Eb:{design_publisher_v1_update_publish_settings:{cb:C(()=>({Am:y(1,yC)})),eb:D(()=>({type:[1,zC]}),()=>({}))}}},renderPreviewUi:{Mb:{design_publisher_v1_emit_on_preview_change:{cb:C(()=>({previewMedia:A(1,OC),outputTypeId:W(2),publishRef:X(3)})),eb:void 0}},Eb:{design_publisher_v1_request_preview_upgrade:{cb:C(()=>({vm:Lr(1)})),eb:void 0}}},getOutputTypes:{eb:D(()=>({type:[1,ZC,2,$C,3,aD]}),()=>({})),Mb:{},Eb:{}},publishDesign:{cb:C(()=>({publishRef:X(1),
outputMedia:A(2,eD)})),eb:D(()=>({type:[1,hD,2,iD,3,jD,4,kD]}),()=>({})),Mb:{},Eb:{}}});var mD=({type:a})=>{switch(a){case "PNG":return"png";case "JPG":return"jpg";default:throw new m(a);}},nD=({type:a})=>{switch(a){case "MP4":return"mp4";default:throw new m(a);}},oD=a=>{switch(a.type){case "IMAGE":return{format:mD(a.format),url:a.url,widthPx:a.widthPx,heightPx:a.heightPx};case "VIDEO":return{format:nD(a.format),url:a.url,widthPx:a.widthPx,heightPx:a.heightPx};default:throw new m(a);}},pD=a=>({mediaSlotId:a.mediaSlotId,files:a.files.map(oD)}),qD=a=>{if("exact"in a)return{type:"EXACT",
value:a.exact};if("min"in a&&"max"in a)return{type:"MIN_MAX",min:a.min,max:a.max};if("min"in a)return{type:"MIN",value:a.min};if("max"in a)return{type:"MAX",value:a.max};throw new m(a);},rD=a=>{var b=a.id,c=a.displayName,d=a.required,e=a.maxFileCount;if(a.accepts.image){var f=a.accepts.image;a:{var g=f.format;switch(g){case "png":g=new BC;break a;case "jpg":g=new CC;break a;default:throw new m(g);}}f={format:g,maxFileSizeMb:f.maxFileSizeMb,aspectRatio:f.aspectRatio?new QC({exact:new PC({value:f.aspectRatio.exact})}):
void 0}}else f=void 0;if(a.accepts.video){a=a.accepts.video;a:switch(g=a.format,g){case "mp4":g=new JC;break a;default:throw new m(g);}a={format:g,maxFileSizeMb:a.maxFileSizeMb,aspectRatio:a.aspectRatio?qD(a.aspectRatio):void 0,duration:a.duration?qD(a.duration):void 0}}else a=void 0;return{id:b,displayName:c,required:d,maxFileCount:e,hl:f,Jn:a}},sD=a=>({id:a.id,displayName:a.displayName,mediaSlots:a.mediaSlots.map(rD)}),tD=a=>{switch(a.rb){case "IMAGE_LOADING":return{id:a.id,kind:"image",status:"loading",
widthPx:a.widthPx,heightPx:a.heightPx};case "IMAGE_READY":return{id:a.id,kind:"image",status:"ready",widthPx:a.widthPx,heightPx:a.heightPx,format:mD(a.format),url:a.url};case "IMAGE_ERROR":return{id:a.id,kind:"image",status:"error",widthPx:a.widthPx,heightPx:a.heightPx};case "VIDEO_LOADING":return{id:a.id,kind:"video",status:"loading",widthPx:a.widthPx,heightPx:a.heightPx};case "VIDEO_THUMBNAIL":return{id:a.id,kind:"video",status:"thumbnail",widthPx:a.widthPx,heightPx:a.heightPx,thumbnailFormat:mD(a.thumbnailFormat),
thumbnailUrl:a.thumbnailUrl};case "VIDEO_UPGRADING":return{id:a.id,kind:"video",status:"upgrading",widthPx:a.widthPx,heightPx:a.heightPx,thumbnailFormat:mD(a.thumbnailFormat),thumbnailUrl:a.thumbnailUrl};case "VIDEO_READY":return{id:a.id,kind:"video",status:"ready",widthPx:a.widthPx,heightPx:a.heightPx,format:nD(a.format),url:a.url,thumbnailFormat:mD(a.thumbnailFormat),thumbnailUrl:a.thumbnailUrl};case "VIDEO_ERROR":return{id:a.id,kind:"video",status:"error",widthPx:a.widthPx,heightPx:a.heightPx};
default:throw new m(a);}},uD=a=>({mediaSlotId:a.mediaSlotId,previews:a.previews.map(tD)});var vD=ql()("design_publisher",lD,{publishDesign:async(a,{params:b},c)=>{try{var d;const n=await a({publishRef:b.publishRef,outputMedia:((d=b.outputMedia)===null||d===void 0?void 0:d.map(pD))||[]});a:switch(n.status){case "completed":var e=n.externalId,f=n.externalUrl;if(n.postPublishAction)b:{var g=n.postPublishAction;const r=g.type;switch(r){case "redirect":var h=new fD({url:g.url});break b;default:throw new m(r);}}else h=void 0;var l=new hD({externalId:e,externalUrl:f,postPublishAction:h});break a;
case "app_error":l=new iD({message:n.message});break a;case "remote_request_failed":l=new jD;break a;default:throw new m(n);}c(p(l))}catch(n){c(p(new kD))}},renderPreviewUi:async(a,{Hf:b})=>{const c=new Set,d=b({design_publisher_v1_emit_on_preview_change:async e=>{const f={previewMedia:e.previewMedia.map(uD),outputTypeId:e.outputTypeId,publishRef:e.publishRef};c.forEach(g=>g(f))}});a({requestPreviewUpgrade:async e=>{await cl(d,"design_publisher_v1_request_preview_upgrade",{vm:e})},registerOnPreviewChange:e=>
{c.add(e);return()=>c.delete(e)}})},getOutputTypes:async(a,b,c)=>{try{const e=await a();a:{const f=e.status;switch(f){case "completed":var d=new ZC({outputTypes:e.outputTypes.map(sD)});break a;case "app_error":d=new $C({message:e.message});break a;default:throw new m(f);}}c(p(d))}catch(e){c(p(new aD))}},renderSettingsUi:async(a,{Hf:b})=>{const c=b({});a({updatePublishSettings:async d=>{try{if(d.publishRef){var e=d.publishRef;var f=(new TextEncoder).encode(e).length<=5120}else f=!0;var g=f}catch(h){g=
!1}if(!g)throw new G({code:"bad_request",message:"publish_settings_size_limit_exceeded"});d=await cl(c,"design_publisher_v1_update_publish_settings",{Am:new yC({publishRef:d.publishRef})});a:switch(d.type){case "COMPLETED":d={status:"completed"};break a;default:throw new m(d);}return d}})}});var Zz={edit_design:xC,connect_data:vC,asset_picker:hA,design_publisher:vD};var wD="https://canva.ui-app.dev https://thirdparty-private-canva.ui-app.dev https://canva.ui-app.dev https://thirdparty-private-apps.canva-apps.cn https://thirdparty-public-apps.canva-apps-staging.com https://thirdparty-private-apps.canva-apps-staging.com https://thirdparty-public-apps.canva-apps-staging.cn https://thirdparty-private-apps.canva-apps-staging.cn https://thirdparty-public-apps.canva-apps-dev.com https://thirdparty-private-apps.canva-apps-dev.com https://thirdparty-public-apps-tmp.canva-apps.com https://thirdparty-private-apps-tmp.canva-apps.com https://thirdparty-public-apps-tmp.canva-apps.cn https://thirdparty-private-apps-tmp.canva-apps.cn https://thirdparty-public-apps-tmp.canva-apps-staging.com https://thirdparty-private-apps-tmp.canva-apps-staging.com https://thirdparty-public-apps-tmp.canva-apps-staging.cn https://thirdparty-private-apps-tmp.canva-apps-staging.cn https://thirdparty-public-apps-tmp.canva-apps-dev.com https://thirdparty-private-apps-tmp.canva-apps-dev.com".split(" "),
po=class{async load(){const a=wD.includes(origin);try{await Kb({src:this.Fe,qk:a})}catch(b){return{type:"LOAD_ERROR",error:b,Fe:this.Fe}}return{type:"SUCCESS"}}constructor(a){this.Fe=a}};var xD=E(()=>[1,2],1);var yD=E(()=>[1,"ADAPTIVE",2,"LIGHT",3,"DARK"]);var zD=E(()=>[0,1,2]);var AD=C(()=>({Ih:Y(14),Do:Y(1),direction:B(2,xD),uo:Y(3),Uo:Y(4),theme:Qa(7,yD),Io:Z(8),Un:Qa(11,zD),so:Y(9),Lk:Y(10),Zo:Y(16)}));var Kn=!1;if((typeof window==="undefined"?void 0:window)!=null)try{Kn=ra("ui",AD.F).Lk}catch(a){if(!(a instanceof TypeError))throw a;};var BD,CD=typeof window==="undefined"?void 0:window,Ln=(CD===null||CD===void 0?void 0:(BD=CD.cmsg)===null||BD===void 0?void 0:BD.strings)||{},Jn=new Map,DD,Hn=()=>{var a;return typeof DD==="function"?DD():DD=DD||(CD===null||CD===void 0?void 0:(a=CD.cmsg)===null||a===void 0?void 0:a.locale)||"en"},Pn={date:{weekday:{weekday:"long"},mediumNoYear:{month:"short",day:"numeric"},mediumNoYearUTC:{month:"short",day:"numeric",timeZone:"UTC"},monthUTC:{month:"long",timeZone:"UTC"},shortMonthUTC:{month:"short",
timeZone:"UTC"},monthYear:{month:"long",year:"numeric"},monthYearUTC:{month:"long",year:"numeric",timeZone:"UTC"},longNoYear:{month:"long",day:"numeric"},longUTC:{month:"long",day:"numeric",year:"numeric",timeZone:"UTC"}}};var xo=class{clear(){var a;(a=document.getElementById("errorMessageBox"))===null||a===void 0||a.remove()}constructor(a,b,c){this.Da=a;this.j=b;this.theme=c}};var lo=()=>{({Clipboard:a}=window);var a;a&&Rn(a.prototype,"write",async function(){return Promise.reject(new G({code:"not_allowed",message:Nn("TRCV3w")}))})};var jo=({pd:a,window:b})=>{a||(a=Object.getOwnPropertyDescriptor(b.Document.prototype,"cookie"))&&a.configurable&&(Object.defineProperty(b.Document.prototype,"cookie",{...a,set:()=>{console.warn("Canva apps setting cookies is not yet supported.")}}),Sn(b,"cookieStore"),Sn(b,"CookieStore"))};var Tn=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/,Vn=/^\d+$/,Un=/^[a-zA-Z0-9._%+-]+@(?:[a-zA-Z0-9-]+\.)+[a-zA-Z]{2,}$/,Wn=/^uri:([a-zA-Z0-9+-.]+):\/\/([a-zA-Z0-9+-.]+)\/.*$/;var fo=class{start(){jb(this.Ga.ma,new ib({hb:this.hb})).catch(a=>this.Ga.j.G(a,{L:"unable to track native fetch call start"}))}complete(a,b){this.span&&this.span.end(b>199&&b<300?"ok":"error",new Map([["response_code",b]]));const c=Date.now()-this.qn;lb(this.Ga.ma,new kb({hb:this.hb,durationMs:c,na:b})).catch(d=>this.Ga.j.$c(d,{L:"unable to track native fetch call summary"}));a.Ic||nb(this.Ga.ma,new mb({hb:this.hb,durationMs:c,na:b,endpoint:this.endpoint})).catch(d=>this.Ga.j.$c(d,{L:"unable to track native fetch call attempt"}))}constructor(a,
b,c){this.hb=a;this.Ga=b;this.qn=Date.now();var d=c.hostname,e=c.path;this.endpoint=d?d+(e?e:""):"";switch(a){case 1:a="fetch";break;case 2:a="xml_http";break;default:throw new m(a);}b.Da!==6||b.Ic||(this.span=b.Sa.Td("fetch",new Map([["net.peer.name",c.hostname],["apps_sdk_app.id",b.appId],["apps_sdk_app.name",b.appName],["apps_sdk_app.approval_status",mt.C(b.Da)],["browser_api",a]])))}};var ED={AAF8xDuFUNg:[{name:"create-upscale-image",na:200,requestUrl:"https://dj7jvjeb1v6pc.cloudfront.net/prod/a1d-image-upscale/upscale",Ha:"POST",Qa(a){return typeof a==="string"?JSON.parse(a).operation==="create-upscale-image":!1}},{name:"create-upscale-image",na:200,requestUrl:"https://app-iu.a1d.ai/api/task",Ha:"POST",Qa(a){return typeof a==="string"?(a=JSON.parse(a),a.scale===2||a.scale===4):!1}},{name:"premium-create-upscale-image",na:200,requestUrl:"https://app-iu.a1d.ai/api/task",Ha:"POST",
Qa(a){return typeof a==="string"?(a=JSON.parse(a),a.scale===8||a.scale===16):!1}}],AAF9Z7S4lbA:[{name:"premium-frame-maker",na:200,requestUrl:"https://tracking.repixo.com/track",Ha:"POST",Qa(a){return typeof a==="string"?JSON.parse(a).accessType==="canva":!1}}],AAGB3pmX7hc:[{name:"type-extrude-add-premium-element",na:200,requestUrl:"https://us-central1-pixel-tinkers-backoffice.cloudfunctions.net/api/track",Ha:"POST"}],AAFxv8Y4eSw:[{name:"type-gradient-add-premium-element",na:200,requestUrl:"https://us-central1-pixel-tinkers-backoffice.cloudfunctions.net/api/track",
Ha:"POST"}],AAFiuq2BQEA:[{name:"patternedai-ai-generation",na:200,requestUrl:"https://canva.patterned.ai/mixpanel",Ha:"POST",Qa(a){if(typeof a==="string"){var b,c;a=JSON.parse(a);return a.eventName==="CanvaUserGetsImagesData"&&((b=a.properties)===null||b===void 0?void 0:b.ai)===!0&&((c=a.properties)===null||c===void 0?void 0:c.canvaProUser)===!0}return!1},Nh(a){if(typeof a==="string")return a=JSON.parse(a),new gt({Wl:Number(a.properties.n_images)})}},{name:"patternedai-add-premium-element",na:200,
requestUrl:"https://canva.patterned.ai/mixpanel",Ha:"POST",Qa(a){if(typeof a==="string"){var b,c;a=JSON.parse(a);return((b=a.properties)===null||b===void 0?void 0:b.premium_feature)===!0&&((c=a.properties)===null||c===void 0?void 0:c.canvaProUser)===!0}return!1}}],AAFapKzFFus:[{name:"d-id-generate-premium-presenter",na:200,requestUrl:"https://canva-plugin-server3.d-id.com/track",Ha:"POST",Qa(a){return typeof a==="string"?(a=JSON.parse(a),a.event==="generate"&&a.props.is_d_id_user===!1):!1},Nh(a){if(typeof a===
"string")return a=JSON.parse(a),new gt({Gn:Number(a.props.duration)})}}]},ko=class{track(a){var b=this.config[this.appId];if(b&&(b=b.find(e=>{try{const f=e.Qa||(()=>!0),g=typeof e.requestUrl==="string"?h=>e.requestUrl===h:e.requestUrl;return e.na===a.na&&e.Ha===a.Ha&&g(a.requestUrl)&&f(a.Qa)}catch(f){this.j.$c(f,{L:"requestBody unexpectedly failed"})}return!1}))){try{var c;var d=(c=b.Nh)===null||c===void 0?void 0:c.call(b,a.Qa)}catch(e){this.j.$c(e,{L:"processing output details failed"})}tb(this.ma,
new sb({Qd:b.name,ym:d})).catch(e=>this.j.$c(e,{L:"unable to track developer server processing request"}))}}constructor(a,b,c){this.appId=a;this.ma=b;this.j=c;this.config=ED}};var mo=class{get state(){return this.wj}constructor(a){a.current.Hm(b=>{this.wj=b.state})}};var zo=window;var FD=!1,Uq=class{setTag(a,b){this.tags[a]=b}Xi(){}uf(){}Nc(a){return new Uq(this,a)}B(a){this.console.log("breadcrumb added",a)}setContext(a){this.context=a}md(a,b){this.console.error(...Eo(this,"critical",a,b))}error(a,b){this.console.error(...Eo(this,"error",a,b))}G(a,b){this.console.error(...Eo(this,"error",a,b))}$c(a,b){this.console.warn(...Eo(this,"warning",a,b))}ad(a,b){this.console.warn(...Eo(this,"warning",a,b))}info(a,b){this.console.info(...Eo(this,"info",a,b))}debug(a,b){this.console.debug(...Eo(this,
"debug",a,b))}toJSON(){return{name:this.name,context:this.context,tags:this.tags}}constructor(a=console,b="default"){this.name=b;this.tags={};if(!FD&&typeof window==="object"){const c=window.onerror;window.onerror=(...e)=>{typeof c==="function"&&c(...e);console.error("unhandled error:",...e)};const d=window.onunhandledrejection;window.onunhandledrejection=e=>{typeof d==="function"&&d(e);console.error("[ConsoleErrorClient]: Unhandled promise rejection",e)};FD=!0}k(b.indexOf(".")===-1,"name must not contain a dot");
a instanceof Uq?(this.name=`${a.name}.${b}`,this.console=a.console):this.console=a}};var Fo,Io;var kp;__c.tp=class extends Error{constructor(a,b){super(a);this.sampleRate=b;this.sampleRate=No(b)}};
kp=class{setupOnce(a,b){a((c,d)=>{const e=b().getIntegration(kp);if(!e)return c;if(!(Math.random()<Oo(e,d===null||d===void 0?void 0:d.originalException,c.level)))return null;d={sampleRate:Oo(this,d===null||d===void 0?void 0:d.originalException)};c.extra=c.extra!=null?{...c.extra,...d}:d;c.tags=c.tags!=null?{...c.tags,...d}:d;return c})}constructor(a,b){this.zh=a;this.yh=b;this.name=kp.id;this.zh=No(a);this.yh=No(b)}};kp.id="Sampling";var GD=class{constructor(){this.Ti={}}};var op=class{setupOnce(a,b){a(c=>{const d=b().getIntegration(op);return d?Uo(d,c)?null:c:c})}constructor(a=[]){this.Dj=a;this.name=op.id}};op.id="FilterErrors";var lp=class{setupOnce(a,b){a(c=>{b().getIntegration(lp);return c})}constructor(){this.name=lp.id}};lp.id="HostRpcServiceErrors";var Vo=class extends Error{constructor(a){var b=a.message,c=a.statusCode,d=a.requestUrl;let e=HD[c];e||(e=400<=c&&c<500?"unknown client error":500<=c&&c<600?"unknown server error":"unknown error");super(b&&b!==e?b:d?`HTTP ${e} on: ${d.split("?")[0]}`:`HTTP ${e}`);this.statusCode=a.statusCode;this.requestId=a.requestId;this.requestUrl=a.requestUrl;this.endUserMessage=a.endUserMessage;this.body=a.body;Object.setPrototypeOf(this,Vo.prototype)}},HD={[0]:"client timeout",[400]:"bad request",[401]:"unauthorized",
[403]:"forbidden",[404]:"not found",[409]:"version conflict",[418]:"CSRF token expired",[429]:"too many requests",[500]:"internal server error",[501]:"not implemented",[503]:"service unavailable",[504]:"gateway timeout"},ID=class extends Vo{},JD=class extends Vo{},KD=class extends Vo{constructor(a={}){super({...a,statusCode:0});this.name="HttpTimeoutError";Object.setPrototypeOf(this,KD.prototype)}},wp=class extends ID{constructor(a={}){super({...a,statusCode:400});this.name="HttpBadRequestError";
Object.setPrototypeOf(this,wp.prototype)}},xp=class extends ID{constructor(a={}){super({...a,statusCode:401});this.name="HttpUnauthorizedError";Object.setPrototypeOf(this,xp.prototype)}},yp=class extends ID{constructor(a={}){super({...a,statusCode:403});this.name="HttpForbiddenError";Object.setPrototypeOf(this,yp.prototype)}},zp=class extends ID{constructor(a={}){super({...a,statusCode:404});this.name="HttpNotFoundError";Object.setPrototypeOf(this,zp.prototype)}},Ap=class extends ID{constructor(a=
{}){super({...a,statusCode:409});this.name="HttpConflictError";Object.setPrototypeOf(this,Ap.prototype)}},Bp=class extends ID{constructor(a={}){super({...a,statusCode:418});this.name="CsrfTokenExpiredError";Object.setPrototypeOf(this,Bp.prototype)}},Cp=class extends ID{constructor(a={}){super({...a,statusCode:429});this.name="HttpTooManyRequestsError";Object.setPrototypeOf(this,Cp.prototype)}},Gp=class extends ID{constructor(a){k(400<=a.statusCode&&a.statusCode<500);super(a);this.name="UnknownClientError";
Object.setPrototypeOf(this,Gp.prototype)}},Dp=class extends JD{constructor(a={}){super({...a,statusCode:500});this.name="HttpInternalServerError";Object.setPrototypeOf(this,Dp.prototype)}},Ep=class extends JD{constructor(a={}){super({...a,statusCode:503});this.name="HttpServiceUnavailableError";Object.setPrototypeOf(this,Ep.prototype)}},Fp=class extends JD{constructor(a={}){super({...a,statusCode:504});this.name="HttpGatewayTimeout";Object.setPrototypeOf(this,Fp.prototype)}},Hp=class extends JD{constructor(a){k(500<=
a.statusCode&&a.statusCode<600);super(a);this.name="UnknownServerError";Object.setPrototypeOf(this,Hp.prototype)}},Ip=class extends Vo{constructor(a){super(a);this.name="UnknownHttpError";Object.setPrototypeOf(this,Ip.prototype)}};var mp=class{setupOnce(a,b){a((c,d)=>{if(!b().getIntegration(mp)||!d)return c;if(d=Wo(d.originalException))c.tags||(c.tags={}),Object.assign(c.tags,{http_service_error:!0,statusCode:d.statusCode,...(d.requestId?{requestId:d.requestId}:{})}),d.requestUrl&&(c.tags.phase=d.requestUrl.includes("/csrf3/")?"csrf":"request");return c})}constructor(){this.name=mp.id}};mp.id="HttpServiceErrors";var Zo={now:()=>Date.now()};var LD=class{add(a){this.nd=this.Vk(this.nd);this.list[this.nd]=a}find(a){let b=this.nd;do{if(this.list[b]&&a(this.list[b]))return this.list[b];b=this.Xk(b)}while(b!==this.nd)}constructor(){this.Ff=10;this.nd=0;this.Vk=a=>(a+1)%this.Ff;this.Xk=a=>(a+this.Ff-1)%this.Ff;this.list=Array(10)}},jp=class{setupOnce(a,b){a(c=>{const d=b().getIntegration(jp);d&&($o(d,c)?c=null:d.history.add({event:c,timestamp:Zo.now()}));return c})}constructor(a){this.wn=a;this.name=jp.id;this.history=new LD}};jp.id="NoSuccessiveEvent";var ip=class{setupOnce(a,b){a(c=>{var d,e;if(!b().getIntegration(ip))return c;var f;c.tags=(f=c.tags)!==null&&f!==void 0?f:{};c.tags["prior.unhandled.error.count"]=this.Oi;((e=c.exception)===null||e===void 0?0:(d=e.values)===null||d===void 0?0:d.some(g=>{var h;return((h=g.mechanism)===null||h===void 0?void 0:h.handled)===!1}))&&this.Oi++;return c})}constructor(){this.name=ip.id;this.Oi=0}};var np=class{setupOnce(a,b){a(c=>{const d=b().getIntegration(np);return d?d.processEvent(c):c})}processEvent(a){var b;a===null||a===void 0||(b=a.breadcrumbs)===null||b===void 0||b.map((c,d)=>{if(a===null||a===void 0?0:a.breadcrumbs){var e=a.breadcrumbs;if(c.type==="http"){var f;c.data=c.data||{};var g;c.data.url=cp(this,(g=(f=c.data)===null||f===void 0?void 0:f.url)!==null&&g!==void 0?g:"")}e[d]=c}});a.request&&(a.request=this.Jg(a.request));return a}Jg(a){var b,c,d;const e=(a===null||a===void 0?
0:a.url)?cp(this,a===null||a===void 0?void 0:a.url):void 0,f={};if(a===null||a===void 0?0:(b=a.headers)===null||b===void 0?0:b["User-Agent"])f["User-Agent"]=a===null||a===void 0?void 0:a.headers["User-Agent"];if(a===null||a===void 0?0:(c=a.headers)===null||c===void 0?0:c.Referer)f.Referer=cp(this,a===null||a===void 0?void 0:(d=a.headers)===null||d===void 0?void 0:d.Referer);return{url:e,headers:f}}constructor(a,b){this.Ej=a;this.location=b;this.name=np.id}};np.id="UrlScrubber";var dp=[function(a){if(a=/canvaeditor\/(\d+\.\d+\.\d+)/.exec(a))return{name:"mobile_app_version",value:a[1]}},function(a){if(a=/com.canva.editor\s\(version\/(\d+\.\d+\.\d+)/.exec(a))return{name:"mobile_app_version",value:a[1]}}];var pp=["TimeoutError","HttpTimeoutError",/^ResizeObserver loop/,/^WHEN_CANCELLED$/,"ChunkLoadError",/^NetworkError: Failed to execute 'importScripts' on 'WorkerGlobalScope':/,/Failed to register a ServiceWorker.*(The document is in an invalid state|An unknown error occurred when fetching the script|Failed to access storage|The URL protocol of the current origin \('null'\) is not supported|Timed out while trying to start the Service Worker)\.$/,/^(Can't find variable: indexedDB|Internal error opening backing store for indexedDB.open.|Encountered full disk while opening backing store for indexedDB.open.|An internal error was encountered in the Indexed Database server)/,
/Non-Error promise rejection captured with value: [Tt]imeout( \(.\))?/],Vq=class{Jg(a){var b,c,d;if(!a.url)return{headers:{"User-Agent":(d=a===null||a===void 0?void 0:(b=a.headers)===null||b===void 0?void 0:b["User-Agent"])!==null&&d!==void 0?d:""}};b=/^(\/design\/[a-zA-Z0-9_-]+\/)([a-zA-Z0-9_-]{22})(.*)/;d=new URL(a.url);d.search="";b.test(d.pathname)&&(d.pathname=d.pathname.replace(b,"$1<REDACTED>$3"));var e;return{url:d.toString(),headers:{"User-Agent":(e=a===null||a===void 0?void 0:(c=a.headers)===
null||c===void 0?void 0:c["User-Agent"])!==null&&e!==void 0?e:""}}}uf(a){this.Bf.push(a)}Nc(a){return new Vq(this.Ea,this.componentStack.concat(a),this.Vf,this.T,this.xh,this.Bf,!0,this.jg)}setContext({user:a,locale:b,ap:c}){var d,e;(e=this.T)===null||e===void 0||(d=e.getCurrentHub())===null||d===void 0||d.configureScope(f=>{a&&(f.setUser(a),f.setExtra("isAnonymousUser",!1));b&&f.setTag("locale",b);c===null||c===void 0||c.forEach((g,h)=>f.setExtra(h,g))})}setTags(a){for(const b of a)this.setTag(b.name,
b.value)}setTag(a,b){if(this.T!=null){{var c=a.length<=32;const d=b.length<=200;c&&d?c=p(!0):(c=(c?"":"Key name length cannot exceed 32 characters.\n")+(d?"":"Key value length cannot exceed 200 characters.\n"),c=q(Error(c+`Tag: ${a}:${b}`)))}c.ok?this.T.setTag(a,b):sp(this,c.error)}}setExtras(a){for(const b of a)this.setExtra(b.name,b.value)}setExtra(a,b){this.T!=null&&this.T.setExtra(a,Lo(b))}Xi(a){this.Vf=a}B(a){var b;this.T==null||(b=this.T)!==null&&b!==void 0&&b.addBreadcrumb({...a,level:a.level})}md(a,
b){vp(this,"fatal",a,b)}error(a,b){vp(this,"error",a instanceof Error?a:Error(a),b)}G(a,b){vp(this,"error",a,b)}$c(a,b){vp(this,"warning",a instanceof Error?a:Error(a),b)}ad(a,b){vp(this,"warning",a,b)}info(a,b){vp(this,"info",a instanceof Error?a:Error(a),b)}debug(a,b){vp(this,"debug",a instanceof Error?a:Error(a),b)}constructor(a,b=[],c=[],d=self.Sentry,e=new GD,f=[],g=!1,h){a:{var l=self;if(typeof l.bh==="object"&&typeof l.bh.Wk==="function"){let n;try{n=l.bh.Wk()}catch(r){l=void 0;break a}l=typeof n===
"string"?n:void 0}else l=void 0}this.Ea=a;this.componentStack=b;this.Vf=c;this.T=d;this.xh=e;this.Bf=f;this.jg=h;this.nl=void 0;this.allowUrls="/dist/renderer/ canva.com canva.cn canva-dev.com canva-staging.com canva-staging.cn www.features.canva-internal.com www.features.canva-internal-staging.com canva-apps.com canva-apps.cn canva-apps-dev.com canva-apps-staging.com canva-apps-staging.cn".split(" ");this.T?g||rp(this,a,{xi:l}):typeof self.suppressSentryInitializationError!=="undefined"&&self.suppressSentryInitializationError===
!0||console.error("Sentry can not be found on the global scope.")}};var MD=class extends Error{constructor(a){super(`${a}: Timeout`);this.name="TimeoutError";Object.setPrototypeOf(this,MD.prototype)}};var ND=class{get status(){return this.xhr.status}getResponseHeader(a){return this.xhr.getResponseHeader(a)}constructor(a){this.xhr=a}},OD=class extends ND{get body(){return this.xhr.responseText}},PD=class extends ND{get body(){return this.xhr.response}},Up=class{Xc(a){return new Promise((b,c)=>{const d=new XMLHttpRequest;d.responseType=a.responseType;d.timeout=a.timeout||0;const e=Error("xhr internal error"),f=[],g=()=>{f.forEach(h=>h());f.length=0};if(d.timeout>0){const h=setTimeout(()=>{g();d.abort();
const l=new MD("xhrEngine");l.stack=e.stack;c(l)},d.timeout+1E3);f.push(()=>clearTimeout(h))}d.onload=()=>{g();if(a.responseType==="blob")return b(new PD(d));if(a.responseType==="text")return b(new OD(d));throw new m(a.responseType);};d.onerror=()=>{g();c(e)};d.ontimeout=()=>{g();const h=new MD("xhrEngine");h.stack=e.stack;c(h)};if(a.vg){const h=a.vg;d.upload.addEventListener("progress",h);f.push(()=>{d.upload.removeEventListener("progress",h)})}d.open(a.method,a.url,!0);if(a.headers)for(const h in a.headers){const l=
a.headers[h];l!=null&&d.setRequestHeader(h,l)}d.withCredentials=!!a.withCredentials;d.send(a.body)})}};var QD=class{constructor(a){bm(this,{Gc:ur.ref,Hc:ur.ref});this.gd=void 0;a&&(this.gd=a.gd,this.Gc=a.Gc,this.Hc=a.Hc,this.ee=a.ee,this.kf=a.kf,this.he=a.he,this.Ge=a.Ge,this.app=a.app,this.ie=a.ie,this.je=a.je)}};var RD=class{async Xc(a,b,c){let d;if(c.Ya){const U=c.Ya.kj,Ja=U&&(c.Ya.Qd||U.af);if(Ja){var e;const re=b.startsWith(`${this.Yc}/${Mp}`)?"csrf":"request";d=(e=this.Sa)===null||e===void 0?void 0:e.startSpan(Ja,U.X,new Map([["http.method",a],["http.phase",re]]))}}try{const U=this.re;var f=this.Dk,g=c.body,h={...c.headers},l=U.ee,n=U.gd,r=this.wf,t=U.app,w=U.Gc,x=U.Hc,F=U.he,H=U.ie,I=U.je,O=U.Ge,N=c.Ya&&c.Ya.Qd,ja=c.Ya&&c.Ya.eq,qa=c.Ya&&c.Ya.jq,za;if(za=d){e=d;const re=e.spanContext(),tE=e.mb()?"01":
"00";za=`00-${re.traceId}-${re.spanId}-${tE}`}const Ja=await f.Xc({method:a,url:b,body:g,headers:{...h,"X-Canva-Active-User":l,"X-Canva-Analytics":n,"X-Canva-Api":r,"X-Canva-App":t,"X-Canva-Auth":w,"X-Canva-Authz":x,"X-Canva-Brand":F,"X-Canva-Build-Name":H,"X-Canva-Build-Sha":I,"X-Canva-Locale":O,"X-Canva-Request":N,"X-Canva-Request-Case":ja,"X-Canva-Service-Method":qa,"X-Canva-Traceparent":za,"X-Canva-User":U.kf,"X-Csrf-Token":c.uh&&c.uh.token},vg:c.vg,withCredentials:!!this.Yc,timeout:c.timeoutMs,
responseType:"text"});d===null||d===void 0||d.setAttribute("http.status_code",Ja.status);return Rp(this,b,Ja,a!=="HEAD")}catch(U){d===null||d===void 0||d.setStatus("error");if(U instanceof MD){const Ja=new KD({requestUrl:b,message:U.message});Ja.stack=U.stack;d===null||d===void 0||d.setAttribute("http.error_type","timeout");throw Ja;}U instanceof Vo?d===null||d===void 0||d.setAttribute("http.error_type","http_service_error"):d===null||d===void 0||d.setAttribute("http.error_type","unknown");throw U;
}finally{d===null||d===void 0||d.end()}}Ii(a){const b=a.getResponseHeader("X-Canva-Auth");a=a.getResponseHeader("X-Canva-Authz");b!=null&&(this.re.Gc=b!=="!"?b:void 0);a!=null&&(this.re.Hc=a!=="!"?a:void 0)}constructor(a,b,c,d=Zo,e){this.Dk=a;this.se=d;this.Sa=e;bm(this,{Ii:cm});this.re=void 0;this.re=c!==null&&c!==void 0?c:new QD(b);this.wf=b&&b.wf;this.Yc=b&&b.Yc||"";this.Fb=b?Kl(b.Fb,f=>Promise.resolve(f)):new Map}},Pp=3E5,Mp="_ajax/csrf3";var Vp=class extends RD{get(a,b){return Tp(this,"GET",a,b)}post(a,b,c){return Qp(this,Sp(a),c,d=>Tp(this,"POST",a,c,d,b))}delete(a,b){return Qp(this,Sp(a),b,c=>Tp(this,"DELETE",a,b,c))}};var cr=class{sd(){return new SD}},SD=class{Td(){return new TD}startSpan(){return new TD}addEvent(){}async flush(){}},TD=class{Ua(){return new UD}abort(){}setAttributes(){return this}setAttribute(){return this}setStatus(){return this}isRecording(){return!1}mb(){return!1}end(){return{bc:()=>({}),cc:()=>({})}}spanContext(){return this.context}addEvent(){}fe(){}constructor(){this.name="";this.attrs=new Map;this.za="NOOP";this.Zb=[];this.status="unset";this.Na=new Map;this.startTime=performance.now();
this.Ca="span";this.context={traceId:"",spanId:"",traceFlags:0};this.links=[]}},UD=class{addEvent(){}fe(){}setAttribute(){}setAttributes(){}};var pq=class{xd(){var a,b,c,d,e;return((b=this.Dc.PerformanceObserver)===null||b===void 0?void 0:(a=b.supportedEntryTypes)===null||a===void 0?void 0:a.includes("event"))&&((e=this.Dc.PerformanceEventTiming)===null||e===void 0?void 0:(d=e.prototype)===null||d===void 0?void 0:(c=d.hasOwnProperty)===null||c===void 0?void 0:c.call(d,"interactionId"))}disconnect(){var a;(a=this.Jd)===null||a===void 0||a.disconnect()}constructor(a,b){var c=window;this.Zl=a;this.j=b;this.ii=10;this.Dc=c;this.wd=new Map;
this.oc=[];this.cg=new Map;if(this.xd())try{this.Jd=new this.Dc.PerformanceObserver(d=>{for(const e of d.getEntries())if(e.interactionId!=null&&e.interactionId!==0){if(d=this.wd.get(e.interactionId))e.duration>d.latency&&(d.latency=e.duration,d.startTime=e.startTime);else{d={id:e.interactionId,latency:e.duration,startTime:e.startTime};const f=this.wd.get(this.oc[this.oc.length-1]);if(this.oc.length<this.ii||f==null||d.id>f.id)this.wd.set(d.id,d),this.oc.push(d.id),Xp(this)}Yp(this,d)}}),this.Jd.observe({type:"event",
buffered:!0,durationThreshold:0})}catch(d){b.G(d,{L:"Error creating new `PerformanceObserver`"})}}};var VD=class{constructor(a,b,c){this.name=a;this.j=c;this.Sa=b}};var WD=class extends VD{xd(){var a,b;return((b=this.PerformanceObserver)===null||b===void 0?void 0:(a=b.supportedEntryTypes)===null||a===void 0?void 0:a.includes(this.Oe.type||""))||!1}constructor(a,b,c,d=new SD){var e=self.PerformanceObserver;super(a,d,c);this.Oe=b;this.PerformanceObserver=e;this.enabled=!0;this.xd()?(this.Jd=new e(f=>{this.Jh(f)}),Zp(this)):this.enabled=!1}};var nq=class extends WD{Jh(a){$p(this);for(const b of a.getEntries())b.transferSize!=null&&this.resources.push({startTime:b.startTime,endTime:b.responseEnd,yn:b.transferSize,wl:b.encodedBodySize!=null&&b.encodedBodySize!==0&&b.transferSize===0,zl:b.decodedBodySize===0&&b.transferSize===0})}Md(a){if(this.enabled&&a.endTime!=null){var b=aq(this,{startTime:a.startTime,endTime:a.endTime});a.setAttributes(new Map([["data_usage.transfer_size_bytes",b.Ug],["data_usage.requests",b.ij],["data_usage.requests.cached",
b.gj],["data_usage.requests.opaque",b.hj]]))}}constructor(a){super("DataUsage",{type:"resource",buffered:!0},a);this.resources=[]}};var XD=new Set(["uop_attr_type","embedded_editor","timed_out","unhandled_exception"]),YD=new Set(["editor.editing.sync.health","performance.web_vitals.interaction_to_next_paint"]),oq=class extends VD{Md(a){if(this.enabled&&a.endTime!=null&&!a.aborted&&__c.bq(a)&&!YD.has(a.name)){var b=new Map;for(const [c,d]of a.attrs.entries())XD.has(c)&&b.set(c,d);a={name:a.name,attrs:b,context:a.spanContext(),startTime:a.startTime,createTime:performance.now()};this.ea.push(a);this.ea.length>this.config.Ll&&(this.ea=
this.ea.slice(this.ea.length/2));dq(this)}}constructor(a,b,c,d,e=(()=>{var g;return((g=window)===null||g===void 0?void 0:g.requestIdleCallback)!=null?h=>window.requestIdleCallback(h,{timeout:this.config.bl}):h=>h()})(),f=window){super("InteractionLatency",b.sd("interaction_latency"),a);this.tl=c;this.config=d;this.al=e;this.Za=[];this.ea=[];this.Cd=[];this.sl=this.tl(g=>{this.enabled&&(g={...g,createTime:performance.now()},this.Za.push(g),this.Za.length>this.config.Kl&&(this.Za=this.Za.slice(this.Za.length/
2)),dq(this))});this.enabled=this.sl.xd();f.addEventListener("pageshow",g=>{g.persisted&&(this.Za=[],this.ea=[],this.Cd=[])},!0)}};var kq=class extends WD{Md(a){if(this.enabled&&a.endTime!=null){var {count:b,duration:c}=hq(this,a.startTime,a.endTime);a.setAttributes(new Map([["long_task_count",b],["long_task_duration",c]]));if(a.parentSpanId==null){const d=gq(this,a.startTime,a.endTime);if(d.length>0){const e=this.Sa.startSpan("long_tasks",a,{startTime:a.startTime});d.forEach(({startTime:f,duration:g,name:h})=>this.Sa.startSpan("long_task",e,{startTime:f,attrs:new Map([["name",h]])}).end("ok",f+g));e.end()}}}}Jh(a){a=a.getEntries();
for(const b of a)this.Bd.length>=this.mf&&(this.Bd=this.Bd.slice(a.length)),this.Bd.push(b)}constructor(a){super("LongTaskService",{type:"longtask",buffered:!0},a,new SD);this.Bd=[];this.mf=80}};var mq=class extends VD{Md(a){try{const b=iq(this,a);a.setAttribute("was_always_visible",b);for(const d of a.Zb)d.setAttribute("was_event_parent_always_visible",b,!0);const c=a.X;if(a.Ca==="event"&&c!=null){const d=iq(this,c);a.setAttribute("was_event_parent_always_visible",d)}}catch(b){this.j.G(b,{L:"VisibilityService: failed to apply visibility attributes"})}}constructor(a){var b=window.document;super("VisibilityService",new SD,a);this.document=b;this.getCurrentTime=()=>performance.now();this.mf=
40;this.Vb=[];this.Ne=()=>{this.Vb.length>=this.mf&&(this.Vb=this.Vb.slice(1));this.Vb.push({status:jq(this),time:this.getCurrentTime()})};this.sh=this.getCurrentTime();this.document.addEventListener("visibilitychange",this.Ne);this.Vb.push({status:jq(this),time:this.sh})}};__c.br=class extends VD{qa(a){if(__c.bq(a)&&a.name!=="editor.editing.sync.health"){const b=a.attrs.get("uop_attr_type");a={Fq:a.name,Gq:typeof b==="string"?b:void 0};this.mj?__c.rq(this,a):(this.ea.length===20&&this.ea.pop(),this.ea.unshift(a))}}constructor(a){super("TrackUserOperationStarted",new SD,a);this.ea=[]}};__c.br.prototype.rd=ba(0);var ar=class extends VD{qa(a){this.pb.add(a)}Md(a){this.pb.delete(a)}constructor(a){super("UnhandledExceptions",new SD,a);this.pb=new Set;this.Pj=b=>{try{var c,d;((d=b.exception)===null||d===void 0?0:(c=d.values)===null||c===void 0?0:c.some(e=>{var f;return((f=e.mechanism)===null||f===void 0?void 0:f.handled)===!1}))&&this.Sj(b.event_id)}catch(e){this.j.G(e,{L:"Failed to close all spans"})}return b};this.Sj=b=>{for(const c of this.pb)c.name+=".unhandled_exception",c.end("error",new Map([["unhandled_exception",
!0],["sentry_event_id",b]]));this.pb.clear()};a.uf(b=>this.Pj(b))}};var Sq=class{qa(a){this.W?this.W.qa(a):this.Df.push(a)}process(a){try{this.W?this.W.process(a):this.Cf.push(...a)}catch(b){this.j.G(b,{L:`Failed to export the span buffer from ${Sq.name}`,extra:new Map(__c.tq(a))})}}async flush(){const a=await this.ei;a.process(this.Cf);await a.flush();this.Cf=[]}constructor(a,b){this.ei=a;this.j=b;this.Cf=[];this.Df=[];this.W=void 0;this.ei.then(c=>this.W=c).then(()=>{for(const c of this.Df)this.W.qa(c);this.Df.length=0;return this.flush()})}};var Qq=class{$i(){return!0}};var ZD=zq(16),$D=zq(8),yq=Array(32);var Eq=class{Ua(){return this.Ba||new UD}setAttributes(a,b=!1){if(this.bd&&!b)return this;this.attrs=new Map([...this.attrs,...a]);return this}setAttribute(a,b,c=!1){if(this.bd&&!c)return this;this.attrs.set(a,b);return this}setStatus(a){try{if(this.bd)return this;this.status=a;return this}catch(b){return this.status="error",this.j.G(b),this}}isRecording(){return!this.ended}mb(){return(this.spanContext().traceFlags&1)!==0}abort(){try{var a;if(!this.aborted){this.aborted=!0;this.setAttribute("span_aborted",
!0);for(const b of this.Mc)b.abort();this.ended||(this.bd=this.ended=!0,this.timeout&&clearTimeout(this.timeout),((a=this.qb)===null||a===void 0?0:a.frameRate)&&Gq(this.qb.frameRate),this.endTime=this.getCurrentTime(),this.duration=this.endTime-this.startTime,Cq(this),Fq(this),this.lg.forEach(b=>b()),this.Pa.Uc.process([this]))}}catch(b){this.j.G(b)}}end(a,b,c){try{if(this.ended)return{bc:this.bc,cc:this.cc};this.ended=!0;return Hq(this,a,b,c)}catch(d){return this.j.G(d,{L:"Error ending span",extra:new Map(sq(this))}),
{bc:this.bc,cc:this.cc}}}fe(a){try{this.ended&&this.aborted||(this.ended&&this.Sf?a(this.Sf):this.Ld.push(a))}catch(b){this.j.G(b)}}spanContext(){return this.context}addEvent(a,b){try{k(a.length>0,"Event name cannot be empty");const {Ke:c,Le:d}=Aq(b),e=new aE({name:a,X:this,Pa:this.Pa,lb:this.lb,za:this.za,j:this.j,startTime:d===null||d===void 0?void 0:d.startTime,Ba:void 0,Ca:"event",qd:d===null||d===void 0?void 0:d.qd,getCurrentTime:this.getCurrentTime,Oa:this.Oa,attrs:(d===null||d===void 0?void 0:
d.attrs)||c,wg:this.startTime});this.Zb.push(e)}catch(c){this.j.G(c)}}get Na(){return this.lb()}constructor(a){var b;this.bd=this.aborted=this.ended=!1;this.attrs=new Map;this.Zb=[];this.Mc=[];this.status="unset";this.Sf=void 0;this.Ld=[];this.lg=[];this.bc=f=>xq({span:this,j:this.j,Oa:this.Oa,...f});this.cc=()=>this.mb()?this.spanContext():void 0;this.name=a.name;this.ended=!1;this.Pa=a.Pa;var c;this.getCurrentTime=(c=a.getCurrentTime)!==null&&c!==void 0?c:f=>{var g;return(g=f===null||f===void 0?
void 0:f.override)!==null&&g!==void 0?g:performance.now()};c=$D();this.identifier=`${this.name}_${c}`;this.startTime=this.getCurrentTime({id:this.identifier,override:a.startTime});this.za=a.za;this.Ba=a.Ba;this.Ca=a.Ca;this.j=a.j;this.qb=a.qb;const d=((b=a.X)===null||b===void 0?void 0:b.spanContext().traceId)||ZD();a.attrs&&(this.attrs=new Map(a.attrs));this.attrs.set("span_type",this.Ca);b=a.Pa.Ig.$i({traceId:d,af:this.name,attributes:this.attrs,X:a.X})?1:0;this.context={spanId:c,traceId:d,traceFlags:b};
this.links=a.links||[];a.X&&(this.parentSpanId=a.X.spanContext().spanId,this.X=a.X);this.lb=a.lb;this.Oa=a.Oa;this.setStatus("ok");this.timeout=setTimeout(()=>{var f;this.setAttribute("timed_out",!0);__c.bq(this)&&((f=this.Ba)===null||f===void 0?0:f.Be)?this.end("error"):(this.name+=".timed_out",this.end("ok"))},a.timeout||12E4);for(const f of this.Pa.plugins)try{var e;(e=f.qa)===null||e===void 0||e.call(f,this)}catch(g){this.j.G(g,{L:"Error calling plugin onSpanStart",extra:new Map([["plugin",f.name],
...sq(this)])})}this.Pa.Uc.qa(this)}},aE=class extends Eq{constructor(a){super(a);a.wg!=null&&(this.setAttribute("parent_relative_start_ms",Math.round(this.startTime-a.wg)),this.setAttribute("parent_start",a.wg));a.qd&&this.setAttribute("event_type",a.qd);this.end("ok",this.startTime)}};var Iq=class{get aborted(){return this.wa.aborted}fe(a){try{this.ended&&this.aborted||(this.ended&&this.Tf?a(this.Tf):this.Ld.push(a))}catch(b){this.j.G(b,{tags:new Map([["user_operation",this.name]])})}}addEvent(a,b){try{const c=Bq(b);this.eventContext.forEach((e,f)=>{c.attrs.has(f)||c.attrs.set(f,e)});c.attrs.set("user_operation",this.name);c.attrs.set("is_uop",!0);c.attrs.set("sample_rate_override",1);const d=this.wa.attrs.get("uop_attr_type");d!=null&&c.attrs.set("uop_attr_type",d);this.Rd&&c.attrs.set("uop_persist",
!0);this.wa.addEvent(a,c)}catch(c){this.j.G(c,{tags:new Map([["user_operation",this.name]])})}}setAttributes(a){this.wa.setAttributes(a)}setAttribute(a,b){this.wa.setAttribute(a,b)}constructor(a,b,c,d,e,f,g){var h=new Set;this.name=a;this.wa=b;this.eventContext=c;this.j=d;this.Rd=e;this.Be=f;this.od=g;this.Mf=h;this.Ld=[];this.lg=[];this.Tf=void 0;this.ended=!1}};var Pq=class{$i({af:a,attributes:b,X:c}){b=b===null||b===void 0?void 0:b.get("sample_rate_override");if(b!=null&&typeof b==="number"){if(b<0||b>1)this.j.error(Error(`Invalid sample rate (${b}) for ${a}`)),b=this.sampleRate;return Math.random()<b}a=this.Ml(c);return a!=null?a:Math.random()<this.sampleRate}constructor(a,b){var c=Nq;this.sampleRate=a;this.j=b;this.Ml=c;this.sampleRate=Math.min(Math.max(0,this.sampleRate),1)}};var bE=class{add(a,b=1){k(isFinite(a));k(b>0);if(this.Ja===0)this.Ja=b,this.$d=this.ae=this.Wb=a,this.de=0;else{this.Ja+=b;const c=a-this.Wb;this.Wb+=b*c/this.Ja;this.de+=b*c*(a-this.Wb);this.ae=Math.min(this.ae,a);this.$d=Math.max(this.$d,a)}}addAll(a){for(const b of a)this.add(b)}get count(){return this.Ja}get Nl(){return this.Wb}get sum(){return this.Ja>0?this.Wb*this.Ja:0}get min(){return this.ae}get max(){return this.$d}get um(){return this.Ja===0?NaN:this.Ja===1?0:Math.max(this.de,0)/this.Ja}get sm(){return Math.sqrt(this.um)}constructor(){this.Ja=
0;this.Wb=NaN;this.de=0;this.$d=this.ae=NaN}};var cE=class{start(){this.xc=new bE;this.Se=void 0;this.vf=this.Ag.requestAnimationFrame(this.Fi);this.document.addEventListener("visibilitychange",this.Ne)}get Zh(){return this.document.visibilityState==="visible"}constructor(){var a=window.document;this.Ag=window;this.document=a;this.xc=new bE;this.Fi=b=>{this.Se!==void 0&&this.xc.add(Math.min(b-this.Se,5E3));this.Se=this.Zh?b:void 0;this.vf=this.Ag.requestAnimationFrame(this.Fi)};this.Ne=()=>{this.Zh||(this.Se=void 0)}}},dE=class{reset(){this.frameCount=
0;this.gi=new bE;this.Vh.clear()}constructor(){this.frameCount=0;this.gi=new bE;this.Vh=new Set}},Oq=new dE;var eE=class{qa(){}process(){}async flush(){}};var fE=class{Td(a,b){return this.startSpan(a,void 0,b)}startSpan(a,b,c){try{var d;const {Ke:e,Le:f}=Aq(c),g=ma(this.za(b),"No instrumentation scope found for '{}' of parent '{}:{}'",a,b===null||b===void 0?void 0:b.za,b===null||b===void 0?void 0:b.spanContext().spanId),h=(f===null||f===void 0?0:(d=f.performance)===null||d===void 0?0:d.Dp)?this.If.frameRate():void 0;h===null||h===void 0||h.start();const l=(f===null||f===void 0?0:f.aj)?Kq({Ga:{...f.aj,startTime:f.startTime,timeout:f.timeout},Sa:this.Zg,
X:b,Vj:[this.config.jf,this.jf].filter(Hd),j:this.j,Yl:r=>{b=r}}):Lq(b),n=new Eq({name:a,X:b,Pa:this.config,lb:this.lb,za:g,j:this.j,getCurrentTime:this.getCurrentTime,startTime:f===null||f===void 0?void 0:f.startTime,timeout:f===null||f===void 0?void 0:f.timeout,Oa:this.Oa,attrs:(f===null||f===void 0?void 0:f.attrs)||e,links:f===null||f===void 0?void 0:f.links,Ba:l,Ca:"span",qb:{frameRate:h}});l!==null&&l!==void 0&&(n.attrs.get("is_uop")||n.setAttribute("user_operation",l.name),l.Rd==null&&(l.Rd=
n.mb(),l.Rd&&l.wa.setAttribute("uop_persist",!0)),l.Mf.add(n));b!=null&&b instanceof Eq&&b.Mc.push(n);return n}catch(e){return this.j.G(e),new TD}}addEvent(a,b){try{const {Ke:c,Le:d}=Aq(b);k(a.length>0,"Event name cannot be empty");const e=ma(this.za(),"Event ({}) requires instrumentation scope",a);new aE({name:a,Pa:this.config,lb:this.lb,za:e,Ba:void 0,j:this.j,Ca:"event",qd:d===null||d===void 0?void 0:d.qd,getCurrentTime:this.getCurrentTime,startTime:d===null||d===void 0?void 0:d.startTime,Oa:this.Oa,
attrs:(d===null||d===void 0?void 0:d.attrs)||c,X:void 0})}catch(c){this.j.G(c)}}async flush(){try{await this.config.Uc.flush()}catch(a){this.j.G(a)}}constructor(a,b,c,d,e,f,g,h=n=>{var r;return(r=n===null||n===void 0?void 0:n.override)!==null&&r!==void 0?r:performance.now()},l={frameRate:()=>new cE}){this.za=a;this.Oa=b;this.config=c;this.lb=d;this.j=e;this.Zg=f;this.jf=g;this.getCurrentTime=h;this.If=l}};var Zq=class{constructor(a){var b;this.Ig=(b=a.Ig)!==null&&b!==void 0?b:new Qq;var c;this.Uc=(c=a.Uc)!==null&&c!==void 0?c:new eE;var d;this.plugins=(d=a.plugins)!==null&&d!==void 0?d:[];var e;this.Na=(e=a.Na)!==null&&e!==void 0?e:new Map;this.jf=a.jf;this.Uh=a.Uh}},$q=class{sd(a){try{return new fE(()=>a,this,this.config,()=>new Map([...this.config.Na,["service.name",this.kn+" | "+a]]),this.j,this.Zg,void 0,this.getCurrentTime,this.If)}catch(c){var b;this.j.G(c,{extra:new Map([["attrs",Object.fromEntries((b=
this.config)===null||b===void 0?void 0:b.Na)]])});return new SD}}constructor(a,b,c=e=>{var f;return(f=e===null||e===void 0?void 0:e.override)!==null&&f!==void 0?f:performance.now()},d={frameRate:()=>new cE}){this.config=a;this.j=b;this.getCurrentTime=c;this.If=d;this.kn=(a=this.config.Na.get("service.name"))&&typeof a==="string"?a:"no_service_name";this.Zg=this.sd("telemetry.user_operation")}};var fr=["themed","themeLight","themeDark","themePreloadModeClassic"];(async()=>{var a=rt.F;let b={};var c=performance.now(),d=ra("base",Ts.F,b),e={start:c,end:performance.now()};d.Ih&&(b={...b,Lj:!0},d=ra("base",Ts.F,b));const f=d.Rm;c=performance.now();a=ra("page",a,{...b,Qm:f});c={start:c,end:performance.now()};({Ea:e}={Ea:{Af:d,sc:a},Xn:{Wn:e,Op:c}});d=e.sc;const {j:g,Zc:h}=await dr({Af:e.Af,ge:d.ge});e=h.sd("app_sandbox_editor").Td("load_page",{aj:{name:"app_sandbox_editor.use_app"}});try{await Bo({j:g})}catch(l){g.ad(l,{L:"Failed to clear site data"})}try{await gr({j:g,
Zc:h,sc:d,Hg:e})}catch(l){e.end("error")}e.end("ok")})();
}).call(self, self._5f74ec40302898c5a55451c9fbd04240);},

/***/ 27972:
(_, __, r) => r(905716)

},
/******/ __webpack_require__ => { // webpackRuntimeModules
/******/ var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
/******/ __webpack_require__.O(0, [28253,98821], () => (__webpack_exec__(905716), __webpack_exec__(27972)));
/******/ var __webpack_exports__ = __webpack_require__.O();
/******/ }
])
//# sourceMappingURL=sourcemaps/133ff317c968b49a.js.map