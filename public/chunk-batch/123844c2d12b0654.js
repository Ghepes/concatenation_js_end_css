;// __FILE_CONTENT_FOR__:123844c2d12b0654.js
(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[378970],{

/***/ 909567:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);self._ebd5e19490e9b70e7436d6c497657170 = self._ebd5e19490e9b70e7436d6c497657170 || {};(function(__c) {var L=__c.L;var H=__c.H;var F$i,H$i,I$i,J$i,K$i,N$i,S$i,O$i,U$i,G$i;F$i=function(a){const b=a.deps.iwh,c=a.deps.$lf,d=a.deps.vQo,e=a.deps.Hif;e.addEventListener("message",f=>{if(f.origin===e.origin&&f.source!=null&&!(f.source instanceof MessagePort||"ServiceWorker"in globalThis&&f.source instanceof globalThis.ServiceWorker))switch(f.data){case a.n9l:const {port1:g,port2:h}=b();c({port:g});f.source.postMessage(a.o9l,e.origin,[h]);break;case a.nXl:d()}})};H$i=function(a,b){a=G$i.serialize(a);return`S:${b}_${a}`};
I$i=function(a){return a?{...a,id:"redacted"}:null};J$i=function(a){if(a.port)for(var b;b=a.mIk.shift();)a.cPd(b)};K$i=function(a,b){if(b)a.port=b,a.port.onmessage=c=>a.n6(c.data),J$i(a);else{a.port=null;for(const [,{resolve:c}]of a.G7c)c();a.G7c.clear()}};
N$i=function(a,b,c){const d=b.message,e=b.vrn,f=b.ea,g=b.Dyl;var h;const k=(h=f===null||f===void 0?void 0:f.timeout)!==null&&h!==void 0?h:a.timeout,l=setTimeout(()=>{const n=new L$i(d,c,k);a.onError(n);e.reject(n);a.G7c.delete(c.id)},k);a.G7c.set(c.id,{message:d,meta:c,resolve:()=>{clearTimeout(l);e.resolve();a.G7c.delete(c.id);g===null||g===void 0||g.end()},reject:n=>{clearTimeout(l);e.reject(n);a.G7c.delete(c.id);n=n instanceof __c.M$i?n.category:"unknown";g===null||g===void 0||g.end("error",new Map([["error",
n]]))},abort:()=>{clearTimeout(l);e.reject("Message aborted");a.G7c.delete(c.id);g===null||g===void 0||g.abort()}})};
S$i=function(a,b){var c=O$i(()=>P$i.deserialize(b),()=>{const f=new Q$i(b,null,"Failed to deserialize TransportMessage");a.Ywe(new R$i({$Kd:""}));a.onError(f)});if(c)if(c.type!=="POST")a.e0c(c);else{var d=c.payload?JSON.parse(c.payload):void 0,e={id:c.id,options:c.options};if(c=O$i(()=>a.deserializer(d),()=>{const f=new Q$i(d,e,"Failed to deserialize message payload");a.Ywe(new R$i({$Kd:e.id}));a.onError(f)}))return{message:c,meta:e}}};O$i=function(a,b){try{return a()}catch(c){b(c)}};
U$i=function(a){if(a instanceof Error||a instanceof T$i||a instanceof Q$i||a instanceof L$i)throw a;throw Error("An unknown error occurred");};
__c.X$i=function({key:a,serialize:b,deserialize:c,za:d,onError:e,$lf:f,bIr:g}){d=d===null||d===void 0?void 0:d.qd("services.web_cross_frame");const h=new V$i({serialize:b,deserialize:c,onError:e,timeout:g,da:d,key:a,source:"parent"});F$i(new W$i({key:a,iwh:()=>new MessageChannel,$lf:({port:k})=>{K$i(h,k);f===null||f===void 0||f()},vQo:()=>{K$i(h,null)},Hif:window}));return{xfa:h}};G$i=__c.K(()=>[0,1,2,4,6,5,7,8,9,10,11]);var W$i=class{constructor(a){this.deps=a;this.nXl=H$i(this.deps.key,"DISCONNECT_REQUEST");this.n9l=H$i(this.deps.key,"GET_MESSAGE_PORT_REQUEST");this.o9l=H$i(this.deps.key,"GET_MESSAGE_PORT_RESPONSE")}};var T$i,Q$i,L$i;__c.M$i=class extends Error{constructor(a,b,c){super(c);this.oMn=a;var d;if(a&&typeof a==="object"){var e;a="type"in a?(e=(d=a.type)===null||d===void 0?void 0:d.toString())!==null&&e!==void 0?e:"UNKNOWN":"UNKNOWN"}else a="UNKNOWN";this.r7j=a;this.pMn=b}};T$i=class extends __c.M$i{constructor(a,b){const c=`Unhandled message received:
    ${JSON.stringify(a,null,2)}

    Transport meta:
    ${JSON.stringify(I$i(b),null,2)}`;super(a,b,c);this.category="unhandled"}};Q$i=class extends __c.M$i{constructor(a,b,c=""){c=`Compatability error:
      ${c?`${c}\n`:""}
      Received:
      ${JSON.stringify(a,null,2)}

      Transport meta:
      ${JSON.stringify(I$i(b),null,2)}`;super(a,b,c);this.category="compat"}};L$i=class extends __c.M$i{constructor(a,b,c){c=`Sent message timeout exceeded (${c/1E3}s):
    ${JSON.stringify(a,null,2)}

    Transport meta:
    ${JSON.stringify(I$i(b),null,2)}`;super(a,b,c);this.category="timeout"}};var Y$i=H(()=>({wvf:__c.ic(1)}));var Z$i=H(()=>({type:__c.z("A?",4,"UNHANDLED_ERROR"),$Kd:L(1)}));var $$i=H(()=>({type:__c.z("A?",2,"ACK"),$Kd:L(1)}));var aaj=H(()=>({type:__c.z("A?",1,"POST"),id:L(1),options:__c.C(2,Y$i),payload:L(3)}));var R$i=H(()=>({type:__c.z("A?",3,"COMPATIBILITY_ERROR"),$Kd:L(1)}));var P$i=__c.Ta(()=>({type:[1,aaj,2,$$i,3,R$i,4,Z$i]}),()=>({}));var V$i=class{addListener(a,b){const c=this.OJ[a]||[];c.push(b);this.OJ[a]=c}removeListener(a,b){const c=this.OJ[a];if(c){var d=c.findIndex(e=>e===b);d>-1&&c.splice(d,1);c.length===0?delete this.OJ[a]:this.OJ[a]=c}}async postMessage(a,b){var c,d;const e=(d=b===null||b===void 0?void 0:b.enqueue)!==null&&d!==void 0?d:!0;var f;d=(f=b===null||b===void 0?void 0:b.wvf)!==null&&f!==void 0?f:!1;f=b===null||b===void 0?void 0:b.timeout;b=(c=this.da)===null||c===void 0?void 0:c.Ec(`web_cross_frame.message.${this.NZm}.${this.source}`,
new Map([["message_type",a.type]]));c=Promise.withResolvers();a={message:a,vrn:c,ea:{wvf:d,timeout:f},Dyl:b};if(this.port)return this.cPd(a),c.promise;e?(b===null||b===void 0||b.addEvent("enqueue"),this.mIk.push(a)):b===null||b===void 0||b.abort()}cPd(a){var b;if(!this.port)throw Error("No message port set. Have you called setPort()?");var c=a.ea,d;c={id:__c.Wa(),options:new Y$i({wvf:(d=c===null||c===void 0?void 0:c.wvf)!==null&&d!==void 0?d:!1})};N$i(this,a,c);(b=a.Dyl)===null||b===void 0||b.addEvent("send");
b=this.port;d=b.postMessage;a:{try{const f=this.serializer(a.message),g=JSON.stringify(f),h=new aaj({payload:g,...c});var e=P$i.serialize(h);break a}catch(f){this.onError(f)}e=void 0}d.call(b,e)}n6(a){if(a=S$i(this,a)){var b=a.message,c=a.meta,d;a=(d=this.OJ[b.type])!==null&&d!==void 0?d:[];!a.length&&c.options.wvf?(d=new T$i(b,c),this.Ywe(new Z$i({$Kd:c.id})),this.onError(d)):(this.Ywe(new $$i({$Kd:c.id})),a.forEach(e=>{try{e(b,c)}catch(f){this.onError(f)}}))}}Ywe(a){if(!this.port)throw Error("No message port set. Have you called setPort()?");
this.port.postMessage(P$i.serialize(a))}e0c(a){var b=this.G7c.get(a.$Kd);switch(a.type){case "ACK":if(!b)throw Error("Unexpected confirmation for message");b.resolve();break;case "COMPATIBILITY_ERROR":if(b){a=new Q$i(b.message,b.meta,"Received compatibility error");b.reject(a);this.onError(a);break}b=new Q$i(a,null,"Received compatibility error");this.onError(b);break;case "UNHANDLED_ERROR":if(b){a=new T$i(b.message,b.meta);b.reject(a);this.onError(a);break}b=new T$i(a,null);this.onError(b);break;
default:this.onError(Error("Unknown response type"))}}constructor(a){this.OJ={};this.mIk=[];this.G7c=new Map;this.port=null;this.serializer=a.serialize;this.deserializer=a.deserialize;this.onError=a.onError||U$i;this.timeout=a.timeout||5E3;this.da=a.da;this.NZm=G$i.serialize(a.key);this.source=a.source}};
}).call(self, self._ebd5e19490e9b70e7436d6c497657170);}

}])
//# sourceMappingURL=https://chunk-composing.canva.com/chunk-batch-sm/32_sourcemaps/123844c2d12b0654.js.map