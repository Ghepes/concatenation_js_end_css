(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[579581],{

/***/ 960817:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(301439);__web_req__(439176);self._ebd5e19490e9b70e7436d6c497657170 = self._ebd5e19490e9b70e7436d6c497657170 || {};(function(__c) {var ozb,qzb,rzb,tzb,vzb,yzb,Azb,Bzb,Czb,Dzb,Fzb,Jzb,zzb,Ezb,Kzb,pzb;ozb=function(a,b,c){if(a.connection==null)throw Error("Attempted to open a transaction on a closed connection");self.clearTimeout(a.GZf);a.GZf=void 0;const d=a.connection;try{a.Zyi++;const e=d.transaction(b,c),f=e.wsb;f.catch(()=>a.dispose()).finally(()=>{a.Zyi--;a.Zyi<=0&&(a.GZf=self.setTimeout(()=>{a.dispose()},2500))});return{transaction:e,Tpc:f}}catch(e){throw a.dispose(),e;}};
qzb=async function(a,{xa:b}){var c;const d=b!=null?(c=a.da)===null||c===void 0?void 0:c.startSpan("idb_connection_manager.open_idb_connection",b):void 0,e=pzb.open(a.s4h,()=>{a.connection===e&&(a.connection=void 0)}).catch(f=>{a.connection=void 0;d===null||d===void 0||d.setStatus("error");throw f;}).finally(()=>d===null||d===void 0?void 0:d.end());return e};
rzb=async function(a,b,{xa:c}){var d;const e=c!=null?(d=a.da)===null||d===void 0?void 0:d.startSpan("idb_connection_manager.get_connection",c):void 0;try{if(a.connection==null||(b===null||b===void 0?0:b.eVn))a.connection=qzb(a,{xa:c});let f=await a.connection;f.isOpen||(a.connection=qzb(a,{xa:c}),f=await a.connection);return f}catch(f){throw e===null||e===void 0||e.setStatus("error"),f;}finally{e===null||e===void 0||e.end()}};
tzb=function(a){return a.name==="QuotaExceededError"||a instanceof DOMException&&a.code===22?!0:szb.some(b=>b.test(a.message))};vzb=function(a){return!self.indexedDB||a instanceof __c.Evb||a instanceof DOMException&&["AbortError","TransactionInactiveError"].includes(a.name)?!0:uzb.some(b=>b.test(a.message))};
yzb=function({s4h:a,da:b}){return new wzb(new xzb(a,b),b!=null?{YBo:({methodName:c})=>{if(!(b==null||Math.random()>.01))return b.Ec(`storage_layer.idb_database_manager.execute.${c}`,{attrs:new Map([["sample_rate_override",1]]),timeout:3E5})}}:void 0)};Azb=async function(a){if(a.BWb!=null)switch(a=await a.BWb.getStatus(),a){case 1:case 2:break;case 3:case void 0:throw new zzb;default:throw new __c.t(a);}};Bzb=function(a,b){return{key:a,record:b}};
Czb=function(a){if(typeof a!=="object"||a==null)throw Error("Result is not an object");a=a.key;if(typeof a!=="string")throw Error("Key is not a string");return a};Dzb=function(a){if(typeof a!=="object"||a==null)throw Error("Result is not an object");a=a.record;if(a==null)throw Error("Value is undefined");return a};
Fzb=async function(a){try{return(0,__c.Ea)(await __c.Lvb.open({name:a.RZ,version:1,KId:b=>{b=b.createObjectStore(a.RZ,{keyPath:"key"});if(a.gfa!=null&&a.gfa.length>0)for(const {name:c,Plb:d,...e}of a.gfa)b.createIndex(c,`${"record"}.${d}`,e)},dld:{type:1,jnd:!0,knd:!0}}))}catch(b){return(0,__c.Ga)(new Ezb(b instanceof Error?b:Error(String(b))))}};__c.Izb=function({RZ:a,serializer:b,BWb:c,gfa:d=[],da:e}){return new Gzb(a,b,yzb({s4h:new Hzb(a,d),da:e}),c)};
Jzb=class extends Error{constructor(a){super("Quota exceeded");this.cause=a}};zzb=class extends Error{constructor(){super("Consent required")}};Ezb=class extends __c.$ba{constructor(a){super("IndexedDb Database Error",0);this.cause=a}};Kzb=class extends Error{constructor(){super("Maximum number of rows exceeded for put request")}};
pzb=class{static async open(a,b){a=await Fzb(a);if(!a.ok)throw a.error;const c=a.value,d=()=>{e.connection=void 0;c.removeEventListener("close",d)};c.addEventListener("close",d,{once:!0});const e=new pzb({transaction:(f,g)=>c.transaction(f,g),close:()=>{d();c.close();b()}});e.GZf=self.setTimeout(()=>{e.dispose()},2500);return e}get isOpen(){return this.connection!=null}dispose(){var a;(a=this.connection)===null||a===void 0||a.close();this.connection=void 0;self.clearTimeout(this.GZf)}constructor(a){this.connection=
a;this.Zyi=0}};var xzb=class{constructor(a,b){this.s4h=a;this.da=b}};var szb=[/Encountered full disk while opening backing store for indexedDB.open./i,/Failed to PutOrAdd in database because not enough space for domain/i],uzb=[/(transaction|operation) was aborted/i,/The database connection is closing/i,/connection to indexed database server lost/i,/internal error/i,/the transaction is inactive or finished/i,/unable to open database file on disk/i,/without an in-progress transaction/i,/The user denied permission to access the database\./];var wzb=class{async Gaa({poc:a,mode:b,methodName:c},d){var e;const f=(e=this.da)===null||e===void 0?void 0:e.YBo({methodName:c});try{try{const h=ozb(await rzb(this.Sok,{},{xa:f}),a,b),[k]=await Promise.all([this.executeCallback({transaction:h.transaction,callback:d}),h.Tpc]);return k}catch(h){const k=ozb(await rzb(this.Sok,{eVn:!0},{xa:f}),a,b),[l]=await Promise.all([this.executeCallback({transaction:k.transaction,callback:d}),k.Tpc]);return l}}catch(h){const k=h instanceof Error?h:Error(String(h));
var g=k instanceof Ezb||k instanceof Jzb?k:tzb(k)?new Jzb(k):vzb(k)?new Ezb(k):k;g instanceof zzb||g instanceof __c.nzb||g instanceof Kzb||g instanceof Jzb||(f===null||f===void 0||f.setAttribute("error",h instanceof Error?h.message:String(h)),f===null||f===void 0||f.end("error"));throw g;}finally{f===null||f===void 0||f.end("ok")}}async executeCallback({transaction:a,callback:b}){try{const d=await b(a);try{var c;a===null||a===void 0||(c=a.commit)===null||c===void 0||c.call(a)}catch(e){}return d}catch(d){try{a===
null||a===void 0||a.abort()}catch(e){}throw d;}}constructor(a,b){this.Sok=a;this.da=b}};var Gzb=class{async put(a,b,c){await Azb(this);const d=Bzb(a,this.serializer.serialize(b));return this.$gc.Gaa({poc:this.RZ,mode:"readwrite",methodName:"put"},async e=>{e=e.objectStore(this.RZ);const {Ebs:f}=c!==null&&c!==void 0?c:{};if(f!=null){__c.pa(f>0);const [g,h]=await Promise.all([e.get(a).then(k=>!!k),e.count()]);if(h+(g?0:1)>f)throw new Kzb;}await e.put(d)})}async get(a){const b=await this.$gc.Gaa({poc:this.RZ,mode:"readonly",methodName:"get"},async c=>c.objectStore(this.RZ).get(a));return b!=
null?this.deserialize(Dzb(b)):void 0}async delete(a){return this.$gc.Gaa({poc:this.RZ,mode:"readwrite",methodName:"delete"},async b=>{const c=b.objectStore(this.RZ);Array.isArray(a)?await Promise.all(a.map(d=>c.delete(d))):await c.delete(a)})}async count(){return this.$gc.Gaa({poc:this.RZ,mode:"readonly",methodName:"count"},async a=>a.objectStore(this.RZ).count())}async update(a,b){await Azb(this);return this.$gc.Gaa({poc:this.RZ,mode:"readwrite",methodName:"update"},async c=>{c=c.objectStore(this.RZ);
var d=await c.get(a);d=d?{value:this.deserialize(Dzb(d))}:void 0;d=b(d);d!=null?await c.put(Bzb(a,this.serializer.serialize(d.value))):await c.delete(a)})}async Ubj(a,b){await Azb(this);return this.$gc.Gaa({poc:this.RZ,mode:"readwrite",methodName:"updateMany"},async c=>{const d=c.objectStore(this.RZ);await Promise.all(a.map(async e=>{var f=await d.get(e);f=f?{value:this.deserialize(Dzb(f))}:void 0;f=b(f,e);f!=null?await d.put(Bzb(e,this.serializer.serialize(f.value))):await d.delete(e)}))})}async updateAll(a,
b,c){await Azb(this);return this.$gc.Gaa({poc:this.RZ,mode:"readwrite",methodName:"updateAll"},async d=>{const e=d.objectStore(this.RZ);d=await (typeof c==="string"?e.index(c):e).getAll(b);await Promise.all(d.map(async f=>{const g=Czb(f);f=this.deserialize(Dzb(f));f=a({value:f},g);f!=null?await e.put(Bzb(g,this.serializer.serialize(f.value))):await e.delete(g)}))})}async getAll(a,b){const c=await this.$gc.Gaa({poc:this.RZ,mode:"readonly",methodName:"getAll"},async f=>{f=f.objectStore(this.RZ);const g=
typeof b==="string"?f.index(b):f;try{return(await g.getAll(a)).map(h=>(0,__c.Ea)(h))}catch(h){return f=await g.getAllKeys(a),Promise.all(f.map(async k=>{try{const l=await g.get(k);return(0,__c.Ea)(l)}catch(l){return(0,__c.Ga)({key:String(k),error:l instanceof Error?l:Error(String(l))})}}))}}),d=[],e=[];for(const f of c)if(f.ok)try{d.push({key:Czb(f.value),Wj:this.deserialize(Dzb(f.value))})}catch(g){e.push({key:Czb(f.value),error:g instanceof Error?g:Error(String(g))})}else e.push({key:f.error.key,
error:f.error.error});return{items:d,errors:e}}async getAllKeys(){return this.$gc.Gaa({poc:this.RZ,mode:"readonly",methodName:"getAllKeys"},async a=>(await a.objectStore(this.RZ).getAllKeys()).map(b=>String(b))||[])}async clear(){return this.$gc.Gaa({poc:this.RZ,mode:"readwrite",methodName:"clear"},async a=>a.objectStore(this.RZ).clear())}close(){}deserialize(a){try{return this.serializer.deserialize(a)}catch(b){throw new __c.nzb(b instanceof Error?b:Error(String(b)));}}constructor(a,b,c,d){this.RZ=
a;this.serializer=b;this.$gc=c;this.BWb=d}};var Hzb=class{constructor(a,b){this.RZ=a;this.gfa=b}};
}).call(self, self._ebd5e19490e9b70e7436d6c497657170);}

}])
//# sourceMappingURL=sourcemaps/05681e85888e1526.js.map