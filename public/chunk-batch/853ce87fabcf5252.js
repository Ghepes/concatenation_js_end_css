(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[766056],{

/***/ 608051:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(905716);__web_req__(157643);__web_req__(992559);self._ebd5e19490e9b70e7436d6c497657170 = self._ebd5e19490e9b70e7436d6c497657170 || {};(function(__c) {var Ma=__c.Ma;var K=__c.K;var z=__c.z;var E=__c.E;var M=__c.M;var L=__c.L;var H=__c.H;var tb=__c.tb;var m=__c.m;var Wa=__c.Wa;var eb=__c.eb;var qc=__c.qc;var t=__c.t;var Tvb,Xvb,Zvb,$vb,cwb,ewb,gwb,hwb,mwb,nwb,owb,pwb,qwb,rwb,uwb,swb,twb,Cwb,Ewb,Gwb,Hwb,Jwb,Iwb,Mwb,Owb,Nwb,Qwb,Pwb,Swb,Rwb,Twb,Zwb,axb,cxb,bxb,gxb,jxb;__c.Svb=async function(a){return await (new Qvb(a)).getCapabilities(new __c.Rvb)};Tvb=function(a,b){a.xBc=b};
Xvb=async function(a,b){if(a.xBc){try{var c=JSON.parse(b.Vzb)}catch(d){a.postMessage(new Uvb({requestId:b.id,content:new Vvb({gh:1,message:"Failed to parse request data"})}));return}try{const d=await a.xBc(c);a.postMessage(new Uvb({requestId:b.id,content:new Wvb({Vzb:JSON.stringify(d)})}))}catch(d){a.postMessage(new Uvb({requestId:b.id,content:new Vvb({gh:1})}))}}else a.postMessage(new Uvb({requestId:b.id,content:new Vvb({gh:1,message:"No request handler has been set"})}))};
Zvb=async function(a){const b=a.deps.Xfn,c=a.deps.delay,d=a.deps.Hif;a=new Promise((e,f)=>{const g=h=>{const k=h.data==="GET_MESSAGE_PORT_RESPONSE";if(h.origin===d.origin&&k){h=h.ports[0];if(h==null)return f(Error("`event.ports` is empty"));e(b(h));d.removeEventListener("message",g)}};d.addEventListener("message",g)});d.parent.postMessage("GET_MESSAGE_PORT_REQUEST",d.origin);return await Promise.race([a,c(3E4).then(()=>{throw new Yvb;})])};
$vb=function(a){const b=a.deps.iwh,c=a.deps.jhg,d=a.deps.Hif;d.addEventListener("message",e=>{const f=e.source==null,g=e.source instanceof MessagePort||e.source instanceof ServiceWorker,h=e.data==="GET_MESSAGE_PORT_REQUEST";if(e.origin===d.origin&&!f&&!g&&h){var {port1:k,port2:l}=b();c({port:k});e.source.postMessage("GET_MESSAGE_PORT_RESPONSE",d.origin,[l])}})};cwb=async function(a,b){b=awb.serialize(b);a=await a.Gpa.send(b,a.timeoutMs);return bwb.deserialize(a)};
ewb=function(a,b){b=b[a.Bvb];if(b==null)throw new dwb(`Expected raw message to have data value for key '${a.Bvb}'.`);if(typeof b!=="object")throw Error(`Expected data value to be an 'object'; received a '${typeof b}'`);return b};
gwb=function(a,{zj:b,error:c,gh:d}){var e;d===4||d===6||(e=a.errorService)!==null&&e!==void 0&&e.ia(c,{tags:new Map([["requestId",b.id],["serviceName",b.wb],["methodName",b.methodName]])});return{ZT:new fwb({requestId:b.id,errorMessage:c instanceof Error?c.message:"Failed to execute method.",gh:d}),data:{}}};
hwb=async function(a,{zj:b,data:c}){var d=a.store.aki.get(b.wb);if(d==null)return gwb(a,{zj:b,error:Error(`Service "${b.wb}" not found.`),gh:6});d=d.get(b.methodName);if(d==null)return gwb(a,{zj:b,error:Error(`Method "${b.methodName}" not found on service "${b.wb}".`),gh:4});if(d.type!=null&&d.type!==2)return gwb(a,{zj:b,error:Error(`Method "${b.methodName}" is not a request/response method.`),gh:4});let e;try{e=d.osn(c)}catch(g){return gwb(a,{zj:b,error:g,gh:5})}let f;try{f=await d.uIk(e)}catch(g){return gwb(a,
{zj:b,error:g,gh:3})}try{return{ZT:new fwb({requestId:b.id}),data:d.ktp(f)}}catch(g){return gwb(a,{zj:b,error:g,gh:5})}};
mwb=function(a,{zj:b,yep:c,EDi:d}){const e=a.Lxa;__c.qa(e!=null,"Expected `rxjs` to be defined.");const f=a.store.aki.get(b.wb);if(f==null)return new iwb({requestId:b.id,code:4,message:`Service "${b.wb}" not found.`});const g=f.get(b.methodName);if(g==null)return new iwb({requestId:b.id,code:2,message:`Method "${b.methodName}" not found on service "${b.wb}".`});if(g.type!==1)return new iwb({requestId:b.id,code:5,message:`Method "${b.methodName}" is not a channel-based method.`});let h;try{h=g.x6q(ewb(b,
c))}catch(q){return new iwb({requestId:b.id,code:3,message:q instanceof dwb?`Expected data to exist under property name "${b.Bvb}".`:"Failed to deserialize the initial request."})}let k,l;try{k=new e.Subject,l=g.uIk(h,k)}catch(q){var n;(n=a.errorService)===null||n===void 0||n.ia(q,{tags:new Map([["requestId",b.id],["serviceName",b.wb],["methodName",b.methodName]])});return new iwb({requestId:b.id,code:1,message:q instanceof Error?q.message:"An unknown error occurred while executing the method handler."})}const p=
a.iTb();a.store.channels.set(p,{j9e:(q,r)=>{switch(q.type){case "CHANNEL_PAYLOAD_MESSAGE":try{k.next(g.w6q(ewb(q,r)))}catch(u){a.store.channels.delete(p),d(new jwb({nx:p,source:2,code:2,message:u instanceof dwb?`Expected data to exist under property name: ${q.Bvb}.`:"Failed to deserialize payload."})),k.error(Error("Failed to deserialize inbound payload."))}break;case "CHANNEL_COMPLETE_MESSAGE":a.store.channels.delete(p);k.complete();break;case "CHANNEL_ERROR_MESSAGE":a.store.channels.delete(p);k.error(Error(q.message));
break;default:throw new t(q);}}});l.subscribe({next:q=>d(new kwb({nx:p,source:2}),g.m4r(q)),complete:()=>d(new lwb({nx:p,source:2})),error:q=>{a.store.channels.delete(p);d(new jwb({nx:p,source:2,code:4,message:q instanceof Error?q.message:"An unknown error occurred."}));k.error(Error("Connection terminated."))}});return new iwb({requestId:b.id,nx:p})};
nwb=function(a,{message:b,O8c:c,EDi:d}){a=a.store.channels.get(b.nx);a==null?d(new jwb({nx:b.nx,source:2,code:3,message:`Received ${b.type} with unrecognized channel ID: ${b.nx}`})):a.j9e(b,c)};owb=function({data:a,origin:b}){return{type:"PROXIED_CLIENT_MESSAGE",data:a,origin:b}};pwb=function({data:a,target:b}){return{type:"PROXIED_SERVER_MESSAGE",data:a,target:b}};
qwb=async function(a,b,c){try{const d=ewb(b,c),e=await hwb(a.deps.Jx,{zj:b,data:d});a.postMessage(e.ZT,e.data)}catch(d){a.postMessage(new fwb({requestId:b.id,errorMessage:d instanceof Error?d.message:"Failed to handle request.",gh:d instanceof dwb?5:3}),{}),a.deps.errorService.ia(d,{tags:new Map([["requestId",b.id],["serviceName",b.wb],["methodName",b.methodName]])})}};
rwb=async function(a,b,c,d,e){const f=a.deps.errorService,g=a.deps.store;let h;try{const k=await new Promise((l,n)=>{g.Pqf.set(b.id,{zj:b,resolve:l,reject:n});a.postMessage(b,c)});if(k.code!=null)throw Error(k.message);if(k.nx==null)throw Error("expected channel id to exist");h=k.nx}catch(k){f.ia(k);e.error(k);return}finally{g.Pqf.delete(b.id)}g.channels.set(h,{j9e:(k,l)=>{switch(k.type){case "CHANNEL_PAYLOAD_MESSAGE":try{const n=ewb(k,l);e.next(n)}catch(n){a.postMessage(new jwb({nx:h,code:2,message:n instanceof
dwb?"Expected data to exist.":"Failed to deserialize payload.",source:1})),g.channels.delete(h),e.error(Error("an invalid payload was received from the server"))}break;case "CHANNEL_COMPLETE_MESSAGE":g.channels.delete(h);e.complete();break;case "CHANNEL_ERROR_MESSAGE":g.channels.delete(h);e.error(Error(k.message));break;default:throw new t(k);}}});d.subscribe({next:k=>void a.postMessage(new kwb({nx:h,source:1}),k),complete:()=>void a.postMessage(new lwb({nx:h,source:1})),error:k=>{a.deps.errorService.ia(k);
a.postMessage(new jwb({nx:h,source:1,code:4,message:k instanceof Error?k.message:"An unknown error occurred."}));g.channels.delete(h);e.error(Error("the connection was terminated, due to an error"))}})};uwb=async function(a,b){await a.deps.delay(500);await swb(a);throw new qc({requestId:b,type:twb(2),TOc:2,methodName:"healthcheck",message:"Timeout reached (500 ms) before receiving a response."});};swb=function(a){return new Promise(b=>a.deps.scheduler.requestIdleCallback(b))};
twb=function(a){switch(a){case 2:case 1:return 2;case 7:return 1;case 6:return 3;case 4:return 4;case 5:case 3:return 5;default:throw new t(a);}};
Cwb=async function({I5j:a,errorService:b,p5b:c,Lxa:d}){const e=await Zvb(new vwb({Xfn:l=>new wwb(l),delay:eb,Hif:window})),f=new __c.xwb(Wa);var g;const h={requestIdleCallback:(g=window.requestIdleCallback)!==null&&g!==void 0?g:window.setTimeout},k=l=>void c.next(l);a=(a?()=>new ywb({delay:eb,Jx:f,errorService:b,mAc:Wa,wwk:()=>!0,FLa:e,glk:k,Lxa:d,scheduler:h,sessionId:Wa(),store:new zwb}):()=>{const l=new Awb(new Bwb(e,new __c.Lj("web:iframe:"),864E5),f);l.init();return l})();return{Jx:f,FLa:e,Gpa:a}};
Ewb=function({jhg:a}){return new Dwb({iwh:()=>new MessageChannel,Hif:window,jhg:a})};Gwb=function({r3m:a,A$m:b}){$vb(b({jhg:({port:c})=>(new Fwb(new Bwb(new wwb(c),new __c.Lj("web:iframe-proxy-server:"),5E3),a)).init()}))};Hwb=function(a){const b=a.ElectronBridge;return typeof b!=="undefined"&&typeof b.requestMessagePort==="function"?c=>{__c.qa(typeof b!=="undefined"&&typeof b.requestMessagePort==="function");b.requestMessagePort(c)}:void 0};
Jwb=async function(a,b){a=await Iwb(window,a,b);if(a!=null)return a;throw Error("failed to install a host RPC client");};
Iwb=async function(a,b,c,d=0,e=4){if(!(d>=e)){if(Hwb(a)!=null)return d=new __c.xwb(Wa,b,c),{FLa:e}=await (new Kwb({Yfn:f=>new wwb(f),mAc:Wa,delay:eb,window:a})).h$f(),b=new ywb({delay:eb,Jx:d,errorService:b,mAc:Wa,wwk:()=>a.document.visibilityState==="visible",FLa:e,Lxa:c,scheduler:a,sessionId:Wa(),store:new zwb}),b.postMessage(new Lwb),{Jx:d,FLa:e,Gpa:b};d+=1;await eb(1E3*Math.pow(d,2));return Iwb(a,b,c,d,e)}};
Mwb=function(a){const b=a.AndroidBridge;return typeof b!=="undefined"&&typeof b.requestMessagePort==="function"?c=>{__c.qa(typeof b!=="undefined"&&typeof b.requestMessagePort==="function");return b.requestMessagePort(c)}:void 0};
Owb=async function(a,b=0){try{const c=a.deps.mAc,d=a.deps.delay,e=m(Mwb(a.deps.window)),f=c(),g=Nwb(a,f),h=e(f);return await Promise.race([g,d(h!==null&&h!==void 0?h:5E3).then(()=>{var k;(k=a.eHg)===null||k===void 0||k.call(a);throw Error(`Establish connection timeout (${a.$Ki}).`);})])}catch(c){if(b<1)return Owb(a,b+1);throw c;}};
Nwb=async function(a,b){const c=a.deps.window;a.$Ki="waiting-for-message-port";const d=await new Promise((e,f)=>{const g=h=>{h.data===b&&(m(a.eHg)(),h.ports.length!==1?f(Error("Expected reply from native to include a port, but it does not.")):e(h.ports[0]))};c.addEventListener("message",g);a.eHg=()=>{a.eHg=void 0;c.removeEventListener("message",g)}});a.$Ki="performing-handshake";await new Promise((e,f)=>{d.onmessage=g=>{g.data==="SYN-ACK"?(d.onmessage=null,d.postMessage("ACK"),e(d)):f(Error("Unexpected response to a handshake sequence."))};
d.postMessage("SYN")});a.$Ki="completed";return d};Qwb=function(a=window){return Pwb(a)!=null};Pwb=function(a){a=a.webkit;return typeof a!=="undefined"&&typeof a.messageHandlers!=="undefined"&&typeof a.messageHandlers.iosBridge!=="undefined"&&typeof a.messageHandlers.iosBridge.postMessage==="function"?a.messageHandlers.iosBridge:void 0};Swb=async function(a,b){a=await Rwb(a,b);if(a!=null)return a;throw Error("failed to install a host RPC client");};
Rwb=async function(a,b,c=0,d=4){const e=await Twb(a,b);if(e!=null)return e;if(c!==d)return await eb(1E3*Math.pow(c,2)),Rwb(a,b,c+1,d)};
Twb=async function(a,b){var c=Mwb(window)!=null?new Uwb({delay:eb,U7m:e=>new Vwb(e),mAc:Wa,window}):Qwb(window)?new Wwb({cen:e=>new Xwb({errorService:a,qDo:e}),window}):void 0;if(c!=null){({FLa:c}=await c.h$f());var d=new zwb;b=new ywb({delay:eb,Jx:new __c.xwb(Wa,a,b),errorService:a,mAc:Wa,wwk:()=>window.document.visibilityState==="visible",FLa:c,Lxa:b,scheduler:window.requestIdleCallback!=null?window:{requestIdleCallback:window.setTimeout},sessionId:Wa(),store:d});b.postMessage(new Lwb);return{FLa:c,
Gpa:b}}};Zwb=function({Ksh:a,lyh:b,vMb:c,jse:d,p5b:e,Lxa:f,jLg:g,iTb:h}){g.subscribe(k=>void Ywb({Ksh:a,lyh:b,vMb:c,jse:d,p5b:e,Lxa:f,mtp:k,iTb:h}))};
axb=function({h5n:a,vMb:b,p5b:c,request:d,requestData:e,Lxa:f,HGp:g,target:h,iTb:k}){var l;const n=m((l=b.requestChannel)===null||l===void 0?void 0:l.bind(b)),p=k();b=new f.Subject;e=n(d.wb,d.methodName,e,b);g({nx:p,TSe:b});e.subscribe({complete:()=>{var q=new lwb({nx:p,source:2});q=JSON.stringify($wb.serialize(q));a(q)},error:q=>{q=new jwb({nx:p,code:4,message:q.message,source:2});q=JSON.stringify($wb.serialize(q));a(q)},next:q=>{const r=new kwb({nx:p,source:2});q=JSON.stringify({...$wb.serialize(r),
[r.Bvb]:q});a(q)}});c.next(pwb({data:JSON.stringify($wb.serialize(new iwb({nx:p,requestId:d.id}))),target:h}))};cxb=async function({g5n:a,vMb:b,request:c,requestData:d}){b=await bxb({vMb:b,method:c.methodName,Ru:c.wb,requestData:d});d=b.ok?void 0:b.error instanceof Error?b.error.message:String(b.error);c=new fwb({requestId:c.id,...(d?{errorMessage:d,gh:3}:void 0)});c=JSON.stringify({...$wb.serialize(c),[c.Bvb]:b.ok?b.value:void 0});a(c)};
bxb=async function({vMb:a,method:b,Ru:c,requestData:d}){try{const e=await a.exec(c,b,d);return(0,__c.Ea)(e)}catch(e){return(0,__c.Ga)(e)}};
__c.hxb=async function({ZIh:a,errorService:b,runtime:c,Lxa:d}){const e=new dxb,f=new dxb;switch(c){case tb.BROWSER:return{runtime:c,Ha:void 0,Jx:void 0,Te:void 0};case tb.Zma:const {Jx:g,FLa:h,Gpa:k}=await (exb?Jwb(b,d):Cwb({I5j:fxb,errorService:b,p5b:e,Lxa:d}));b=(await __c.Svb(k)).I;a&&gxb({vMb:k,jse:p=>void h.postMessage(JSON.parse(p)),p5b:e,Lxa:d,jLg:f,iTb:Wa});return{Ha:b,Jx:g,Te:k,runtime:c};case tb.NE:const {FLa:l,Gpa:n}=await (exb?Swb(b,d):Cwb({I5j:fxb,errorService:b,p5b:e,Lxa:d}));b=(await __c.Svb(n)).I;
a&&gxb({vMb:n,jse:p=>void l.postMessage(JSON.parse(p)),p5b:e,Lxa:d,jLg:f,iTb:Wa});return{Ha:b,Jx:void 0,Te:n,runtime:c};default:throw new t(c);}};
gxb=function({vMb:a,jse:b,p5b:c,Lxa:d,jLg:e,iTb:f}){fxb?($vb(Ewb({jhg:({port:g})=>{const h=f();g.addEventListener("message",k=>void e.next(JSON.stringify(owb({data:JSON.stringify(k.data),origin:h}))));c.subscribe(k=>{k.target===h&&(k=JSON.parse(k.data),g.postMessage(k))});g.start()}})),Zwb({Ksh:{channels:new Map},lyh:exb,vMb:a,jse:b,p5b:c,Lxa:d,jLg:e,iTb:f})):Gwb({r3m:a,A$m:Ewb})};
__c.ixb=async function({errorService:a,runtime:b,Lxa:c}){switch(b){case tb.BROWSER:return{runtime:b,Ha:void 0,Jx:void 0,Te:void 0};case tb.Zma:a=await Iwb(window,a,c,0,1);if(a==null)break;c=(await __c.Svb(a.Gpa)).I;return{runtime:b,Ha:c,Jx:a.Jx,Te:a.Gpa};case tb.NE:a=await Twb(a,c);if(a==null)break;c=(await __c.Svb(a.Gpa)).I;return{runtime:b,Ha:c,Jx:void 0,Te:a.Gpa};default:throw new t(b);}};jxb=H(()=>({wb:L(1,"HostCapabilitiesService"),getCapabilities:L(2,"getCapabilities")}));__c.Rvb=H(()=>({}));__c.kxb=H(()=>({CCb:L(1,"CanvaApiService"),request:L(2,"request"),n7k:M(3)}));__c.lxb=H(()=>({wb:L(1),xMa:L(2)}));__c.mxb=H(()=>({wb:L(1),lGa:L(2),srg:M(8),T7e:M(4),Dde:M(6),ARe:M(7)}));__c.nxb=H(()=>({wb:L(1),vee:L(2),publish:L(3),t5b:M(4),cJd:M(5),oIc:M(6),cAb:M(7)}));__c.oxb=H(()=>({wb:L(1),Vnd:M(9),exit:L(2),XTc:L(3),EVh:M(6),Xpb:M(7),reload:L(4),dTa:M(5)}));__c.pxb=H(()=>({wb:L(1),c7:L(2)}));__c.qxb=H(()=>({wb:L(1),download:L(2),upload:L(3),aXc:M(4),bXc:M(5),G1f:M(6)}));__c.rxb=H(()=>({wb:L(1),signOut:M(3),cIa:L(4),fVc:L(5),n_f:M(6),osh:M(22),RNj:M(7),SNj:M(8),TNj:M(10),Mnd:M(11),psh:M(12),bva:M(13),UNj:M(14),VNj:M(15),qsh:M(21),WNj:M(16),XNj:M(17),YNj:M(18),ZNj:M(19),NTe:M(20)}));__c.sxb=H(()=>({CCb:L(1),mbf:L(2),iia:L(4),R_b:L(5),NFa:M(6),tZc:M(7)}));__c.txb=H(()=>({wb:L(1),VPd:L(2)}));var uxb=H(()=>({wb:L(1),DJj:M(11),SSj:M(2),TSj:M(10),K_c:M(3),zfe:M(14),NZf:M(4),KX:M(5),wJk:M(7),xJk:M(12),yJk:M(13),dMk:M(9),BUk:M(8)}));var vxb=H(()=>({wb:L(1),c7:L(2),t7e:L(3),voh:M(4)}));var wxb=H(()=>({wb:L(1),w4r:L(2),cLr:M(3)}));var xxb=H(()=>({wb:L(1),dLr:L(2)}));__c.yxb=H(()=>({wb:L(1),$de:L(2),kxd:M(3),ZBb:M(4),OUk:M(5),getCapabilities:M(6),Tfk:M(7)}));__c.zxb=H(()=>({wb:L(1),q3i:M(2),getCapabilities:M(3),VRe:M(5)}));var Axb=H(()=>({wb:L(1),KHg:L(2)}));__c.Bxb=H(()=>({wb:L(1),Kj:L(2),I8:M(3)}));__c.Cxb=H(()=>({wb:L(1),x0n:L(2),notifyComplete:L(3),ZIp:M(4),JIo:M(5)}));__c.Dxb=H(()=>({wb:L(1),DFg:M(2),Vje:M(3),ste:M(4),BFg:M(5),O$b:L(6),$uc:L(7),JYh:M(8),gtf:M(9),dKc:M(10),CFg:M(11),b3c:M(12),Slc:M(13),Yfg:M(14)}));__c.Exb=H(()=>({wb:L(1),Pud:L(2),$fb:L(3),Rlc:L(4),Qea:L(5),bz:L(6),Cvd:M(7),Q7e:M(8)}));__c.Fxb=H(()=>({wb:L(1),tDb:L(2),Owd:L(3),O3d:L(4),kyb:M(5),dDe:M(6)}));__c.Gxb=H(()=>({wb:L(1),Bvg:L(2)}));__c.Hxb=H(()=>({wb:L(1),post:L(2)}));__c.Ixb=H(()=>({wb:L(1),login:L(2),Pfg:L(3),iYf:M(4)}));__c.Jxb=H(()=>({wb:L(1),$af:L(2),zsf:L(3),Feg:L(4),xbc:L(5),Ywd:M(6)}));__c.Kxb=H(()=>({wb:L(1),qee:L(2)}));__c.Lxb=H(()=>({wb:L(1),YQg:L(2),keg:L(3)}));__c.Mxb=H(()=>({wb:L(1),Kba:L(2),mFh:M(3),ldk:M(4),Pek:M(5),Qql:M(6),G3a:M(7),OVh:M(8),Aja:M(9),Qek:M(10)}));__c.Nxb=H(()=>({wb:L(1),BFp:L(2),N0n:L(3)}));var Oxb=H(()=>({wb:L(1),g4r:L(2)}));__c.Pxb=H(()=>({wb:L(1),lHa:L(2),getBlob:L(3),oWc:L(4)}));var Qxb=H(()=>({wb:L(1),capture:L(2),finish:L(3),cancel:L(4)}));__c.Rxb=H(()=>({wb:L(1),z5b:L(2),fua:L(3)}));__c.Sxb=H(()=>({wb:L(1),Or:M(2),YO:M(3),PP:M(4),j6a:M(5),$Fc:M(16),nZa:M(7),ZFc:M(9),aGc:M(14),WFc:M(10),VFc:M(11),bBb:M(12),cBb:M(13),fGc:M(15)}));__c.Txb=H(()=>({wb:L(1),L4b:M(2),rrf:M(3)}));__c.Uxb=H(()=>({wb:L(1),a8e:M(2),xgg:M(3),$ba:M(4)}));__c.Vxb=H(()=>({wb:L(1),xMa:L(2),MJc:M(3),i5b:M(4)}));__c.Wxb=H(()=>({wb:L(1),xMa:L(2),MJc:M(3),i5b:M(4)}));__c.Xxb=H(()=>({wb:L(1),qDg:L(2),zeg:L(3),Pyf:L(4)}));__c.Yxb=H(()=>({wb:L(1),authorize:L(2),Teg:L(3)}));__c.Zxb=H(()=>({wb:L(1),aBc:L(2),Eub:L(3),g6b:L(4),u7e:M(5),e6b:L(6),s7e:M(7),qmc:M(8)}));__c.$xb=H(()=>({wb:L(1),PLb:L(2),LHf:M(3),pUh:M(4),getDeviceId:M(5),getSessionId:M(6),wmc:M(7),Wsh:M(8),Sbc:M(9)}));__c.ayb=H(()=>({wb:L(1),APd:M(3),ZLc:L(2)}));__c.byb=H(()=>({wb:L(1),RAc:L(2)}));var cyb=H(()=>({wb:L(1),vNg:L(2),showNotification:M(3)}));var dyb=H(()=>({wb:L(1),eqh:M(4),d8e:L(2),Ykg:L(3),d0i:M(5)}));__c.eyb=H(()=>({wb:L(1),C5:L(2),d0n:L(3)}));__c.fyb=H(()=>({wb:L(1),OUg:L(2)}));__c.gyb=H(()=>({wb:L(1),zJc:M(9),Fwh:L(2),m1f:L(7),F4f:L(3),GOd:M(4),yLk:M(5),mLk:M(6),DXg:M(8)}));__c.hyb=H(()=>({wb:L(1),PLb:M(3),DOc:M(4)}));__c.iyb=H(()=>({wb:L(1),xup:L(2),eLr:M(3),Sur:M(4),o6r:M(5)}));__c.jyb=H(()=>({wb:L(1),nni:L(2),mni:M(3),oni:M(4),eMk:M(5)}));__c.kyb=H(()=>({wb:L(1),dxb:L(2),$fb:L(3),htf:L(4),Qea:L(5),bz:L(6),Xde:L(7),N6e:L(8),Q7e:M(9)}));__c.lyb=H(()=>({wb:L(1),rDg:L(2),OMg:M(3)}));__c.myb=H(()=>({wb:L(1),track:L(2),gne:M(3)}));__c.nyb=H(()=>({wb:L(1),VYn:L(2),Tvp:L(3),DUp:L(4),f9o:L(5),gXq:M(6),KIo:M(7),Q0q:M(8)}));__c.oyb=H(()=>({wb:L(1),Xwd:L(2),fek:M(3)}));__c.pyb=H(()=>({wb:L(1),Mxe:L(2),yeg:M(3)}));__c.qyb=H(()=>({wb:L(1),getMetrics:M(2),khj:M(3),HLf:M(4)}));__c.ryb=H(()=>({wb:L(1),OXn:M(2),zmo:M(3),Yjo:M(4),xgs:M(5)}));__c.syb=H(()=>({wb:L(1),e9o:L(2)}));__c.tyb=H(()=>({wb:L(1),c9o:L(2),HXm:L(3)}));__c.uyb=H(()=>({wb:L(1),Wsg:L(2),track:M(3)}));__c.vyb=H(()=>({wb:L(1),gCd:L(2),f6d:L(3),B7e:L(4)}));var wyb=H(()=>({wb:L(1),gPq:M(2),wrh:M(5),T0q:M(10),d2q:M(11),klr:M(15),Jqr:M(3),Jur:M(6),Our:M(7),X_r:M(13),v0r:M(14),N3r:M(4),Y5r:M(12),b_:M(8),j6r:M(9)}));__c.xyb=H(()=>({wb:L(1),i9d:L(2),W3m:M(3)}));var yyb=H(()=>({wb:L(1),I6e:M(2),jzf:M(3)}));__c.zyb=H(()=>({wb:L(1),Edg:M(2)}));var Ayb=H(()=>({wb:L(1),isSupported:L(4),Syi:L(2),wrh:L(3)}));__c.Byb=H(()=>({wb:L(1),sNg:L(2),Ysh:M(3),eth:M(4),jhj:M(5),ihj:M(6)}));__c.Cyb=H(()=>({wb:L(1),eUe:M(2)}));__c.Dyb=H(()=>({wb:L(1),hYn:L(2)}));__c.Eyb=H(()=>({wb:L(1),abf:L(2),zJc:M(11),cJf:L(3),mJf:L(4),Mnc:L(5),Ogc:L(6),vYe:L(7),$6e:L(8),K_f:M(9),bth:M(10)}));__c.Fyb=H(()=>({wb:L(1),nWg:L(2),Dqh:M(3)}));var Gyb=H(()=>({r0b:E(2,__c.kxb),Yjg:E(3,__c.lxb),lGa:E(4,__c.mxb),L2b:E(5,__c.nxb),Ad:__c.C(6,__c.oxb),Veb:E(7,__c.pxb),T5b:E(8,__c.qxb),session:E(11,__c.rxb),Psc:E(13,__c.Pvb),ssb:E(14,__c.sxb),G0i:E(15,__c.txb),$2i:E(16,uxb),dge:E(17,vxb),dDo:E(18,wxb),sR:E(19,xxb),urg:E(20,__c.yxb),camera:E(21,__c.zxb),Thj:E(22,Axb),c4a:E(23,__c.Bxb),uvo:E(24,__c.Cxb),T_c:E(26,__c.Dxb),vac:E(27,__c.Exb),UNh:E(28,__c.Fxb),auth:E(29,__c.Gxb),KPm:E(30,__c.Hxb),RTa:E(32,__c.Ixb),Xha:E(35,__c.Jxb),yli:E(37,__c.Kxb),
S2e:E(39,__c.Lxb),download:E(41,__c.Mxb),MJg:E(42,__c.Nxb),ORm:E(43,Oxb),hT:E(44,__c.Pxb),pwo:E(45,Qxb),yOe:E(46,__c.Rxb),rha:E(47,__c.Sxb),J0h:E(48,__c.Txb),VBc:E(49,__c.Uxb),zNe:E(50,__c.Vxb),KLf:E(52,__c.Wxb),orientation:E(53,__c.Xxb),sjg:E(54,__c.Yxb),ndb:E(56,__c.Zxb),ahh:E(57,__c.$xb),theme:E(59,__c.ayb),performance:E(60,__c.byb),notification:E(61,cyb),Bhh:E(62,dyb),JNn:E(63,__c.eyb),wakeLock:E(64,__c.fyb),MHl:E(65,__c.gyb),telemetry:E(66,__c.hyb),zMm:E(67,__c.iyb),zUe:E(68,__c.jyb),USc:E(69,
__c.kyb),Zud:E(70,__c.lyb),Gik:E(71,__c.myb),drawing:E(72,__c.nyb),g4d:E(73,__c.oyb),locale:E(74,__c.pyb),networkInformation:E(75,__c.qyb),JCb:E(76,__c.ryb),uyn:E(77,__c.syb),NVm:E(78,__c.tyb),fza:E(79,__c.uyb),credentials:E(80,__c.vyb),Efp:E(81,wyb),i9d:E(82,__c.xyb),pCj:E(83,yyb),yCk:E(84,__c.zyb),Qte:E(85,Ayb),M$b:E(86,__c.Byb),UKk:E(87,__c.Cyb),clipboard:E(88,__c.Dyb),ACk:E(89,__c.Eyb),lfi:E(90,__c.Fyb)}));__c.Hyb=H(()=>({I:__c.C(1,Gyb)}));var Qvb=class{getCapabilities(a){return this.ld.exec(this.Ha.wb,this.Ha.getCapabilities,__c.Rvb.serialize(a)).then(__c.Hyb.deserialize)}constructor(a){var b=new jxb({});this.ld=a;this.Ha=b}};var Iyb=class extends Error{constructor(a,b){super(b);this.type=a}};var Jyb=H(()=>({type:z("A?",1,"REQUEST"),id:L(1),Vzb:L(2)}));var Wvb=H(()=>({type:z("A?",1,"SUCCESS"),Vzb:L(2)}));var Kyb=K(()=>[1,2],1);var Vvb=H(()=>({type:z("A?",2,"ERROR"),gh:Ma(1,Kyb),message:M(2)}));var Lyb=__c.Ta(()=>({type:[1,Wvb,2,Vvb]}),()=>({}));var Uvb=H(()=>({type:z("A?",2,"RESPONSE"),requestId:L(1),content:__c.C(2,Lyb)}));var Myb=__c.Ta(()=>({type:[1,Jyb,2,Uvb]}),()=>({}));var Bwb=class{init(){this.cUc.DMg(this.zWo)}postMessage(a){a=Myb.serialize(a);this.cUc.postMessage(a)}async send(a,b=this.FNp){const c=this.Ly.next(),d=new Promise((f,g)=>{this.ISa.set(c,{resolve:f,reject:g});this.postMessage(new Jyb({id:c,Vzb:JSON.stringify(a)}))}),e=this.delay(b).then(()=>new Promise(f=>this.scheduler?this.scheduler.requestIdleCallback(f):f())).then(()=>{throw new Iyb(2,`Timeout reached (${b} ms) before receiving a response.`);});return Promise.race([d,e]).finally(()=>this.ISa.delete(c))}constructor(a,
b,c){this.cUc=a;this.Ly=b;this.delay=__c.eb;this.FNp=c;this.scheduler=this.errorService=void 0;this.ISa=new Map;this.zWo=d=>{const e=Myb.deserialize(d);switch(e.type){case "REQUEST":Xvb(this,e);break;case "RESPONSE":d=this.ISa.get(e.requestId);if(d==null){var f;(f=this.errorService)===null||f===void 0||f.warning(Error("Received success response to an already completed request."),{extra:new Map([["requestId",e.requestId],["type",e.type]])})}else switch(f=e.content,f.type){case "SUCCESS":let g;try{g=
JSON.parse(f.Vzb)}catch(h){d.reject(new Iyb(1,"Failed to parse response content"));break}d.resolve(g);break;case "ERROR":d.reject(new Iyb(f.gh,f.message));break;default:throw new t(f);}break;default:throw new t(e);}}}};var vwb=class{constructor(a){this.deps=a}},Yvb=class extends Error{},Dwb=class{constructor(a){this.deps=a}};var wwb=class{postMessage(a){this.port.postMessage(a)}DMg(a){this.port.onmessage=b=>{a(b.data)}}constructor(a){this.port=a}};var awb=H(()=>({wb:L(1),methodName:L(2),Vzb:L(3)}));var Nyb=K(()=>[1,2,3,4,5],1);var Xyb=H(()=>({type:z("A?",2,"ERROR"),gh:Ma(1,Nyb),message:M(2)}));var Yyb=H(()=>({type:z("A?",1,"SUCCESS"),Vzb:L(1)}));var bwb=__c.Ta(()=>({type:[1,Yyb,2,Xyb]}),()=>({}));var Awb=class{init(){Tvb(this.Gpa,async a=>{a=awb.deserialize(a);a=await this.Jx.xBc(a).catch(()=>new Xyb({gh:1}));return bwb.serialize(a)});this.Gpa.init()}Q5d(a){return new Awb(this.Gpa,this.Jx,a)}async exec(a,b,c){let d;try{d=JSON.stringify(c)}catch(e){throw new qc({type:1,methodName:b,message:"Failed to stringify request JSON"});}a=new awb({wb:a,methodName:b,Vzb:d});a=await cwb(this,a).catch(e=>{if(e instanceof Iyb)switch(e.type){case 2:throw new qc({type:2,methodName:b,message:e.message});case 1:break;
default:throw new t(e.type);}throw new qc({type:1,methodName:b,message:e.message});});switch(a.type){case "SUCCESS":try{return JSON.parse(a.Vzb)}catch(e){throw new qc({type:1,methodName:b,message:"Failed to parse response JSON"});}case "ERROR":throw new qc({type:a.gh,methodName:b,message:a.message});default:throw new t(a);}}constructor(a,b,c){this.Gpa=a;this.Jx=b;this.timeoutMs=c}};var Zyb=K(()=>[7,2,6,4,5,3,1],1);var fwb=H(()=>({type:z("A?",12,"EXEC_RESPONSE"),Bvb:L(30,"data"),gh:__c.Oa(28,Zyb),errorMessage:M(29),requestId:L(27)}));var $yb=K(()=>[5,3,4,2,1]);var iwb=H(()=>({type:z("A?",20,"CREATE_CHANNEL_RESPONSE"),requestId:L(27),nx:M(28),code:__c.Oa(29,$yb),message:M(30)}));var azb=K(()=>[4,3,2,1]);var bzb=K(()=>[1,2]);var jwb=H(()=>({type:z("A?",23,"CHANNEL_ERROR_MESSAGE"),nx:L(27),code:Ma(28,azb),message:L(29),source:Ma(30,bzb)}));var kwb=H(()=>({type:z("A?",21,"CHANNEL_PAYLOAD_MESSAGE"),nx:L(27),Bvb:L(28,"data"),source:Ma(30,bzb)}));var lwb=H(()=>({type:z("A?",22,"CHANNEL_COMPLETE_MESSAGE"),nx:L(27),source:Ma(30,bzb)}));var dwb=class extends Error{};var czb;czb=class{constructor(){this.aki=new Map;this.channels=new Map}};
__c.xwb=class{async xBc(a){var b=this.store.aki.get(a.wb);if(b==null)return new Xyb({gh:3,message:`Service "${a.wb}" not found.`});var c=b.get(a.methodName);if(c==null)return new Xyb({gh:4,message:`Method "${a.methodName}" not found on service "${a.wb}".`});if(c.type!=null&&c.type!==2)return new Xyb({gh:1,message:`Method "${a.methodName}" is not a request/response method.`});b=c.osn;const d=c.ktp;c=c.uIk;let e;try{e=JSON.parse(a.Vzb)}catch(h){return new Xyb({gh:1,message:"Failed to parse request JSON"})}let f;
try{const h=b(e),k=await c(h);f=d(k)}catch(h){var g;(g=this.errorService)===null||g===void 0||g.ia(h,{extra:new Map([["serviceName",a.wb],["methodName",a.methodName]])});return new Xyb({gh:5})}try{const h=JSON.stringify(f);return new Yyb({Vzb:h})}catch(h){return new Xyb({gh:1,message:"Failed to stringify response JSON"})}}constructor(a,b,c){this.store=new czb;this.iTb=a;this.errorService=b;this.Lxa=c}};var dzb=H(()=>({type:z("A?",19,"CREATE_CHANNEL_REQUEST"),Bvb:L(30,"data"),id:L(27),methodName:L(29),wb:L(28)}));var ezb=H(()=>({type:z("A?",11,"EXEC_REQUEST"),Bvb:L(30,"data"),id:L(27),methodName:L(29),wb:L(28),Xhb:M(31)}));var fzb=H(()=>({type:z("A?",13,"GET_CAPABILITIES_REQUEST"),id:L(27)}));var gzb=H(()=>({type:z("A?",14,"GET_CAPABILITIES_RESPONSE"),requestId:L(27)}));var hzb=H(()=>({type:z("A?",15,"HEALTHCHECK_REQUEST"),id:L(27)}));var izb=H(()=>({type:z("A?",16,"HEALTHCHECK_RESPONSE"),requestId:L(27)}));var jzb=H(()=>({type:z("A?",17,"MESSAGE_ERROR_EVENT"),errorMessage:M(27)}));var Lwb=H(()=>({type:z("A?",18,"SERVER_READY_EVENT")}));var $wb=__c.Ta(()=>({type:[22,lwb,23,jwb,21,kwb,19,dzb,20,iwb,11,ezb,12,fwb,13,fzb,14,gzb,15,hzb,16,izb,17,jzb,18,Lwb]}),()=>({}));var zwb=class{constructor(){this.Mgc={type:"responsive",l5d:0};this.channels=new Map;this.Pqf=new Map;this.Qqf=new Map;this.VBi=new Map;this.Sqf=new Map}},ywb=class{reset({reason:a}){var b=this.deps.store,c=[...b.Pqf.values(),...b.Qqf.values(),...b.VBi.values(),...b.Sqf.values()];b.Pqf.clear();b.Qqf.clear();b.VBi.clear();b.Sqf.clear();for(var d of c)c=`${d.zj.type} failed to be completed by server that has already been ${a}.`,c=d.zj.type==="EXEC_REQUEST"?new qc({requestId:d.zj.id,type:twb(1),TOc:1,
methodName:`${d.zj.wb}:${d.zj.methodName}`,message:c}):Error(c),d.reject(c);d=Array.from(b.channels.entries());b.channels.clear();for(const [e,f]of d)b=new jwb({nx:e,code:1,message:`The WebX communication bridge has been ${a}.`,source:2}),f.j9e(b,jwb.serialize(b));b=this.deps.Jx;a=`The WebX communication bridge has been ${a}.`;d=Array.from(b.store.channels.entries());b.store.channels.clear();for(const [e,f]of d)b=new jwb({nx:e,code:1,message:a,source:1}),f.j9e(b,jwb.serialize(b))}postMessage(a,b){a.type===
"EXEC_REQUEST"||a.type==="EXEC_RESPONSE"||a.type==="CREATE_CHANNEL_REQUEST"||a.type==="CHANNEL_PAYLOAD_MESSAGE"?this.deps.FLa.postMessage({...$wb.serialize(a),[a.Bvb]:m(b)}):this.deps.FLa.postMessage($wb.serialize(a))}async exec(a,b,c,d){const e=this.deps.mAc();try{const f=new ezb({id:e,wb:a,methodName:b,Xhb:d===null||d===void 0?void 0:d.Xhb}),{ZT:g,O8c:h}=await new Promise((k,l)=>{this.deps.store.Qqf.set(f.id,{zj:f,resolve:k,reject:l});this.postMessage(f,c)});if(g.gh!=null)throw new qc({requestId:e,
type:twb(g.gh),TOc:g.gh,methodName:b,message:g.errorMessage});return ewb(g,h)}catch(f){if(f instanceof dwb)throw new qc({requestId:e,type:twb(5),TOc:5,methodName:b,message:f.message});throw f;}finally{this.deps.store.Qqf.delete(e)}}Q5d(){return this}async rnk(){const a=this.deps.errorService;var b=this.deps.mAc;const c=this.deps.IEr,d=this.deps.sessionId,e=this.deps.store;b=b();try{const f=new hzb({id:b}),g=new Promise((h,k)=>{e.Sqf.set(f.id,{zj:f,resolve:h,reject:k});this.postMessage(f)});await Promise.race([g,
uwb(this,f.id)]);c===null||c===void 0||c("Healthcheck succeed.");switch(e.Mgc.type){case "responsive":e.Mgc.l5d++;break;case "unresponsive":a.info("Bridge responsive.",{tags:new Map([["sessionId",d]]),extra:new Map([["consecutiveFailureCount",e.Mgc.l5d]])});e.Mgc={type:"responsive",l5d:1};break;default:throw new t(e.Mgc.type);}}catch(f){switch(c===null||c===void 0||c("Healthcheck failed."),e.Mgc.type){case "responsive":a.ia(f,{tags:new Map([["sessionId",d]]),extra:new Map([["consecutiveSuccessCount",
e.Mgc.l5d]])});e.Mgc={type:"unresponsive",l5d:1};break;case "unresponsive":e.Mgc.l5d++;break;default:throw new t(e.Mgc.type);}}finally{e.Sqf.delete(b)}}constructor(a){var b,c;this.deps=a;this.n6=d=>{if(d!=null&&typeof d==="object"&&"type"in d&&d.type==="PROXIED_SERVER_MESSAGE"&&this.deps.glk!=null)this.deps.glk(d);else{try{var e=$wb.deserialize(d)}catch(g){this.postMessage(new jzb({errorMessage:g instanceof Error?g.message:"Failed to deserialize message."}));return}switch(e.type){case "MESSAGE_ERROR_EVENT":var f;
throw Error((f=e.errorMessage)!==null&&f!==void 0?f:"Invalid message.");case "SERVER_READY_EVENT":this.reset({reason:"replaced"});break;case "CREATE_CHANNEL_REQUEST":this.postMessage(mwb(this.deps.Jx,{zj:e,yep:d,EDi:this.postMessage.bind(this)}));break;case "EXEC_REQUEST":qwb(this,e,d);break;case "HEALTHCHECK_REQUEST":this.postMessage(new izb({requestId:e.id}));break;case "GET_CAPABILITIES_REQUEST":this.postMessage(new gzb({requestId:e.id}));break;case "CREATE_CHANNEL_RESPONSE":d=this.deps.store.Pqf.get(e.requestId);
if(d==null&&e.nx!=null){this.postMessage(new jwb({nx:e.nx,code:3,message:`Received CREATE_CHANNEL_RESPONSE with unrecognized request ID: ${e.requestId}`,source:1}));break}d===null||d===void 0||d.resolve(e);break;case "EXEC_RESPONSE":f=this.deps.store.Qqf.get(e.requestId);f===null||f===void 0||f.resolve({ZT:e,O8c:d});break;case "GET_CAPABILITIES_RESPONSE":d=this.deps.store.VBi.get(e.requestId);d===null||d===void 0||d.resolve(e);break;case "HEALTHCHECK_RESPONSE":d=this.deps.store.Sqf.get(e.requestId);
d===null||d===void 0||d.resolve(e);break;case "CHANNEL_PAYLOAD_MESSAGE":case "CHANNEL_COMPLETE_MESSAGE":case "CHANNEL_ERROR_MESSAGE":switch(e.source){case 1:nwb(this.deps.Jx,{message:e,O8c:d,EDi:this.postMessage.bind(this)});return;case 2:f=this.deps.store.channels.get(e.nx);if(f==null){this.postMessage(new jwb({nx:e.nx,code:3,message:`Received ${e.type} with unrecognized channel ID: ${e.nx}`,source:1}));return}f.j9e(e,d);return;default:throw new t(e.source);}default:throw new t(e);}}};this.requestChannel=
this.deps.Lxa!=null?(d,e,f,g)=>{const h=new (m(this.deps.Lxa).Subject);rwb(this,new dzb({id:this.deps.mAc(),wb:d,methodName:e}),f,g,h);return h}:void 0;this.deps.FLa.DMg(this.n6);(b=(c=this.deps.FLa).t4r)===null||b===void 0||b.call(c,()=>this.reset({reason:"destroyed"}))}};var Fwb=class{init(){Tvb(this.Gpa,async a=>{const {wb:b,methodName:c,Vzb:d}=awb.deserialize(a);let e;try{e=JSON.parse(d)}catch(h){return bwb.serialize(new Xyb({gh:1,message:h instanceof Error?h.message:"Failed parsing request data."}))}let f;try{f=await this.exec(b,c,e)}catch(h){return h instanceof qc?new Xyb({gh:h.type,message:h.message}):new Xyb({gh:1,message:h instanceof Error?`Proxy server caught non-exec error: ${h.message}`:"Proxy server caught non-exec error."})}let g;try{g=JSON.stringify(f)}catch(h){return bwb.serialize(new Xyb({gh:1,
message:h instanceof Error?h.message:"Failed stringify-ing response data."}))}return bwb.serialize(new Yyb({Vzb:g}))});this.Gpa.init()}async exec(a,b,c){return this.Ncp.exec(a,b,c)}constructor(a,b){this.Gpa=a;this.Ncp=b}};var Kwb=class{async h$f(){const a=this.deps.Yfn;var b=this.deps.delay;const c=this.deps.mAc,d=this.deps.window,e=m(Hwb(d)),f=new Promise((g,h)=>{const k=c(),l=n=>{if(n.data===k)return d.removeEventListener("message",l),n.ports.length!==1?h(new kzb):g(n.ports[0])};d.addEventListener("message",l);e(k)});b=await Promise.race([f,b(5E3).then(()=>{throw new lzb;})]);return{Wak:void 0,FLa:a(b)}}constructor(a){this.deps=a}},lzb=class extends Error{},kzb=class extends Error{};var Vwb=class{DMg(a){const b=c=>a(JSON.parse(c.data));this.OJ.set(a,b);this.port.addEventListener("message",b);this.port.start()}removeListener(a){const b=this.OJ.get(a);b!=null&&(this.OJ.delete(a),this.port.removeEventListener("message",b))}postMessage(a){this.port.postMessage(JSON.stringify(a))}constructor(a){this.port=a;this.OJ=new Map}};var Uwb=class{async h$f(){const a=await Owb(this);return{FLa:this.deps.U7m(a),Wak:void 0}}constructor(a){this.deps=a;this.eHg=void 0}};var Wwb=class{async h$f(){var a=this.deps.cen;const b=this.deps.window,c=m(Pwb(b));a=a(c);Object.defineProperty(b,"iosBridgeNativeCallback",{configurable:!1,enumerable:!0,writable:!1,value:a.JAn});return{FLa:a,Wak:void 0}}constructor(a){this.deps=a}};__c.mzb=class extends Error{constructor(a){super(`MessageBusError: ${a.cause instanceof Error?a.cause.message:"Unknown"}`,a)}};var Xwb=class{DMg(a){this.OJ.add(a)}removeListener(a){this.OJ.delete(a)}postMessage(a){if(!this.kJl)try{this.deps.qDo.postMessage(a)}catch(b){throw new __c.mzb({cause:b});}}constructor(a){this.deps=a;this.kJl=!1;this.OJ=new Set;this.JAn=b=>{b=__c.sa(JSON.parse(decodeURIComponent(b)));for(const c of this.OJ)try{c(b)}catch(d){this.deps.errorService.ia(d)}};window.addEventListener("unload",()=>this.kJl=!0)}};var Ywb=async({Ksh:a,lyh:b,vMb:c,jse:d,p5b:e,Lxa:f,mtp:g,iTb:h})=>{if(b){var k=JSON.parse(g);if(!(k!=null&&typeof k==="object"&&"type"in k&&k.type==="PROXIED_CLIENT_MESSAGE"))throw k;b=JSON.parse(k.data);d=$wb.deserialize(b);if(d.type==="EXEC_REQUEST")await cxb({g5n:l=>void void e.next(pwb({data:l,target:k.origin})),vMb:c,request:d,requestData:b[d.Bvb]});else if(d.type==="CREATE_CHANNEL_REQUEST")axb({h5n:l=>void void e.next(pwb({data:l,target:k.origin})),vMb:c,p5b:e,request:d,requestData:b[d.Bvb],
Lxa:m(f),HGp:({nx:l,TSe:n})=>void a.channels.set(l,{TSe:n}),target:k.origin,iTb:h});else if(d.type==="CHANNEL_COMPLETE_MESSAGE")m(a.channels.get(d.nx)).TSe.complete();else if(d.type==="CHANNEL_ERROR_MESSAGE")m(a.channels.get(d.nx)).TSe.error(`${d.code}: ${d.message}`);else if(d.type==="CHANNEL_PAYLOAD_MESSAGE")m(a.channels.get(d.nx)).TSe.next(b[d.Bvb]);else throw Error(`unsupported message type: ${d.type}`);}else d(g)};var exb=window.self===window.top,fxb=__c.Xa("8afa7de9",!1),dxb=class{next(a){for(const b of this.subscribers)b(a)}subscribe(a){this.subscribers.push(a)}constructor(){this.subscribers=[]}};
}).call(self, self._ebd5e19490e9b70e7436d6c497657170);}

}])
//# sourceMappingURL=sourcemaps/853ce87fabcf5252.js.map